<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Xmind,Test Cases,and Allure templates for TDD</title>
      <link href="/2019/07/27/productivity/1-Junit5CaseTestTemplate/"/>
      <url>/2019/07/27/productivity/1-Junit5CaseTestTemplate/</url>
      
        <content type="html"><![CDATA[<h1 id="Xmind-TestCases-and-JUnit5-Allure-Template"><a href="#Xmind-TestCases-and-JUnit5-Allure-Template" class="headerlink" title="Xmind,TestCases and JUnit5 Allure Template"></a>Xmind,TestCases and JUnit5 Allure Template</h1><p>Learn from the requirements and write test cases are the common daily work of a tester.<br>Normally write the mind map as a guide of test cases(in internet it is enough), then<br>execute the test cases or write testing codes based on the xmind file(mind map).<br>But do you ever question about this process? It is productive enough? Is there any improvement?</p><p>Let me give an example: I want to test a DateUtil functionality, it has several features, the mindmap like this:</p><ol><li><p>DateUtil Test Cases Mindmap:<br><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/productivity/testcase_map.jpg" alt="img"></p></li><li><p>Then write test codes(your boss required you to write automation codes) using junit and allure:</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Epic</span>(<span class="string">"Hutool DateUtil Usage"</span>)</span><br><span class="line"><span class="meta">@Feature</span>(<span class="string">"Hutool DateUtil Simple Usage"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HutoolDateUtilsTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName</span>(<span class="string">"DateUtil-Formatter-From Date"</span>)</span><br><span class="line">    <span class="meta">@Story</span>(value =<span class="string">"Formatter-From Date"</span> )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFrom_Date</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//write testing codes</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName</span>(<span class="string">"DateUtil-Formatter-From DateTime"</span>)</span><br><span class="line">    <span class="meta">@Story</span>(value =<span class="string">"Formatter-From DateTime"</span> )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFrom_DateTime</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//write testing codes</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://docs.qameta.io/allure/#_junit_5" target="_blank" rel="noopener">allure</a> is a tool for unified test report. It is worth to use.<br>Two conceptions in allure mapping to requirments: </p><ul><li>EPIC: A big functionality,usally have several small featuers</li><li>Feature: A relative small functionality, which might have one or more user stories</li><li>User Story: a small/independent functionality</li></ul><p>Writing code is actually transforming the test cases into codes, and labeling the test codes by different test cases names.</p><ol start="3"><li>Running the tests, the report is like:</li></ol><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/productivity/allure_story_feature.jpg" alt="img"></p><p>It is perfect! But don’t you think you write test cases twice? In <strong><em>xmind</em></strong>, and in <strong><em>code</em></strong> like <strong><em>@Story</em></strong> bla bla bla …..</p><p>Why do I write the annotations like @Story,@Epic or @Feature? The answer is that I want to make a fancy report,but I actually did duplicated work, didn’t I?  Duplicate work have bad smell. In this case, it looks like you sacrifice your productivity to make report fancy. What if I want both fancy report and productivity? Is it possible to write once?  Scripting Boy thought there should be a way.</p><h2 id="Become-a-scripting-boy-to-connect-these-dots"><a href="#Become-a-scripting-boy-to-connect-these-dots" class="headerlink" title="Become a scripting boy to connect these dots"></a>Become a scripting boy to connect these dots</h2><p>Actaully It is not that hard to find a way to achieve the goal: fancy report and productivity both.<br>Let me figure it out:</p><ol><li>Export to test cases in markdown format through xmind(xmind has java/python sdk to manupilate the xmind file, but it is too complex), export is in xmind menu <strong><em>file&gt;export&gt;text</em></strong>:</li></ol><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/productivity/export_md.jpg" alt="img"></p><p>BTW: importing md file to xmind is in ``file&gt;import&gt;text<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">The exported markdown file content:</span><br><span class="line"></span><br><span class="line">```sh</span><br><span class="line"># DateUtil</span><br><span class="line">## Functions</span><br><span class="line">### isSameDate</span><br><span class="line">### CurrentYear</span><br><span class="line">### CurrentMonth</span><br><span class="line">### CurrentDay</span><br></pre></td></tr></table></figure></p><ol start="2"><li>Parse the markdown test cases, and render parsed test cases into testing code template<br>It is not hard, there are only three files, and less than 50 lines of codes:</li></ol><ul><li><p>pom.xml for leveraging existing libs</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.jtwig&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jtwig-core&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;5.87.0.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li><li><p>a junit test code template file in class path(resources folder),named <strong><em>junit_allure_template.twig</em></strong></p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.qameta.allure.Epic;</span><br><span class="line"><span class="keyword">import</span> io.qameta.allure.Story;</span><br><span class="line"><span class="keyword">import</span> io.qameta.allure.Feature;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Assertions;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.DisplayName;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Epic</span>(<span class="string">"&#123;&#123;context.epic&#125;&#125;"</span>)</span><br><span class="line"><span class="meta">@Feature</span>(<span class="string">"&#123;&#123;context.epic&#125;&#125;"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> </span>&#123;&#123;context.epic&#125;&#125;Test &#123;</span><br><span class="line"></span><br><span class="line">   &#123;% <span class="keyword">for</span> entry in context.features.entrySet() %&#125;</span><br><span class="line">    &#123;% <span class="keyword">for</span> feature in entry.value() %&#125;</span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="meta">@DisplayName</span>(<span class="string">"&#123;&#123;context.epic&#125;&#125;-&#123;&#123;feature.desc&#125;&#125;"</span>)</span><br><span class="line">        <span class="meta">@Story</span>(value =<span class="string">"&#123;&#123;feature.desc&#125;&#125;"</span> )</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> test&#123;&#123;feature.name&#125;&#125;()&#123;</span><br><span class="line">            <span class="comment">//write testing codes</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">   &#123;% endfor %&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>50 lines of codes, to read the exported markdown file, and render the template <strong><em>junit_allure_template.twig</em></strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Junit5TestTemplateGenerator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">generateJunit5TC</span><span class="params">(String mdFile,String fileName)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        AllureTestModel allureTestModel = <span class="keyword">new</span> AllureTestModel();</span><br><span class="line">        List&lt;String&gt; mdContent= Resources.readLines(Resources.getResource(mdFile),Charsets.UTF_8);</span><br><span class="line"></span><br><span class="line">        String currentFeature=<span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span> (String line : mdContent) &#123;</span><br><span class="line">            <span class="keyword">if</span>(line.startsWith(<span class="string">"###"</span>))&#123;</span><br><span class="line">                AllureFeature feature = <span class="keyword">new</span> AllureFeature();</span><br><span class="line">                feature.setDesc(currentFeature+<span class="string">"-"</span>+line.replace(<span class="string">"###"</span>,<span class="string">""</span>).trim());</span><br><span class="line">                feature.setName(line.replace(<span class="string">"###"</span>,<span class="string">""</span>).trim().replace(<span class="string">" "</span>,<span class="string">"_"</span>));</span><br><span class="line">                allureTestModel.features.get(currentFeature).add(feature);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(line.startsWith(<span class="string">"##"</span>))&#123;</span><br><span class="line">                currentFeature = line.replace(<span class="string">"##"</span>,<span class="string">""</span>).trim();</span><br><span class="line">                allureTestModel.features.putIfAbsent(currentFeature,<span class="keyword">new</span> ArrayList&lt;&gt;());</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(line.startsWith(<span class="string">"#"</span>))&#123;</span><br><span class="line">                allureTestModel.setEpic(line.replace(<span class="string">"#"</span>,<span class="string">""</span>).trim());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        JtwigTemplate template = JtwigTemplate.classpathTemplate(<span class="string">"junit_allure_template.twig"</span>);</span><br><span class="line">        JtwigModel model = JtwigModel.newModel().with(<span class="string">"context"</span>,allureTestModel);</span><br><span class="line">        template.render(model,<span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(fileName+<span class="string">".java"</span>)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Data</span></span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AllureTestModel</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String epic;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,List&lt;AllureFeature&gt;&gt; features = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@Data</span></span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AllureFeature</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> String desc;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Junit5TestTemplateGenerator.generateJunit5TC(<span class="string">"DateUtil.md"</span>,<span class="string">"HutoolDateUtilTest.java"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>And the result is:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Epic</span>(<span class="string">"Hutool DateUtil Usage"</span>)</span><br><span class="line"><span class="meta">@Feature</span>(<span class="string">"Hutool DateUtil Simple Usage"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HutoolDateUtilsTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName</span>(<span class="string">"DateUtil-Formatter-From Date"</span>)</span><br><span class="line">    <span class="meta">@Story</span>(value =<span class="string">"Formatter-From Date"</span> )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFrom_Date</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//write testing codes</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName</span>(<span class="string">"DateUtil-Formatter-From DateTime"</span>)</span><br><span class="line">    <span class="meta">@Story</span>(value =<span class="string">"Formatter-From DateTime"</span> )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFrom_DateTime</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//write testing codes</span></span><br><span class="line">    &#125;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>which is same as your writing before.</p><p>Scripting boy is not kidding you, use a JAVA template lib to make both fancy report and test cases real without<br>duplicated work. </p><p>detail codes, please refer <a href="https://github.com/allroundtesters/x-tests/tree/master/tester-allinone/xtests-toolkits/markdowns" target="_blank" rel="noopener">junit5 code render</a></p><p>It is not perfect solution which I need to admit. But it works somehow, and save my time anyway.<br>It also demostrated that there are plenty opportunities to tester to practice coding skills,<br>to know a little bit more about other libaries. It is not about rocket science, not about make a fancy product, it is just about practicing day in and day out to make life a little bit easier than before. </p><h2 id="What’s-next"><a href="#What’s-next" class="headerlink" title="What’s next?"></a>What’s next?</h2><p>It looks good, not why not write it as a plugin of a modern ide like intellj IDEA. Wait, Wait, I am a scripting boy, try to<br>make a product?  But Why not? And why not support more templates like testng or other testing framework?  See you next time!</p>]]></content>
      
      
      
        <tags>
            
            <tag> JAVA </tag>
            
            <tag> Automation </tag>
            
            <tag> TDD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>测试的Python须知脑图</title>
      <link href="/2019/07/27/python/Python-Tester-Should-Know/"/>
      <url>/2019/07/27/python/Python-Tester-Should-Know/</url>
      
        <content type="html"><![CDATA[<p>下图是使用Python进行自动化测试需要了解的大纲.</p><p><img src="images/python/python-in-testing.jpg" alt="img"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Automation </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2019/07/11/hbase-intro/"/>
      <url>/2019/07/11/hbase-intro/</url>
      
        <content type="html"><![CDATA[<h1 id="What-is-HBASE"><a href="#What-is-HBASE" class="headerlink" title="What is HBASE"></a>What is HBASE</h1><ul><li>NoSQL: Not Only SQL</li><li>Column-Oriented Database</li><li>Based on Google BigTable</li><li>HDFS as Storage</li><li>TB/PB data and Random Access</li><li>解决10条记录和1000千万记录同样的读写性能问题</li></ul><h2 id="RDBMS-问题"><a href="#RDBMS-问题" class="headerlink" title="RDBMS 问题"></a>RDBMS 问题</h2><p><img src="images/db-e.jpg" alt="img"></p><h2 id="HBASE-VS-MYSQL"><a href="#HBASE-VS-MYSQL" class="headerlink" title="HBASE VS MYSQL"></a>HBASE VS MYSQL</h2><p><img src="images/habseVSmysql.jpg" alt="img"></p><h2 id="Google-Big-Table"><a href="#Google-Big-Table" class="headerlink" title="Google Big Table"></a>Google Big Table</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A Bigtable is a sparse, distributed, persistent multidimensional sorted map.</span><br><span class="line">The map is indexed by a row key, column key, and a timestamp; each value in the map is an uninterpreted array of bytes.</span><br></pre></td></tr></table></figure><ul><li><p>map: bigtable 的核心就是一个Map，key-value</p></li><li><p>persistent： 持久化和其他没有任何区别</p></li><li><p>distributed： 分布式文件系统(HDFS/S3/GFS)/多副本(replication)</p></li><li><p>sorted: key是排序的</p></li><li><p>multidimensional： 和columns有对应关系, 第一层key-value,可以认为是个row, A,B 可以认为是Column Families</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"1"</span> : &#123;</span><br><span class="line">    <span class="attr">"A"</span> : <span class="string">"x"</span>,</span><br><span class="line">    <span class="attr">"B"</span> : <span class="string">"z"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"aaaaa"</span> : &#123;</span><br><span class="line">    <span class="attr">"A"</span> : <span class="string">"y"</span>,</span><br><span class="line">    <span class="attr">"B"</span> : <span class="string">"w"</span></span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>sparse: 稀疏，字段不固定,null值不占空间</p></li></ul><h2 id="Tables-Rows-Columns-and-Cells"><a href="#Tables-Rows-Columns-and-Cells" class="headerlink" title="Tables,Rows,Columns and Cells"></a>Tables,Rows,Columns and Cells</h2><p><img src="images/table_row_col.jpg" alt="img"></p><h2 id="Region"><a href="#Region" class="headerlink" title="Region"></a>Region</h2><p>map: key-value, 根据key可以直接找到对应值,o(1),但是内存不可能无限大,怎么办?<br><img src="images/regions.jpg" alt="img"></p><h2 id="Region-Server"><a href="#Region-Server" class="headerlink" title="Region Server"></a>Region Server</h2><p><img src="images/regserver.jpg" alt="img"></p><h2 id="Region-Region-Server"><a href="#Region-Region-Server" class="headerlink" title="Region,Region Server"></a>Region,Region Server</h2><ul><li>Region 根据不同表来切分</li><li>Region 放到不同的Region Server</li></ul><h2 id="HBASE-Column-Family"><a href="#HBASE-Column-Family" class="headerlink" title="HBASE Column Family"></a>HBASE Column Family</h2><p><img src="images/Hbase_CF.jpg" alt="img"></p><h2 id="HBASE-column-family"><a href="#HBASE-column-family" class="headerlink" title="HBASE column family"></a>HBASE column family</h2><ul><li>每个column family 存成不同的文件</li><li>缓存/压缩/version<br><img src="images/reg_hfile.jpg" alt="img"></li></ul><h2 id="HBASE架构-1"><a href="#HBASE架构-1" class="headerlink" title="HBASE架构-1"></a>HBASE架构-1</h2><p>存储基于Haddop/HDFS:<br><img src="images/hbase-1.jpg" alt="img"></p><h2 id="HBASE架构-2"><a href="#HBASE架构-2" class="headerlink" title="HBASE架构-2"></a>HBASE架构-2</h2><p>Region Server/Region：<br><img src="images/hbase-2.jpg" alt="img"></p><h2 id="HBASE架构-3"><a href="#HBASE架构-3" class="headerlink" title="HBASE架构-3"></a>HBASE架构-3</h2><p><img src="images/hbase-3.jpg" alt="img"></p><h2 id="HBASE架构-4"><a href="#HBASE架构-4" class="headerlink" title="HBASE架构-4"></a>HBASE架构-4</h2><ul><li>zookeeper: 管理节点信息,hbase:meta信息<br><img src="images/HBASE-4.jpg" alt="img"></li></ul><h2 id="HBASE架构-5"><a href="#HBASE架构-5" class="headerlink" title="HBASE架构-5"></a>HBASE架构-5</h2><ul><li>HMASTER： 管理RegionServer节点，所有metadata变化的接口<br><img src="images/HBASE-5.jpg" alt="img"></li></ul><h2 id="HBASE架构-6"><a href="#HBASE架构-6" class="headerlink" title="HBASE架构-6"></a>HBASE架构-6</h2><p>客户端访问：<br><img src="images/hbase-7.jpg" alt="img"></p><h2 id="HBASE架构-7"><a href="#HBASE架构-7" class="headerlink" title="HBASE架构-7"></a>HBASE架构-7</h2><p>Region Sever 内部结构：<br><img src="images/hbase-10.jpg" alt="img"></p><p>Regions:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Table                    (HBase table)</span><br><span class="line">    Region               (Regions for the table)</span><br><span class="line">        Store            (Store per ColumnFamily for each Region for the table)</span><br><span class="line">            MemStore     (MemStore for each Store for each Region for the table)</span><br><span class="line">            StoreFile/HFILE    (StoreFiles for each Store for each Region for the table)</span><br><span class="line">                Block    (Blocks within a StoreFile within a Store for each Region for the table)</span><br></pre></td></tr></table></figure><h2 id="HBASE架构-8"><a href="#HBASE架构-8" class="headerlink" title="HBASE架构-8"></a>HBASE架构-8</h2><p>HBASE是CP系统，WAL(Write Ahead Log)<br><img src="images/hbase-11.jpg" alt="img"><br><img src="images/hbase_wp.jpg" alt="img"></p><h2 id="HBASE"><a href="#HBASE" class="headerlink" title="HBASE"></a>HBASE</h2><ul><li>table,rowkey,column family</li><li>Region/Region Server</li><li>Store/MemStore/StoreFile/HFILE/WAL</li><li>Zookeeper/HMaster</li></ul><p><img src="https://mapr.com/blog/in-depth-look-hbase-architecture/assets/blogimages/HBaseArchitecture-Blog-Fig3.png" alt="img"></p><h2 id="HBase-CLI"><a href="#HBase-CLI" class="headerlink" title="HBase CLI"></a>HBase CLI</h2><p>Use Hbase in CLI and JAVA to learning the basic usage of hbase:</p><ul><li>Use Hbase in a Local Mode</li><li>Use Hbase in JAVA </li></ul><h2 id="HBase-Local-Mode"><a href="#HBase-Local-Mode" class="headerlink" title="HBase Local Mode"></a>HBase Local Mode</h2><p>使用Hbase的本地模式相当简单，启动hbase就可以,不需要太多额外配置。</p><ul><li><p>启动hbase</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="variable">$&#123;HBASE_HOME&#125;</span>/bin</span><br><span class="line">sh start-hbase.sh</span><br></pre></td></tr></table></figure></li><li><p>使用hbase shell 访问</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">./hbase shell</span><br><span class="line">HBase Shell</span><br><span class="line">Use <span class="string">"help"</span> to get list of supported commands.</span><br><span class="line">Use <span class="string">"exit"</span> to quit this interactive shell.</span><br><span class="line">For Reference, please visit: http://hbase.apache.org/2.0/book.html<span class="comment">#shell</span></span><br><span class="line">Version 2.1.1, rb60a92d6864ef27295027f5961cb46f9162d7637, Fri Oct 26 19:27:03 PDT 2018</span><br><span class="line">Took 0.0336 seconds</span><br><span class="line">Ignoring executable-hooks-1.3.2 because its extensions are not built. Try: gem pristine executable-hooks --version 1.3.2</span><br><span class="line">Ignoring gem-wrappers-1.3.2 because its extensions are not built. Try: gem pristine gem-wrappers --version 1.3.2</span><br><span class="line">2.4.1 :001 &gt;</span><br></pre></td></tr></table></figure><h2 id="HBase-Basic-Commands"><a href="#HBase-Basic-Commands" class="headerlink" title="HBase Basic Commands"></a>HBase Basic Commands</h2><ul><li>create table with column family</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create <span class="string">'test_table'</span>,<span class="string">'cf1'</span></span><br></pre></td></tr></table></figure><ul><li>put data: 插入数据： put <table>,<row_key>,<a href="cf:property" target="_blank" rel="noopener">cf:property</a>,<value><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">put <span class="string">'test_table'</span>,<span class="string">'row_key_1'</span>,<span class="string">'cf1:k1'</span>,<span class="string">'k1:v1'</span></span><br></pre></td></tr></table></figure></value></row_key></table></li></ul><p>同一个column family,不同数据，然后scan结果, scan的结果是cell-oriented</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> =&gt; [<span class="string">"test_table"</span>]</span><br><span class="line">2.4.1 :004 &gt; put <span class="string">'test_table'</span>,<span class="string">'row_key_1'</span>,<span class="string">'cf1:k1'</span>,<span class="string">'k1:v1'</span></span><br><span class="line">Took 0.2186 seconds</span><br><span class="line">2.4.1 :005 &gt; put <span class="string">'test_table'</span>,<span class="string">'row_key_1'</span>,<span class="string">'cf1:k2'</span>,<span class="string">'k2:v2'</span></span><br><span class="line">Took 0.0094 seconds</span><br><span class="line">2.4.1 :006 &gt; put <span class="string">'test_table'</span>,<span class="string">'row_key_1'</span>,<span class="string">'cf1:k3'</span>,<span class="string">'k3:v3'</span></span><br><span class="line">Took 0.0032 seconds</span><br><span class="line">2.4.1 :007 &gt; scan <span class="string">'test_table'</span></span><br><span class="line">ROW                        COLUMN+CELL</span><br><span class="line"> row_key_1                 column=cf1:k1, timestamp=1545926595556, value=k1:v1</span><br><span class="line"> row_key_1                 column=cf1:k2, timestamp=1545926683964, value=k2:v2</span><br><span class="line"> row_key_1                 column=cf1:k3, timestamp=1545926692956, value=k3:v3</span><br></pre></td></tr></table></figure><ul><li>get data</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2.4.1 :008 &gt; get <span class="string">'test_table'</span>,<span class="string">'row_key_1'</span></span><br><span class="line">COLUMN                     CELL</span><br><span class="line"> cf1:k1                    timestamp=1545926595556, value=k1:v1</span><br><span class="line"> cf1:k2                    timestamp=1545926683964, value=k2:v2</span><br><span class="line"> cf1:k3                    timestamp=1545926692956, value=k3:v3</span><br></pre></td></tr></table></figure><p>以上实际上就是HBASE的最常用的使用方法: put/get(write/read)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2019/06/27/loan-calculation/"/>
      <url>/2019/06/27/loan-calculation/</url>
      
        <content type="html"><![CDATA[<h1 id="Loan-Calculation-Example"><a href="#Loan-Calculation-Example" class="headerlink" title="Loan Calculation Example"></a>Loan Calculation Example</h1><ul><li>Loan Rule Defintion</li><li>Installment Calculation</li><li>Overdue Calculation</li><li>IRR Calculation</li></ul><h2 id="Loan-Rule-Definition"><a href="#Loan-Rule-Definition" class="headerlink" title="Loan Rule Definition"></a>Loan Rule Definition</h2><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/loan/loan_definition.jpg" alt="img"></p><h2 id="Installments-Calculation"><a href="#Installments-Calculation" class="headerlink" title="Installments Calculation"></a>Installments Calculation</h2><ul><li>repayment-Principal: ROUND(10000/3,2)</li><li>repayment-interest: ROUND(10000*2%,2)</li></ul><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/loan/normal_installment.jpg" alt="img"></p><h2 id="Advanced-Repayment-calculation"><a href="#Advanced-Repayment-calculation" class="headerlink" title="Advanced Repayment calculation"></a>Advanced Repayment calculation</h2><p>Overall Payment = Current Term Repayment + Remain Principal+ default penalty(10000*1%)</p><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/loan/advanced_repayment.jpg" alt="img"></p><h2 id="Overdue-Repayment-calculation"><a href="#Overdue-Repayment-calculation" class="headerlink" title="Overdue Repayment calculation"></a>Overdue Repayment calculation</h2><p>For example: </p><p>Last Term: 4-1 is the repayment day, but actually repayment is occurred in 4-10, then it is default. And the default fee is over your imagination.</p><ul><li>Term1 Default Penalty: ROUND(3333.33<em>(0.02/30)*1.5</em>(60+9),2)</li><li>Term2 Default Penalty: ROUND(3333.33<em>(0.02/30)*1.5</em>(30+9),2)</li><li>Term3 Default Penalty: ROUND(3333.34<em>(0.02/30)*1.5</em>(0+9),2)</li></ul><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/loan/overdue_repayment.jpg" alt="img"></p><p>Don’t be default, man!!</p><h2 id="IRR-Calculation"><a href="#IRR-Calculation" class="headerlink" title="IRR Calculation"></a>IRR Calculation</h2><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/loan/IRR.jpg" alt="img"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2019/06/27/Thoughts-Be-A-Touch-Tester/"/>
      <url>/2019/06/27/Thoughts-Be-A-Touch-Tester/</url>
      
        <content type="html"><![CDATA[<h1 id="Think-in-Testing-1-Be-Tough"><a href="#Think-in-Testing-1-Be-Tough" class="headerlink" title="Think in Testing 1: Be Tough"></a>Think in Testing 1: Be Tough</h1><p>If someone tell you that software testing or quality assurance is an easy job to do, he/she might not understand what a tester or qa do.  There are many perspective a tester or qa involved:</p><ol><li>Testing</li><li>Requirement Clarification</li><li>Dev Process/Release Process </li><li>Planning</li></ol><p>Almost every phase QA is involved, it can burn you out easily. Here I just want to talk about some bad thing might happed, and why be tough is a basic charactor of a QA or Tester.</p><h2 id="Don’t-Be-a-maid"><a href="#Don’t-Be-a-maid" class="headerlink" title="Don’t Be a maid"></a>Don’t Be a maid</h2><p>Don’t be a maid, and don’t spend too much time on other’s careless and irresponsibility.<br>Need to fix it.</p><p>In many Chinese domestic company, Tester and QA is a maid of Developer, everything could be in testing scope. Let me summarize several common cases:</p><ol><li>Some incomplete task, need to test</li><li>Some codes never work, neet to test</li><li>Some bug can’t be produced, need to test</li><li>Some performance issues can’t be measured, need to test</li><li>What ever the requirement is, no matter you tester invovled or not, send it to test</li></ol><p>And more important thing is that normally a tester/qa might face 5+ developers. If you can not be tough to Dev, your time and career might be spent for taking care of these guys mistakes,careless. Tester/QA is responsible for the product, not for careleass.<br>Yes, your are finding bugs, but what behind these bugs are careless and irresponsibility. You need to fix careless and irresponsibility though it is tough, so be tough.</p><p>When a production bug occurred, no one will stand in your side.<br>So you need to exposure the facts, I mean real facts, where these bugs? and Why so many bugs, then you can push to reduce bugs, and push DEV moving forward, otherwise every dirty work will on your shoulder. Does DEV not know Unit test can help quality? They know,  Does DEV not know they should tell you a little bit more what a requirement is, because they know you don’t invloved at all in first place? They know, explaination is not a techinical work, in their option, it is not worth to do, that’s it.</p><p>So just tell the dev/dev manager what you want, what the result right now, what is good and what is bad, they will learn from that. Dev Manager love to see feedback. Only thing<br>need to pay attention might be the reporting skill, and how to handle conflict.</p><p>Be a maid is no future in tech world, no one really care about what the careless is, they care about the careless issue should be never happened. You can’t only spend time for others careless, you need to fix it for the root cause.<br>Good Luck, and we tester have long way to go, be tough!</p><h2 id="Show-the-Data-Metrics"><a href="#Show-the-Data-Metrics" class="headerlink" title="Show the Data,Metrics"></a>Show the Data,Metrics</h2><p>Show the data, metrics is good to be professional, and just focus on the thing your team are talked about, not finger point. It can help you be tough and reasonable.<br>But What kind data you can show? It is a question, and also hard to implement. Based on my experience, data like:</p><ol><li>How many Bugs in a sprint?</li><li>How the bugs distributed?</li><li>How a typical bug impact the whole process?</li><li>What the turn around time for the bug or an iteration?</li></ol><p>It is hard to collect data, but it is still worth to collect some of them.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2019/06/27/api-testing/3-InteljIdea-codecoverage/"/>
      <url>/2019/06/27/api-testing/3-InteljIdea-codecoverage/</url>
      
        <content type="html"><![CDATA[<h1 id="Using-IntelljIdea-For-Code-Coverage"><a href="#Using-IntelljIdea-For-Code-Coverage" class="headerlink" title="Using IntelljIdea For Code Coverage"></a>Using IntelljIdea For Code Coverage</h1><p>Two Steps:</p><ol><li>Run Test Code with code coverage - Right click the test class, select run *** with code coverage</li></ol><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/intellij/run_for_coverage.jpg" alt="img"></p><ol start="2"><li>Check the Code Coverage in intelli idea</li></ol><ul><li><p>Line Code Covearge/Method Coverage<br><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/intellij/coverage_report.jpg" alt="img"></p></li><li><p>Read marked as not covered lines, green as covered lines<br><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/intellij/not_covered.jpg" alt="img"><br><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/intellij/coveredjpg" alt="img"></p></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2019/06/27/api-testing/4-Productivity-SimpleMock/"/>
      <url>/2019/06/27/api-testing/4-Productivity-SimpleMock/</url>
      
        <content type="html"><![CDATA[<h1 id="The-Easiest-Mock-The-highest-ROI"><a href="#The-Easiest-Mock-The-highest-ROI" class="headerlink" title="The Easiest Mock, The highest ROI"></a>The Easiest Mock, The highest ROI</h1><p>Actually it is not about how to test Rule Based Risk Engine, it is about how to use simple codes to improve the<br>daily productivities. </p><p>The Risk Engine is in the middle of the whole system, The upstream and downstream modules leverage<br>the result of the Risk Engine by API call in their own business flow. When other modules’s tester want to execute their test cases,<br>they often wanted to get the different risk engine results on demand. That means I needed to support them for their cases<br>as I am the owner of risk engine. Everyday, I was interrupted serveral times. It really bothered me a lot. I can’t refuse, but<br>need to find a solution. Then the easiest mock came. </p><h2 id="Mock-Get-What-You-Set"><a href="#Mock-Get-What-You-Set" class="headerlink" title="Mock- Get What You Set!"></a>Mock- Get What You Set!</h2><p>It is quite simple but it is worth to write because it represents the value of codes which a tester can implement. I implemented a new WebService in our repo, and used a Map to store what the client set for mocking<br>purpose. Then next API call against the setting URL, the response is what the client Set even without any deployment or restart.</p><p>How can I achieve this? The most important thing is that we used the configuration center - <a href="https://github.com/ctripcorp/apollo" target="_blank" rel="noopener">Apollo</a>. But does this mean in real case? You never need to restart the server for changing application properties. It makes things easier. The whole process was that:</p><ol><li>Setup Mock by calling: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">2. Change the Risk Engine Url to ```http://domain/mock/A/getMock``` in Apollo Portal </span><br><span class="line">3. Deploy the changes</span><br><span class="line">4. Other modules&apos; QA now can control the Risk Engine Response for any cases.</span><br><span class="line">   And even more, this actually can be  applied to any other Http service to decouple modules,free my time, and keep me focusing</span><br><span class="line"></span><br><span class="line">Here is the simple codes.It only takes 10 minutes to complete, but it saved me a lot of time in daily basis.</span><br><span class="line"></span><br><span class="line">- GenericMockStore for store Mock</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">@Component</span><br><span class="line">@Profile(&quot;test&quot;)</span><br><span class="line">public class GenericMockMemStore &#123;</span><br><span class="line"></span><br><span class="line">    private ConcurrentHashMap&lt;String, Object&gt; mockStore = new ConcurrentHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    public void saveMock(String key, Object value) &#123;</span><br><span class="line">        this.mockStore.put(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Object getMock(String key) &#123;</span><br><span class="line">        return this.mockStore.get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ul><li>GenericMock Service</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/mock"</span>)</span><br><span class="line"><span class="meta">@Profile</span>(<span class="string">"test"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericMockController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> GenericMockMemStore mockMemStore;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/&#123;productName&#125;/setup"</span>)</span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MockSetupResponse <span class="title">setupMock</span><span class="params">(@RequestBody GenericMockResponse setupResponse,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       @PathVariable String productName,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       HttpServletRequest request)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        mockMemStore.saveMock(productName,setupResponse);</span><br><span class="line">        <span class="keyword">return</span> MockSetupResponse.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/&#123;productName&#125;/getMock"</span>,method = &#123;RequestMethod.GET,</span><br><span class="line">                                                                RequestMethod.POST,RequestMethod.PUT&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getMock</span><span class="params">(@PathVariable String productName,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       HttpServletRequest request)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span>  mockMemStore.getMock(productName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Here is an explaination for these codes:</p><ol><li>Two APIs:<ul><li><code>POST /mock/{productName}/setup</code>  for setup mock for the <code>productName</code> you set</li><li><code>/mock/{productName}/getMock</code> get the mock reponse which set previously</li></ul></li><li><code>GenericMockMemStore</code>: Store the mocks by key: productName in memory</li></ol><p>Like I said before, the automation testing is not about automation, but about writing codes for testing,and productivity.<br>Automation is a conception, not an action. It is too big to accomplish. But Writing codes is actionable, and you can see what<br>you accomplished and what you improved immediately.</p><p>And also know the infrastructure more, you will find the solution is in the upstream or low level.<br>This is a tip I used when I tested this project. Luckly it worked. But still it is not a perfect solution, there are qeustions over here:</p><ol><li>Is there any pain point to improve?</li><li>How to make it happen?</li><li>Don’t write any code, use exisitng tools like YAPI, can we achieve the same?</li></ol><p>Maybe you can find your answer, or stay tuned, I will write a post later.</p><p>Finally It is honor to make these codes in the develop official repos.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2019/06/27/api-testing/1-Demo-TestCase/"/>
      <url>/2019/06/27/api-testing/1-Demo-TestCase/</url>
      
        <content type="html"><![CDATA[<h1 id="Integration-Runner-Test-Case-Demo"><a href="#Integration-Runner-Test-Case-Demo" class="headerlink" title="Integration-Runner Test Case Demo"></a>Integration-Runner Test Case Demo</h1><p>Last chapter introduce how to build a test framework in two days,<br>In this chapter, let’s do demos:</p><ul><li>A Api TestCase</li><li>Api Chain Test Case</li><li>Pre-Condition And Verification Render to use context data</li></ul><h2 id="A-Api-TestCase"><a href="#A-Api-TestCase" class="headerlink" title="A Api TestCase"></a>A Api TestCase</h2><p>Here are two cases: </p><ol><li>after call HttpBin API, check the url field in response is <a href="http://httpbin.org" target="_blank" rel="noopener">http://httpbin.org</a></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"verification"</span>: &#123;<span class="string">"url"</span>: <span class="string">"is_equal_to http://httpbin.org"</span>&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>after call HttpBin API, check the headers.Accept field in response is application/json1</li></ol><p>The overall cases is:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"test_cases"</span>: [&#123;</span><br><span class="line">        <span class="string">"name"</span>: <span class="string">"getapi-tc-1"</span>,</span><br><span class="line">        <span class="string">"tc_id"</span>: <span class="string">"tc-get-1"</span>,</span><br><span class="line">        <span class="string">"steps"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"name"</span>: <span class="string">"http get api"</span>,</span><br><span class="line">                <span class="string">"precondition"</span>: &#123;&#125;,</span><br><span class="line">                <span class="string">"service"</span>: HttpBinGet,</span><br><span class="line">                <span class="string">"params"</span>: &#123;&#125;,</span><br><span class="line">                <span class="string">"verification"</span>: &#123;<span class="string">"url"</span>: <span class="string">"is_equal_to http://httpbin.org"</span>&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]&#125;</span><br><span class="line">    ,&#123;</span><br><span class="line">        <span class="string">"name"</span>: <span class="string">"getapi-tc-21"</span>,</span><br><span class="line">        <span class="string">"tc_id"</span>: <span class="string">"tc-get-2"</span>,</span><br><span class="line">        <span class="string">"steps"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"name"</span>: <span class="string">"http get api"</span>,</span><br><span class="line">                <span class="string">"precondition"</span>: &#123;&#125;,</span><br><span class="line">                <span class="string">"service"</span>: HttpBinGet,</span><br><span class="line">                <span class="string">"params"</span>: &#123;&#125;,</span><br><span class="line">                <span class="string">"verification"</span>: &#123;<span class="string">"headers.Accept"</span>: <span class="string">"is_equal_to application/json1"</span>&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]&#125;</span><br><span class="line"></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>and the demo codes are:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@allure.epic("testing http bin test cases")</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestHttpBinTestCase</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @allure.feature("testing http bin get")</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_httpbin_get</span><span class="params">(self)</span>:</span></span><br><span class="line">        runner = IntegrationExecutor(httpbinget_testcases)</span><br><span class="line">        result = runner.run()</span><br><span class="line">        <span class="keyword">assert</span> result.get_tc_result() == <span class="string">"pass"</span></span><br></pre></td></tr></table></figure><h2 id="Api-Chain-Test-Case"><a href="#Api-Chain-Test-Case" class="headerlink" title="Api Chain Test Case"></a>Api Chain Test Case</h2><p>test cases:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line">    <span class="string">"test_cases"</span>: [&#123;</span><br><span class="line">        <span class="string">"name"</span>: <span class="string">"tc description"</span>,</span><br><span class="line">        <span class="string">"tc_id"</span>: <span class="string">"testCaseId"</span>,</span><br><span class="line">        <span class="string">"steps"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"name"</span>: <span class="string">"http get api"</span>,</span><br><span class="line">                <span class="string">"precondition"</span>: &#123;&#125;,</span><br><span class="line">                <span class="string">"service"</span>: HttpBinGet,</span><br><span class="line">                <span class="string">"params"</span>: &#123;&#125;,</span><br><span class="line">                <span class="string">"post_action"</span>: &#123;<span class="string">"url"</span>: <span class="string">"url"</span>, <span class="string">"args"</span>: <span class="string">"args"</span>&#125;,</span><br><span class="line">                <span class="string">"verification"</span>: &#123;<span class="string">"url"</span>: <span class="string">"is_equal_to http://httpbin.org"</span>&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"name"</span>: <span class="string">"http post api"</span>,</span><br><span class="line">                <span class="string">"precondition"</span>: &#123;&#125;,</span><br><span class="line">                <span class="string">"service"</span>: HttpBinPOST,</span><br><span class="line">                <span class="string">"params"</span>: &#123;&#125;,</span><br><span class="line">                <span class="string">"post_action"</span>: &#123;&#125;,</span><br><span class="line">                <span class="string">"verification"</span>: &#123;<span class="string">"url"</span>: <span class="string">"is_equal_to http://httpbin.org"</span>&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@allure.epic("testing http bin test cases")</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestHttpBinTestCase</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @allure.feature("testing http bin get/post")</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_httpbin_tc</span><span class="params">(self)</span>:</span></span><br><span class="line">        runner = IntegrationExecutor(httpbin_testcases)</span><br><span class="line">        result = runner.run()</span><br><span class="line">        <span class="keyword">assert</span> result.get_tc_result() == <span class="string">"pass"</span></span><br></pre></td></tr></table></figure><p>the test cases code is almost same.</p><h2 id="Pre-Condition-And-Verification-Render-to-use-context-data"><a href="#Pre-Condition-And-Verification-Render-to-use-context-data" class="headerlink" title="Pre-Condition And Verification Render to use context data"></a>Pre-Condition And Verification Render to use context data</h2><p>This case is more complex, use pre-condition, post-action, and verficiation to checkout<br>how the context processing.</p><p>We have two Api:</p><ul><li><code>/json</code> api to get a json, in this api’s response, there is a <code>author</code> field,<br>value is “Yours Truly”</li><li><code>/cookies/set</code> api is to query a value by query parameter freeform</li></ul><p>So assume there is a workflow in real business:</p><ol><li>call <code>/json</code> to get author</li><li>then use the author name to query(call <code>/cookie./set</code>) some author properties </li></ol><p>The author name might be changed over time in different environment, so I have to call<br>the api first in step 1, then getting the author name as the second api’s input, finally call the second<br>api then verify the result .</p><p>So the example test cases is:</p><ul><li><p>Case 1: Use Context and Render Input and Verifications<br><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/complex_case.jpg" alt="img"></p></li><li><p>Case2: Use jinja2 built-in filter to handle parameters in test cases</p></li></ul><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/jinja2_filter.jpg" alt="img"></p><p>and again, there is no re-invention, just use the exiting jinja2 template</p><p>Detail please find the the codes in <a href="https://github.com/evenhumble/integration-executor-py" target="_blank" rel="noopener">github</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2019/06/27/api-testing/0-start-from-the-end/"/>
      <url>/2019/06/27/api-testing/0-start-from-the-end/</url>
      
        <content type="html"><![CDATA[<h1 id="Implement-A-Integration-Libs-in-two-days"><a href="#Implement-A-Integration-Libs-in-two-days" class="headerlink" title="Implement A Integration Libs in two days"></a>Implement A Integration Libs in two days</h1><p>There is a question over my head several times. is it real hard for tester to write test codes?<br>I don’t know, but I just want to do a task to evaluate this conclusion.</p><h2 id="Start-From-The-End"><a href="#Start-From-The-End" class="headerlink" title="Start From The End"></a>Start From The End</h2><p>I don’t prefer the term <strong><em>automation testing</em></strong>, but like the term <strong><em>write testing codes</em></strong>.<br>Automation testing is almost defined as failure in most of testers’s mind(not company, company still think it is valuable).<br>As I known, many testers(a big portion actually) just think automation testing is a political job which actually has no value at all in reality.<br>Most of the automation cases are never used after it passed one time.<br>Almost in every testing meet-up, there is always someone talked about test platform,how good it is,how easy to use.<br>But in reality,almost every test platform user complained the test platform is to hard to use. Why? and what’s the gap between those platform and<br>their users. </p><p>I don’t know. But I just believe automation testing will never happen if you never write codes, only doing configuration like coding.<br>Write scripts should be a basic skill for tester, like eating or drinking. </p><p>And in other hands, setting a high expectation in a short period of time which is way beyond the average tester’s coding skill.<br>There are too much legacy debit out there. High expectation meets even high debit, it can easily crash you.<br>The delayed schedule, the unreachable target, and voices like automation testing doesn’t work is just around you.<br>Finally, you will find out automation never from nowhere, it happened when you write codes line by line just.<br>And if you re-think about automation, it is quite reasonable. It is just like a product which want to automate business flow. The product is built by<br>tons of codes. So does automation testing. And also to pay back the debit, accumulate codes in daily basis in the key. Don’t expected to pay back it<br>in a short time, just focus accumulating the tests day in and day out, then someday, you will feel a little easy.</p><p>Back to the topic, What the task is given to myself is that:</p><ol><li>Write A Simple Integration Libs as a tiny testing framework(just work) in 2-3 days</li><li>Leverage Existing Libs as more as possible, and don’t write too much complex codes</li><li>Integration library, not a http library. It is open for different component client</li><li>The test codes could be used in any other place,but not only for testing</li><li>Not strict, different coding level can use and ramp  up</li></ol><h2 id="Let’s-getting-start"><a href="#Let’s-getting-start" class="headerlink" title="Let’s getting start"></a>Let’s getting start</h2><p>Think about integration testing(not consider UI), it is actually calling different service or api, then get a result to verify.<br><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/test-service.jpg" alt="img"></p><p>And if in more complex workflow, it looks like a workflow or api call chain<br><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/chained-invoker.jpg" alt="img"></p><p>So I need to abstract these into following conception:</p><ol><li><strong><em>Executor</em></strong>: execute the who process no matter how many steps the test case should have</li><li><strong><em>Client</em></strong>: every api/service invoker is a client, no matter http,redis,database or whatever tester used in daily<br>basis for send a request to get a response </li><li><strong><em>Validator</em></strong>: verify the result</li><li><strong><em>TestCase</em></strong>:  test cases with test case data and steps</li></ol><h2 id="Executor-Integration-Executor"><a href="#Executor-Integration-Executor" class="headerlink" title="Executor - Integration Executor"></a>Executor - Integration Executor</h2><p>Integration Executor is used to run the whole test case, and it is the core<br>of this tiny lib, it targets to connect all the things used when testing.</p><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/process.jpg" alt="img"></p><p>Before implement it, make the code structure first, it is quite clean and easy to understand</p><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/runner_structure.jpg" alt="img"></p><p>Let’s do following things to implement it:</p><ol><li>define the test case data structure</li><li>implement a generic client</li><li>implement a extractor to extract data from response</li><li>implement a validator to validate result</li><li>implement a context to store and calculate runtime data when execute test cases</li></ol><h2 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h2><p>The client implement is for generic purpose, so I just define a callable object<br>or with a invoke method:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Client</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, params, env)</span>:</span></span><br><span class="line">        self.params = params</span><br><span class="line">        self.env = env</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">invoke</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        what ever</span></span><br><span class="line"><span class="string">        :return: ClientResponse</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError(<span class="string">"abstract class, need an implementation"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        print(<span class="string">"client should a callable object or with a invoke method"</span>)</span><br><span class="line">        <span class="keyword">return</span> self.invoke()</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line"><span class="keyword">and</span> the response <span class="keyword">for</span> a client also need to be unified <span class="keyword">and</span> generic:</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClientResponse</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>So basically I defined a generic client which the input is :</p><ol><li><figure class="highlight plain"><figcaption><span>input test data</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">2. ```env```: target environment</span><br><span class="line"></span><br><span class="line">Output is:</span><br><span class="line"></span><br><span class="line">```ClientReponse```: Generic Output Object, which have a status code and response data, data should </span><br><span class="line">be in json or dict which is easy to handle </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A http client is implement based on python ```requests``` lib.</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">http_methods = &#123;</span><br><span class="line"></span><br><span class="line">    &quot;get&quot;: requests.get,</span><br><span class="line">    &quot;post&quot;: requests.post,</span><br><span class="line">    &quot;delete&quot;: requests.delete,</span><br><span class="line">    &quot;put&quot;: requests.put,</span><br><span class="line">    &quot;option&quot;: requests.options</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class HttpClient(Client):</span><br><span class="line">    req_url = &quot;&quot;</span><br><span class="line">    domain = &quot;&quot;</span><br><span class="line">    headers = &#123;</span><br><span class="line">        &quot;accept&quot;: &quot;application/json&quot;,</span><br><span class="line">        &quot;content-type&quot;: &quot;application/json&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    req_body = &#123;&#125;  ## make sure the some variables with default values</span><br><span class="line">    query_params = []</span><br><span class="line">    method = &quot;post&quot;</span><br><span class="line"></span><br><span class="line">    def __init__(self, params, env):</span><br><span class="line">        super().__init__(params, env)</span><br><span class="line"></span><br><span class="line">    def invoke(self):</span><br><span class="line">        real_req_url = self.__build_request_url()</span><br><span class="line">        self.__build_header()</span><br><span class="line">        self.__build_body()</span><br><span class="line">        http_method = http_methods.get(self.method.lower(), requests.get)</span><br><span class="line">        response = http_method(url=real_req_url, headers=self.headers, data=self.req_body)</span><br><span class="line">        return make_client_response(response)</span><br><span class="line"></span><br><span class="line">    def __build_request_url(self):</span><br><span class="line">        if self.env.get_config_by_key(self.domain) is None:</span><br><span class="line">            raise ClientException(&quot;domain name should be set in environment or config file&quot;)</span><br><span class="line">        else:</span><br><span class="line">            url = self.env.get_config_by_key(self.domain)</span><br><span class="line"></span><br><span class="line">        real_req_url = url + self.__make_request_path() + self.__make_query_url()</span><br><span class="line">        return real_req_url</span><br><span class="line"></span><br><span class="line">    def __build_header(self):</span><br><span class="line">        if self.params.get(&quot;headers&quot;, &quot;&quot;) != &quot;&quot;:</span><br><span class="line">            for h_name, h_value in self.params.get(&quot;headers&quot;).items():</span><br><span class="line">                self.headers.update(&#123;h_name: h_value&#125;)</span><br><span class="line"></span><br><span class="line">    def __make_request_path(self):</span><br><span class="line">        self.req_url = self.req_url.format(**self.params)</span><br><span class="line">        return self.req_url</span><br><span class="line"></span><br><span class="line">    ## todo: set value in a dict,use path</span><br><span class="line">    def __build_body(self):</span><br><span class="line">        for param_name, param_value in self.params.items():</span><br><span class="line">            kv_util.set_value(self.req_body, param_name, param_value)</span><br><span class="line"></span><br><span class="line">    def __make_query_url(self):</span><br><span class="line">        query_url = &quot;&quot;</span><br><span class="line">        if len(self.query_params) &gt; 0:</span><br><span class="line">            query_url = query_url + &quot;?&quot;</span><br><span class="line">        # query_temp =&quot;%s=%s&amp;&quot;</span><br><span class="line">        for query_param in self.query_params:</span><br><span class="line">            if self.params.get(query_param, &quot;&quot;) != &quot;&quot;:</span><br><span class="line">                query_url = query_url + query_param + &quot;=&quot; + self.params.get(query_param, &quot;&quot;) + &quot;&amp;&quot;</span><br><span class="line">        return query_url</span><br></pre></td></tr></table></figure></li></ol><p>Don’t invent any new thing, just use <a href="http://docs.python-requests.org/zh_CN/latest/user/quickstart.html" target="_blank" rel="noopener">requests</a></p><h2 id="Extractor"><a href="#Extractor" class="headerlink" title="Extractor"></a>Extractor</h2><p> First of all, why I need an extractor?<br> The extractor is used to get a value from a json or dict by an expression like jsonpath.<br> So that we can leverage this tiny tool to get any value in response.</p><p> The demo:</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">simple_dict_json = &#123;</span><br><span class="line">    <span class="string">"characters"</span>: &#123;</span><br><span class="line">        <span class="string">"Lonestar"</span>: &#123;</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">55923</span>,</span><br><span class="line">            <span class="string">"role"</span>: <span class="string">"renegade"</span>,</span><br><span class="line">            <span class="string">"items"</span>: [</span><br><span class="line">                <span class="string">"space winnebago"</span>,</span><br><span class="line">                <span class="string">"leather jacket"</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"Barfolomew"</span>: &#123;</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">55924</span>,</span><br><span class="line">            <span class="string">"role"</span>: <span class="string">"mawg"</span>,</span><br><span class="line">            <span class="string">"items"</span>: [</span><br><span class="line">                <span class="string">"peanut butter jar"</span>,</span><br><span class="line">                <span class="string">"waggy tail"</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"Dark Helmet"</span>: &#123;</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">99999</span>,</span><br><span class="line">            <span class="string">"role"</span>: <span class="string">"Good is dumb"</span>,</span><br><span class="line">            <span class="string">"items"</span>: [</span><br><span class="line">                <span class="string">"Shwartz"</span>,</span><br><span class="line">                <span class="string">"helmet"</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"Skroob"</span>: &#123;</span><br><span class="line">            <span class="string">"id"</span>: <span class="number">12345</span>,</span><br><span class="line">            <span class="string">"role"</span>: <span class="string">"Spaceballs CEO"</span>,</span><br><span class="line">            <span class="string">"items"</span>: [</span><br><span class="line">                <span class="string">"luggage"</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestDataExtractor</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_list_get_value_by_exp</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = data_extractor.get_value_by_exp(simple_dict_json, <span class="string">"characters"</span>)</span><br><span class="line">        <span class="keyword">assert</span> len(result) &gt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_get_value_by_exp</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = data_extractor.get_value_by_exp(simple_dict_json, <span class="string">"characters.Lonestar.items[0]"</span>)</span><br><span class="line">        <span class="keyword">assert</span> result == <span class="string">"space winnebago"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_get_value_by_exp_not_exist</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = data_extractor.get_value_by_exp(simple_dict_json, <span class="string">"characters.Lonestar323.items[0]"</span>)</span><br><span class="line">        <span class="keyword">assert</span> result == <span class="string">"space winnebago"</span></span><br></pre></td></tr></table></figure><p>just give a path expression, then get the value without going to a json level by level.</p><p>Don’t invent new thing:  the implementation is relied on following lib:</p><ul><li>jmespath</li><li>dictor</li></ul><h2 id="Validator"><a href="#Validator" class="headerlink" title="Validator"></a>Validator</h2><p>Validator is used to validate if an actually result meets the expected result.</p><p>Also, refer to the assertPy, I did a function to validate result:</p><p>The Demo: </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestValidator</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_demos</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = validator.validate(<span class="string">"value"</span>,<span class="string">"is_equal_to test"</span>)</span><br><span class="line">        <span class="keyword">assert</span> result[<span class="number">0</span>],<span class="string">"fail"</span></span><br><span class="line">        print(str(result[<span class="number">1</span>]))</span><br></pre></td></tr></table></figure><h2 id="Test-Case"><a href="#Test-Case" class="headerlink" title="Test Case"></a>Test Case</h2><p>Test Case is to connect all these things to feed into Integration Runner</p><p>The Basic Schema is :</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> &#123;</span><br><span class="line">    <span class="attr">"test_cases"</span>: [&#123;</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"tc description"</span>,</span><br><span class="line">        <span class="attr">"tc_id"</span>: <span class="string">"testCaseId"</span>,</span><br><span class="line">        <span class="attr">"steps"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"http get api"</span>,</span><br><span class="line">                <span class="attr">"precondition"</span>: &#123;&#125;,</span><br><span class="line">                <span class="attr">"service"</span>: HttpBinGet,</span><br><span class="line">                <span class="attr">"params"</span>: &#123;&#125;,</span><br><span class="line">                <span class="attr">"post_action"</span>: &#123;<span class="attr">"url"</span>: <span class="string">"url"</span>, <span class="attr">"args"</span>: <span class="string">"args"</span>&#125;,</span><br><span class="line">                <span class="attr">"verification"</span>: &#123;<span class="attr">"url"</span>: <span class="string">"is_equal_to http://httpbin.org"</span>&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"http post api"</span>,</span><br><span class="line">                <span class="attr">"precondition"</span>: &#123;&#125;,</span><br><span class="line">                <span class="attr">"service"</span>: HttpBinPOST,</span><br><span class="line">                <span class="attr">"params"</span>: &#123;<span class="attr">"url"</span>: <span class="string">"&#123;&#123;args&#125;&#125;"</span>&#125;,</span><br><span class="line">                <span class="attr">"post_action"</span>: &#123;&#125;,</span><br><span class="line">                <span class="attr">"verification"</span>: &#123;<span class="attr">"url"</span>: <span class="string">"is_equal_to http://httpbin.org"</span>, <span class="attr">"json"</span>: <span class="string">"is_none"</span>&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The schema is easy to understand. The <figure class="highlight plain"><figcaption><span>is for a Python Object, here</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">HttpBinGet is an api for call HttpBinGet service, and the service is also easy to </span><br><span class="line">implement.</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">class HttpBinGet(HttpClient):</span><br><span class="line">    req_url = &quot;/get&quot;</span><br><span class="line">    domain = &quot;domain&quot;</span><br><span class="line">    headers = &#123;</span><br><span class="line">        &quot;accept&quot;: &quot;application/json&quot;,</span><br><span class="line">        &quot;content-type&quot;: &quot;application/json&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    req_body = &#123;&#125;  ## make sure the some variables with default values</span><br><span class="line">    query_params = []</span><br><span class="line">    method = &quot;GET&quot;</span><br></pre></td></tr></table></figure></p><h2 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h2><p>Context is used for store and calculate data. It will be used in executor<br>in process pre-condition and post action to handler.</p><p>What data context stored in key-value manner, for example:</p><p>in test case data:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"post_action"</span>: &#123;<span class="string">"url1"</span>: <span class="string">"url"</span>, <span class="string">"args1"</span>: <span class="string">"args"</span>&#125;</span><br></pre></td></tr></table></figure><p>the post action processor will put url1 as key, the value is the value extracted<br>by the path “url” from response</p><p>and also, the context will used to render data in process pre-condition,<br>because some input data is in generated in runtime:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"params"</span>: &#123;<span class="string">"url"</span>: <span class="string">"&#123;&#123;args&#125;&#125;"</span>&#125;</span><br></pre></td></tr></table></figure> will be replaced by a value which is from response before. Use python template lib<p>jinja2 can achieve it.</p><h2 id="Revisit-Executor"><a href="#Revisit-Executor" class="headerlink" title="Revisit Executor"></a>Revisit Executor</h2><p>Now every tiny thing is ready for Executor. And everything is ready.</p><p>For Detail please refer the demo.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Rule Based Risk Engine Part 3 - The Easiest Mock, The highest ROI</title>
      <link href="/2019/04/28/api-testing/CreditRisk-Testing-3/"/>
      <url>/2019/04/28/api-testing/CreditRisk-Testing-3/</url>
      
        <content type="html"><![CDATA[<h1 id="Rule-Based-Risk-Engine-Part-3-The-Easiest-Mock-The-highest-ROI"><a href="#Rule-Based-Risk-Engine-Part-3-The-Easiest-Mock-The-highest-ROI" class="headerlink" title="Rule Based Risk Engine Part 3 - The Easiest Mock, The highest ROI"></a>Rule Based Risk Engine Part 3 - The Easiest Mock, The highest ROI</h1><p>Actually it is not about how to test Rule Based Risk Engine, it is about how to use simple codes to improve the<br>daily productivities. </p><p>The Risk Engine is in the middle of the whole system, The upstream and downstream modules leverage<br>the result of the Risk Engine by API call in their own business flow. When other modules’s tester want to execute their test cases,<br>they often wanted to get the different risk engine results on demand. That means I needed to support them for their cases<br>as I am the owner of risk engine. Everyday, I was interrupted serveral times. It really bothered me a lot. I can’t refuse, but<br>need to find a solution. Then the easiest mock came. </p><h2 id="Mock-Get-What-You-Set"><a href="#Mock-Get-What-You-Set" class="headerlink" title="Mock- Get What You Set!"></a>Mock- Get What You Set!</h2><p>It is quite simple but it is worth to write because it represents the value of codes which a tester can implement. I implemented a new WebService in our repo, and used a Map to store what the client set for mocking<br>purpose. Then next API call against the setting URL, the response is what the client Set even without any deployment or restart.</p><p>How can I achieve this? The most important thing is that we used the configuration center - <a href="https://github.com/ctripcorp/apollo" target="_blank" rel="noopener">Apollo</a>. But does this mean in real case? You never need to restart the server for changing application properties. It makes things easier. The whole process was that:</p><ol><li>Setup Mock by calling: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">2. Change the Risk Engine Url to ```http://domain/mock/A/getMock``` in Apollo Portal </span><br><span class="line">3. Deploy the changes</span><br><span class="line">4. Other modules&apos; QA now can control the Risk Engine Response for any cases.</span><br><span class="line">   And even more, this actually can be  applied to any other Http service to decouple modules,free my time, and keep me focusing</span><br><span class="line"></span><br><span class="line">Here is the simple codes.It only takes 10 minutes to complete, but it saved me a lot of time in daily basis.</span><br><span class="line"></span><br><span class="line">- GenericMockStore for store Mock</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">@Component</span><br><span class="line">@Profile(&quot;test&quot;)</span><br><span class="line">public class GenericMockMemStore &#123;</span><br><span class="line"></span><br><span class="line">    private ConcurrentHashMap&lt;String, Object&gt; mockStore = new ConcurrentHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    public void saveMock(String key, Object value) &#123;</span><br><span class="line">        this.mockStore.put(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Object getMock(String key) &#123;</span><br><span class="line">        return this.mockStore.get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ul><li>GenericMock Service</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/mock"</span>)</span><br><span class="line"><span class="meta">@Profile</span>(<span class="string">"test"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericMockController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowire</span></span><br><span class="line">    <span class="keyword">private</span> GenericMockMemStore mockMemStore;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/&#123;productName&#125;/setup"</span>)</span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MockSetupResponse <span class="title">setupMock</span><span class="params">(@RequestBody GenericMockResponse setupResponse,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       @PathVariable String productName,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       HttpServletRequest request)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        mockMemStore.saveMock(productName,setupResponse);</span><br><span class="line">        <span class="keyword">return</span> MockSetupResponse.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/&#123;productName&#125;/getMock"</span>,method = &#123;RequestMethod.GET,</span><br><span class="line">                                                                RequestMethod.POST,RequestMethod.PUT&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getMock</span><span class="params">(@PathVariable String productName,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       HttpServletRequest request)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span>  mockMemStore.getMock(productName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Here is an explaination for these codes:</p><ol><li>Two APIs:<ul><li><code>POST /mock/{productName}/setup</code>  for setup mock for the <code>productName</code> you set</li><li><code>/mock/{productName}/getMock</code> get the mock reponse which set previously</li></ul></li><li><code>GenericMockMemStore</code>: Store the mocks by key: productName in memory</li></ol><p>Like I said before, the automation testing is not about automation, but about writing codes for testing,and productivity.<br>Automation is a conception, not an action. It is too big to accomplish. But Writing codes is actionable, and you can see what<br>you accomplished and what you improved immediately.</p><p>And also know the infrastructure more, you will find the solution is in the upstream or low level.<br>This is a tip I used when I tested this project. Luckly it worked. But still it is not a perfect solution, there are qeustions over here:</p><ol><li>Is there any pain point to improve?</li><li>How to make it happen?</li><li>Don’t write any code, use exisitng tools like YAPI, can we achieve the same?</li></ol><p>Maybe you can find your answer, or stay tuned, I will write a post later.</p><p>Finally It is honor to make these codes in the develop official repos.</p>]]></content>
      
      
      
        <tags>
            
            <tag> real </tag>
            
            <tag> think-different </tag>
            
            <tag> productivity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Think in Testing 1-Be Tough</title>
      <link href="/2019/04/28/real/Thoughts-Be-A-Touch-Tester/"/>
      <url>/2019/04/28/real/Thoughts-Be-A-Touch-Tester/</url>
      
        <content type="html"><![CDATA[<h1 id="Think-in-Testing-1-Be-Tough"><a href="#Think-in-Testing-1-Be-Tough" class="headerlink" title="Think in Testing 1: Be Tough"></a>Think in Testing 1: Be Tough</h1><p>If someone tell you that software testing or quality assurance is an easy job to do, he/she might not understand what a tester or qa do.  There are many perspective a tester or qa involved:</p><ol><li>Testing</li><li>Requirement Clarification</li><li>Dev Process/Release Process </li><li>Planning</li></ol><p>Almost every phase QA is involved, it can burn you out easily. Here I just want to talk about some bad thing might happed, and why be tough is a basic charactor of a QA or Tester.</p><h2 id="Don’t-Be-a-maid"><a href="#Don’t-Be-a-maid" class="headerlink" title="Don’t Be a maid"></a>Don’t Be a maid</h2><p>Don’t be a maid, and don’t spend too much time on other’s careless and irresponsibility.<br>Need to fix it.</p><p>In many Chinese domestic company, Tester and QA is a maid of Developer, everything could be in testing scope. Let me summarize several common cases:</p><ol><li>Some incomplete task, need to test</li><li>Some codes never work, neet to test</li><li>Some bug can’t be produced, need to test</li><li>Some performance issues can’t be measured, need to test</li><li>What ever the requirement is, no matter you tester invovled or not, send it to test</li></ol><p>And more important thing is that normally a tester/qa might face 5+ developers. If you can not be tough to Dev, your time and career might be spent for taking care of these guys mistakes,careless. Tester/QA is responsible for the product, not for careleass.<br>Yes, your are finding bugs, but what behind these bugs are careless and irresponsibility. You need to fix careless and irresponsibility though it is tough, so be tough.</p><p>When a production bug occurred, no one will stand in your side.<br>So you need to exposure the facts, I mean real facts, where these bugs? and Why so many bugs, then you can push to reduce bugs, and push DEV moving forward, otherwise every dirty work will on your shoulder. Does DEV not know Unit test can help quality? They know,  Does DEV not know they should tell you a little bit more what a requirement is, because they know you don’t invloved at all in first place? They know, explaination is not a techinical work, in their option, it is not worth to do, that’s it.</p><p>So just tell the dev/dev manager what you want, what the result right now, what is good and what is bad, they will learn from that. Dev Manager love to see feedback. Only thing<br>need to pay attention might be the reporting skill, and how to handle conflict.</p><p>Be a maid is no future in tech world, no one really care about what the careless is, they care about the careless issue should be never happened. You can’t only spend time for others careless, you need to fix it for the root cause.<br>Good Luck, and we tester have long way to go, be tough!</p><h2 id="Show-the-Data-Metrics"><a href="#Show-the-Data-Metrics" class="headerlink" title="Show the Data,Metrics"></a>Show the Data,Metrics</h2><p>Show the data, metrics is good to be professional, and just focus on the thing your team are talked about, not finger point. It can help you be tough and reasonable.<br>But What kind data you can show? It is a question, and also hard to implement. Based on my experience, data like:</p><ol><li>How many Bugs in a sprint?</li><li>How the bugs distributed?</li><li>How a typical bug impact the whole process?</li><li>What the turn around time for the bug or an iteration?</li></ol><p>It is hard to collect data, but it is still worth to collect some of them.</p>]]></content>
      
      
      
        <tags>
            
            <tag> real </tag>
            
            <tag> think-different </tag>
            
            <tag> productivity </tag>
            
            <tag> ThinkInTesting </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rule Based Risk Engine Part 2 - Write Code to Test</title>
      <link href="/2019/04/25/api-testing/CreditRisk-Testing-2/"/>
      <url>/2019/04/25/api-testing/CreditRisk-Testing-2/</url>
      
        <content type="html"><![CDATA[<h1 id="Rule-Based-Risk-Engine-Part-2-Write-Code-to-Test"><a href="#Rule-Based-Risk-Engine-Part-2-Write-Code-to-Test" class="headerlink" title="Rule Based Risk Engine Part 2 - Write Code to Test"></a>Rule Based Risk Engine Part 2 - Write Code to Test</h1><p>What to do is quite obvious:</p><ol><li>Compose input data - Test Case Input<ul><li>Fundamental Data</li><li>Third Party And in-house data</li></ul></li><li>Mock the third party and in-house data according test cases</li><li>Call the Evaluation API to checkout if meet the expectation</li></ol><p>And how to write code? I separate into different modules:</p><ul><li>TestCaseLoader: load the whole input parameters</li><li>DataFactory: Produce different Data as input parameters<ul><li>RiskInputDataFactory</li><li>MockDataFactory</li><li>Some Auto Generated Data Helper for testing purposes</li></ul></li><li>Clients: invoke evaluation api and mock service api<ul><li>RiskEvaluationClient</li><li>MockClient</li></ul></li><li>Third Party and In-house Data Feature Manager <ul><li>Feature Manager</li></ul></li><li>Test Case Runner<ul><li>TestCase Runner Template</li></ul></li></ul><p><img src="images/img/risk-test-flow.jpg" alt="img"></p><h2 id="Implement-The-different-Modules-TestCaseLoader"><a href="#Implement-The-different-Modules-TestCaseLoader" class="headerlink" title="Implement The different Modules - TestCaseLoader"></a>Implement The different Modules - TestCaseLoader</h2><p>TestCaseLoader, levarage easy-poi, it helps you to read/write excel<br>very quickly. For how to use easy-poi, please refer <a href="http://easypoi.mydoc.io/" target="_blank" rel="noopener">easy-poi</a></p><h2 id="Implement-The-different-Modules-Datafactory"><a href="#Implement-The-different-Modules-Datafactory" class="headerlink" title="Implement The different Modules - Datafactory"></a>Implement The different Modules - Datafactory</h2><p>All about handle data, so need some utility class, </p><ul><li>IdCard Generator</li><li>Generate IDCard through age</li><li>Generate several ids, like request id</li><li>Generate Times, such as creditTime</li></ul><p>So I just write all these utilities, they are in <a href></a></p><h2 id="Implement-The-different-Modules-MockDataFactory"><a href="#Implement-The-different-Modules-MockDataFactory" class="headerlink" title="Implement The different Modules - MockDataFactory"></a>Implement The different Modules - MockDataFactory</h2><p>It is very hard at the beginning,  because there is not place to indicate there third party and in-house data name, and also there is big amount of these features. </p><p>Finally I just find out that leverage Dev’s codes is the bese option. Do a quick change, and use Spring Class Scanner function do helo me a lot to achieve to mange the third part and in-houce data.</p><h2 id="Implement-The-different-Modules-Clients"><a href="#Implement-The-different-Modules-Clients" class="headerlink" title="Implement The different Modules - Clients"></a>Implement The different Modules - Clients</h2><p>It is quite simple, just leverage the Okwrap client.</p><h2 id="Implement-The-different-Modules-TestRunner"><a href="#Implement-The-different-Modules-TestRunner" class="headerlink" title="Implement The different Modules - TestRunner"></a>Implement The different Modules - TestRunner</h2><p>TestRunnerTemplate</p><ul><li>Before</li><li>Run</li><li>After</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> patterns </tag>
            
            <tag> testing </tag>
            
            <tag> API Testing </tag>
            
            <tag> real </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rule Based Risk Engine Testing Part 1- Background</title>
      <link href="/2019/04/23/api-testing/CreditRisk-Testing-1/"/>
      <url>/2019/04/23/api-testing/CreditRisk-Testing-1/</url>
      
        <content type="html"><![CDATA[<h1 id="Rule-Based-Risk-Engine-Testing-Part-1-Background"><a href="#Rule-Based-Risk-Engine-Testing-Part-1-Background" class="headerlink" title="Rule Based Risk Engine Testing Part 1- Background"></a>Rule Based Risk Engine Testing Part 1- Background</h1><p>This article introduces a real world case for testing a rule based risk engine. Let me separate it into several parts:</p><ul><li>System Overview to introduct the rule based risk engine</li><li>Typical Cases</li><li>Automate the test cases, and how ?</li></ul><h2 id="1-Rule-Based-Risk-Engine-System-Overview"><a href="#1-Rule-Based-Risk-Engine-System-Overview" class="headerlink" title="1. Rule Based Risk Engine System Overview"></a>1. Rule Based Risk Engine System Overview</h2><p>This is my fist risk engine project. I am not sure how other risk engine does,just try to introduce what I experienced, and what I had found.</p><p>Let’s start with what this module does. In short, this risk engine provides a capability to rate a loan applicant from whethere he/she is eligible for a loan to how much he/she can borrow. So There are two major results:</p><ul><li>is eligible?</li><li>And what the score/credit amount/terms for this applicant</li></ul><p>And there are different products to apply, so the rule and rating system should be configurable. There are rule engine,scorecard and decision tree components to meet the configuration needs.</p><p>The whole workflow is like this:</p><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/risk-flow-1.jpg" alt="img"></p><p>The whole system is a decision flow, which includes<br>anti-fraud rules, score-card for rating and decision tree to make a decision. If you wanto unify it, it is a decision flow, which composed by rules and decision trees.</p><h3 id="1-1-A-short-introduction-for-Rule-Engine"><a href="#1-1-A-short-introduction-for-Rule-Engine" class="headerlink" title="1.1 A short introduction for Rule Engine"></a>1.1 A short introduction for Rule Engine</h3><p><a href="https://www.martinfowler.com/bliki/RulesEngine.html" target="_blank" rel="noopener">Rule Engine</a> article from Martin Flow, it abstracts rule engine into three conceptions:</p><ol><li>Condition</li><li>Action</li><li>Chain</li></ol><p>Basically A rule includes conditons and actions, and the chain composites these rules’ conditions and actions by a runtime context.</p><p>An example in this blog for explaination:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if car.owner.hasCellPhone then premium += 100;</span><br><span class="line">if car.model.theftRating &gt; 4 then premium += 200;</span><br><span class="line">if car.owner.livesInDodgyArea &amp;&amp; car.model.theftRating &gt; 2 </span><br><span class="line">then premium += 300;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>is condition, and ```then``` is action, one ```rule```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">is composed by one ```if``` and one ```then```. And the chain is composed by different rules. Obviously the ```premium``` should be in the chain context in this case, because it passed through the whole rule sets.</span><br><span class="line"></span><br><span class="line">Quite simple and easy to understand.The single rule is simple enough, so the testing might be undervalued. Think about if there are hundrends rules out there, test and understand the whole picture might be not easy compared with a single rule. This is what Martin Flow claimed, and also he worried about the implicit rule and context in the rule engine module.</span><br><span class="line"></span><br><span class="line">The Rule Risk Engine I meet was simillar to what mentioned in this blog. The difference is that it has wight point for socre card and decision tree modules. In this system, a rule is A node which contains:</span><br><span class="line"></span><br><span class="line">1. Expressions for evaluating an input data</span><br><span class="line">2. A Weight for a rule</span><br><span class="line">3. Composite Rule for Weight Point to make different disicion</span><br><span class="line">4. Also this Node points a true or false path to go different evaluation path</span><br><span class="line"></span><br><span class="line">What ever these nodes contain, just think about it is a chain or composite rule. Here is a simple case to demostrate how the system works:</span><br><span class="line"></span><br><span class="line">![img](https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/DecisionFlow.jpg)</span><br><span class="line"></span><br><span class="line">The output is a score. A score represents how much could be borrowed in a loan system. In this simple case, the age might be a implicit feature which should be fetched by internal api based on fundamental data like IDCard Number or SSN Number. And the rules and score card rules are pre-defined(So it is ruled based system).</span><br><span class="line"></span><br><span class="line">So you can understand the whole module in this way:</span><br><span class="line"></span><br><span class="line">1. Featch all relative data for the rules based on the fundamental information, these relative data need to be mocked because I can&apos;t control what third party api returned, while tests need to controll what the thrid party api should return as an input variable.</span><br><span class="line">2. Go through all the rule nodes, evaluate the result and the score to get a conclusion which indicates eliable for a loan, and how much could be borrowed.</span><br><span class="line"></span><br><span class="line">So the modules should aim at how to fetch the data(facts) , and how to go through the rule engine to calculate a score. And so does this module. </span><br><span class="line"></span><br><span class="line">### 1.2 Rule Based Risk Engine Components</span><br><span class="line"></span><br><span class="line">Here are components:</span><br><span class="line"></span><br><span class="line">![img](https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/risk-flow-2.jpg)</span><br><span class="line"></span><br><span class="line">There are many different tech stack used, such as elastic search, mongodb, hbase, redis,spring boot, rule engine,etc. It is hard to test in my first impression, not only it is complex, but also I only had one week to understand the whole system, and I am the only person who is responsoible for testing, meanwhile there are actual 7 developers out there.</span><br><span class="line"></span><br><span class="line">Learn it,separate the concerns, and then check out what these components really do:</span><br><span class="line"></span><br><span class="line">- ***Third Party Service*** : Fetch Data,it calls different third party services to get some risk relative values like what the income level of an applicant, is there any loans, is there any overdue during the past one year,etc. Then provide these data to rule engine as facts(so called risk features)</span><br><span class="line">- ***Data Aggeragation Service***: Fetch Data from in-house data warehouse,aggeragating in house data to provide to rule engine as facts/risk features</span><br><span class="line">- ***Data Collection Service***: Fetch Data,simillar too, collect different in house data to provide to rule engin as facts/risk features</span><br><span class="line">- ***Rule Engine***: Rules Engine,process the risk evaluation to figure out eligable result and risk rating result</span><br><span class="line">- ***Rule Tracing***: supplement component, tracing every rule evalution result for debug to error diagose</span><br><span class="line">- ***Risk Evaluation Store***: supplement component,store rule evealution result</span><br><span class="line">- ***rule tracing, risk result store***, these are supplement components, they may be important later but not now because this is a rule engine system for a startup department, just starting to accomulate the risk data</span><br><span class="line"></span><br><span class="line">After dive into these components a little bit, It is easy to find out that the key critical component is the Rule engine in current stage which shoule be absolutely the priority. Other components are more like data collector/feeder or result recorder. They should be important if the volumn of users increased,or more features need to be produced. But on current stage,it is just a MVP product which try to validate if the idea is feasible.</span><br><span class="line"></span><br><span class="line">The more things need to do, the more I need to focus a critical componet. So I focused the Rule Engine first.</span><br><span class="line"></span><br><span class="line">### 1.3 Rule Engine Typical Cases</span><br><span class="line"></span><br><span class="line">The rule engine typical cases is that:</span><br><span class="line">![img](https://raw.githubusercontent.com/evenhumble/hustle-player/master//img/RiskEventFlow.jpg)</span><br><span class="line"></span><br><span class="line">The things turn out that, rule engine accepts income risk input, and leverage all the different data from third party/data collection/data aggeragation services, then output the risk rating.</span><br><span class="line"></span><br><span class="line">Let me summary it in a tester point view, rule engine&apos;s input is different data, and the output is the data calculated by the rules. If the rule composed by rules,and decision tree, the test cases covered all the node and path, then it is good to go. </span><br><span class="line"></span><br><span class="line">### 1.4  Test It</span><br><span class="line"></span><br><span class="line">Let&apos;s see a test case first:</span><br><span class="line"></span><br><span class="line">Test Case Input:</span><br><span class="line"></span><br><span class="line">```json</span><br><span class="line">&#123;</span><br><span class="line">    &quot;riskFeatures&quot;: &#123;</span><br><span class="line">      &quot;idNumber&quot;: &quot;610304199801120878&quot;,</span><br><span class="line">        &quot;levelType&quot;: &quot;10&quot;,</span><br><span class="line">        &quot;flowNo&quot;: &quot;1506&quot;,</span><br><span class="line">        &quot;applicationId&quot;: &quot;ac8e120c-3615-4bdb-a92d-a118e24e33da&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>I can change the levelType to different value, then send to risk evaluation api to get different result.<br>And this is typical test cases design.</p><p>Testing a Rule steps: </p><ol><li>change the risk input date</li><li>call risk evaluation api</li><li>get result and check the result</li></ol><p>It looks very easy. The problem is how many these kind of parameters are? In a real case, normally 50+ parameters need to change because the third party data are aslo the input of rule engine which I can’t control it only mock it as input implicit parameters. So it is going to be crazy if create and maintain these test cases manually.</p><p>There third part data is like:<br><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/master/img/risk_parameters.jpg" alt="img"></p><p>The best case for 50 parameters test cases design, every parameters has 3 possible values, then at least there are 150 cases(doesn’t consider the combination).</p><p>Manual testing is not a option under this condition if the business need to complete all the testing in one day, also it will burn me out if do these testing more than one time.</p><p>So the only option is to write code to test(I don’t like the term automation testing, I prefer the term write codes for testing).</p><p>Let’s start coding. Coding is not rocket science, don’t be afraid of it especially for testers. In next article, how to implement the test code will be introduced. It is not that hard but improve the productivity significantly. One more point is that it might be more interesting than do it manually in this case.</p>]]></content>
      
      
      
        <tags>
            
            <tag> patterns </tag>
            
            <tag> testing </tag>
            
            <tag> API Testing </tag>
            
            <tag> real </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git Sub Module Usage</title>
      <link href="/2019/04/20/0-GIT-SUBMODULE/"/>
      <url>/2019/04/20/0-GIT-SUBMODULE/</url>
      
        <content type="html"><![CDATA[<h1 id="Git-Sub-Module-Usage"><a href="#Git-Sub-Module-Usage" class="headerlink" title="Git Sub Module Usage"></a>Git Sub Module Usage</h1><p>A Git Repo sometimes has several sub projects which are also a git repo. Let’s walk through following scenarios to became a super<br>git sub module user. The Scenario are:</p><ul><li>Add Git Sub odule into a existing Git Repo</li><li>Git Clone With Sub Modules</li><li>Push To Sub Module’s remote repo</li></ul><h2 id="Add-Git-Sub-Module-into-a-existing-Git-Repo"><a href="#Add-Git-Sub-Module-into-a-existing-Git-Repo" class="headerlink" title="Add Git Sub Module into a existing Git Repo"></a>Add Git Sub Module into a existing Git Repo</h2><p>It is a quit straight forward. You have already clone one git repo to local, then you want to add a sub module to this repo.<br>So just using:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule add https://github.com/allroundtesters/Shell-Steps.git</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>submodule add <git repo url> <local dir>``` is the command </local></git></span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">to use. Just checkout the folder, everything is there. So easy, no magic. But what is different with ```git clone ```, The different is that ```.gitmodules``` file is added to the existing repo, and there sub module info is in it:</span><br><span class="line"></span><br><span class="line">```sh</span><br><span class="line">[submodule &quot;Shell-Steps&quot;]</span><br><span class="line">path = Shell-Steps</span><br><span class="line">url = https://github.com/allroundtesters/Shell-Steps.git</span><br></pre></td></tr></table></figure><p>Obviously, if you add more than one sub module, the sub module info will be appened into the <figure class="highlight plain"><figcaption><span>file to make the parent repo know where the sub modules are.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">That&apos;s it.</span><br><span class="line"></span><br><span class="line">## Git Clone With Sub Modules</span><br><span class="line"></span><br><span class="line">Normally you git clone one project, then find out several folders is empty, then you are confused what happened.  Don&apos;t worry, use the following command to have a try:</span><br><span class="line"></span><br><span class="line">```sh</span><br><span class="line">git pull  --recurse-submodules</span><br><span class="line"># or for git 1.8.2</span><br><span class="line">git submodule update --recursive --remote</span><br></pre></td></tr></table></figure></p><p>Then everything is ready. Go to work right now.</p><h2 id="Push-To-Sub-Module’s-remote-repo"><a href="#Push-To-Sub-Module’s-remote-repo" class="headerlink" title="Push To Sub Module’s remote repo"></a>Push To Sub Module’s remote repo</h2><p>There is no difference. Go to the Sub Module Folder. Then use git push or change the working branch. Everything is same as the single git repo. T here are several advaned command for sub modules, your can read <a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules" target="_blank" rel="noopener">gitbook-submodules</a> for more details.</p>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Use Anaconda3 Python In Ubuntue Usage</title>
      <link href="/2019/04/20/1-Add_Anaconda3_Python/"/>
      <url>/2019/04/20/1-Add_Anaconda3_Python/</url>
      
        <content type="html"><![CDATA[<h1 id="Use-Anaconda3-Python-In-Ubuntu"><a href="#Use-Anaconda3-Python-In-Ubuntu" class="headerlink" title="Use Anaconda3 Python In Ubuntu"></a>Use Anaconda3 Python In Ubuntu</h1><p>First of all, where is your annaconda3 installed, and where is the system python path?</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># anaconda3 path</span></span><br><span class="line">~/anaconda3/bin</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> `whereis python`</span><br></pre></td></tr></table></figure><p>Then Add you anaconda3 to ~/.zshrc or ~/.bashrc PATH</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> ANACONDA_HOME=~/anaconda3</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ANACONDA_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> annaconda3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Build API Testing Framework-1 - Learn Http Api</title>
      <link href="/2019/04/20/api-testing/APITesting-Intro/"/>
      <url>/2019/04/20/api-testing/APITesting-Intro/</url>
      
        <content type="html"><![CDATA[<h1 id="Build-API-Testing-Framework-1-Learn-Http-Api"><a href="#Build-API-Testing-Framework-1-Learn-Http-Api" class="headerlink" title="Build API Testing Framework-1 - Learn Http Api"></a>Build API Testing Framework-1 - Learn Http Api</h1><p>API now, in most cases, it is a HTTP API which over http protocol. It is hard to explain without a example, so let’s start with a HelloWorld API sample.<br>The main purposes of these apis are to do the CRUD(Create/Read/Update/Delete) against the resouce <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Here are HTTP Methods mapping to CRUD:</span><br><span class="line"></span><br><span class="line">|HTTP Method|CRUD|Resource|Response|</span><br><span class="line">|-----------|----|--------|--------|</span><br><span class="line">|GET|Read|/HelloWorld/&#123;id&#125;|200:success/404: not found|</span><br><span class="line">|POST|Create|/HelloWorld|200:success/404: not found|</span><br><span class="line">|Update|Update|/HelloWorld/&#123;id&#125;|200:success/404: not found|</span><br><span class="line">|Delete|Delete|/HelloWorld/&#123;id&#125;|200:success/404: not found|</span><br><span class="line"></span><br><span class="line">It is easy to implement a sets of APIs against resource HelloWorld based on SpringBoot, here comes demo codes:</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">@RestController</span><br><span class="line">public class HelloWorldController &#123;</span><br><span class="line"></span><br><span class="line">    @GetMapping(&quot;/HelloWorld/&#123;id&#125;&quot;)</span><br><span class="line">    public BaseResponse getHelloWorld(@PathVariable Long id) &#123;</span><br><span class="line">        return BaseResponse.OK().data(HelloWorldDTO.builder().id(id).msg(&quot;Hello World&quot;).build());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @PostMapping(&quot;/HelloWorld&quot;)</span><br><span class="line">    public BaseResponse&lt;HelloWorldDTO&gt; createHelloWorld(@RequestBody HelloWorldDTO requestBody) &#123;</span><br><span class="line">        return BaseResponse.OK().data(requestBody);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @PutMapping(&quot;/HelloWorld/&#123;id&#125;&quot;)</span><br><span class="line">    public BaseResponse&lt;HelloWorldDTO&gt; updateHelloWorld(@PathVariable Long id, @RequestBody HelloWorldDTO updateData) &#123;</span><br><span class="line"></span><br><span class="line">        return BaseResponse.OK().data(updateData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @DeleteMapping(&quot;/HelloWorld/&#123;id&#125;&quot;)</span><br><span class="line">    public BaseResponse&lt;HelloWorldDTO&gt; deleteHelloWorld(@PathVariable Long id) &#123;</span><br><span class="line">        return BaseResponse.OK().data(HelloWorldDTO.builder().id(id).msg(&quot;deleted!&quot;).build());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Start the web server, actaully there are 4 apis with different HTTP methods, GET/DELETE/POST/PUT, use postman to check what happened:</p><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/maste/img/postman-get.jpg" alt="img"><br><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/maste/img/postman-post.jpg" alt="img"></p><p>It represents how the api work, and how to use postman to invoke the http api to get a result.</p><p>So the api testing is simple, a client send a http request, then get the http response to check if the response is correct. </p><p><img src="https://raw.githubusercontent.com/evenhumble/hustle-player/maste/img/api_response.png" alt="img"></p><p>In this case, if you want to start a api automation testing, what kind of codes need to write? In this case, it is very simple:</p><ol><li>A clint to invoke http api: Client</li><li>Data builder to build input data: InputData</li><li>Verify the response: OutputData</li></ol><p>the code example generated bu postman(java and OkHttpClient) is :</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">OkHttpClient client = new OkHttpClient();</span><br><span class="line"></span><br><span class="line">MediaType mediaType = MediaType.parse(<span class="string">"application/json"</span>);</span><br><span class="line">RequestBody body = RequestBody.create(mediaType, <span class="string">"&#123;\"msg\":123&#125;"</span>);</span><br><span class="line">Request request = new Request.Builder()</span><br><span class="line">  .url(<span class="string">"http://localhost:9090/HelloWorld"</span>)</span><br><span class="line">  .post(body)</span><br><span class="line">  .addHeader(<span class="string">"Content-Type"</span>, <span class="string">"application/json"</span>)</span><br><span class="line">  .addHeader(<span class="string">"cache-control"</span>, <span class="string">"no-cache"</span>)</span><br><span class="line">  .addHeader(<span class="string">"Postman-Token"</span>, <span class="string">"ac6e83d3-8446-4ae7-81ea-59316ca5cce7"</span>)</span><br><span class="line">  .build();</span><br><span class="line"></span><br><span class="line">Response response = client.newCall(request).execute();</span><br></pre></td></tr></table></figure><p>Copy these codes, and run in maven project, your first API automation code is completed.</p><p>By the way, there are several questions for HTTP API:</p><ul><li>What is Idempotent Methods? GET/HEAD/PUT/DELETE are declared idemponten</li><li>What Option method used for? </li><li>Is http api stateless? What does the stateless mean? All the information is in the request.</li></ul><p>In Next Chapter, let’s write code and go through these cases.</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> patterns </tag>
            
            <tag> testing </tag>
            
            <tag> API Testing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVA SimpleDateFormat Not ThreadSafe Python In Ubuntue Usage</title>
      <link href="/2019/02/20/2-SimpleDateFormat-Parse-Is-Not-ThreadSafe/"/>
      <url>/2019/02/20/2-SimpleDateFormat-Parse-Is-Not-ThreadSafe/</url>
      
        <content type="html"><![CDATA[<h1 id="JAVA-SimpleDateFormat-Not-ThreadSafe"><a href="#JAVA-SimpleDateFormat-Not-ThreadSafe" class="headerlink" title="JAVA SimpleDateFormat Not ThreadSafe"></a>JAVA SimpleDateFormat Not ThreadSafe</h1><p>SimpleDateFormat is not threadsafe, so when we use it in the a multiple threads environment, be careful.</p><p>Follow is a JAVA class to demo the error:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public class SimpleDateFormatThreadUnsafetyExample &#123;</span><br><span class="line"></span><br><span class="line">    private static SimpleDateFormat simpleDateFormat = new SimpleDateFormat(<span class="string">"yyyy-MM-dd'T'HH:mm:ss"</span>);  <span class="comment">## the evil here,it is not thread safe</span></span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        String dateStr = <span class="string">"2018-06-22T10:00:00"</span>;</span><br><span class="line"></span><br><span class="line">        ExecutorService executorService = Executors.newFixedThreadPool(10);</span><br><span class="line">        Runnable task = () -&gt; parseDate(dateStr);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (int i = 0; i &lt; 100; i++) &#123;</span><br><span class="line">            executorService.submit(task);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        executorService.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void parseDate(String dateStr) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Date date = simpleDateFormat.parse(dateStr);</span><br><span class="line">            System.out.println(<span class="string">"Successfully Parsed Date "</span> + date);</span><br><span class="line">        &#125; catch (ParseException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">"ParseError "</span> + e.getMessage());</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Run it, let’s see what happeded?Following errors: </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">java.lang.NumberFormatException: For input string: <span class="string">"20182018E"</span></span><br><span class="line">at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)</span><br><span class="line">at java.lang.Long.parseLong(Long.java:589)</span><br><span class="line">at java.lang.Long.parseLong(Long.java:631)</span><br><span class="line">at java.text.DigitList.getLong(DigitList.java:195)</span><br><span class="line">at java.text.DecimalFormat.parse(DecimalFormat.java:2084)</span><br><span class="line">at java.text.SimpleDateFormat.subParse(SimpleDateFormat.java:1869)</span><br><span class="line">at java.text.SimpleDateFormat.parse(SimpleDateFormat.java:1514)</span><br><span class="line">at java.text.DateFormat.parse(DateFormat.java:364)</span><br><span class="line">at io.qkits.dailyissues.concurrence.SimpleDateFormatThreadUnsafetyExample.parseDate(SimpleDateFormatThreadUnsafetyExample.java:28)</span><br><span class="line">at io.qkits.dailyissues.concurrence.SimpleDateFormatThreadUnsafetyExample.lambda<span class="variable">$main</span><span class="variable">$0</span>(SimpleDateFormatThreadUnsafetyExample.java:17)</span><br><span class="line">at java.util.concurrent.Executors<span class="variable">$RunnableAdapter</span>.call(Executors.java:511)</span><br><span class="line">at java.util.concurrent.FutureTask.run(FutureTask.java:266)</span><br><span class="line">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)</span><br><span class="line">at java.util.concurrent.ThreadPoolExecutor<span class="variable">$Worker</span>.run(ThreadPoolExecutor.java:624)</span><br><span class="line">at java.lang.Thread.run(Thread.java:748)</span><br><span class="line">java.lang.NumberFormatException: multiple points</span><br><span class="line">at sun.misc.FloatingDecimal.readJavaFormatString(FloatingDecimal.java:1890)</span><br><span class="line">at sun.misc.FloatingDecimal.parseDouble(FloatingDecimal.java:110)</span><br><span class="line">at java.lang.Double.parseDouble(Double.java:538)</span><br><span class="line">at java.text.DigitList.getDouble(DigitList.java:169)</span><br><span class="line">at java.text.DecimalFormat.parse(DecimalFormat.java:2089)</span><br><span class="line">at java.text.SimpleDateFormat.subParse(SimpleDateFormat.java:2162)</span><br><span class="line">at java.text.SimpleDateFormat.parse(SimpleDateFormat.java:1514)</span><br><span class="line">at java.text.DateFormat.parse(DateFormat.java:364)</span><br><span class="line">at io.qkits.dailyissues.concurrence.SimpleDateFormatThreadUnsafetyExample.parseDate(SimpleDateFormatThreadUnsafetyExample.java:28)</span><br><span class="line">at io.qkits.dailyissues.concurrence.SimpleDateFormatThreadUnsafetyExample.lambda<span class="variable">$main</span><span class="variable">$0</span>(SimpleDateFormatThreadUnsafetyExample.java:17)</span><br><span class="line">at java.util.concurrent.Executors<span class="variable">$RunnableAdapter</span>.call(Executors.java:511)</span><br><span class="line">at java.util.concurrent.FutureTask.run(FutureTask.java:266)</span><br><span class="line">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)</span><br><span class="line">at java.util.concurrent.ThreadPoolExecutor<span class="variable">$Worker</span>.run(ThreadPoolExecutor.java:624)</span><br><span class="line">at java.lang.Thread.run(Thread.java:748)</span><br></pre></td></tr></table></figure><p>So move the SimpleDateFormat from static field to method level, it can solve this issue,or make the pareDate function sync.</p><h2 id="All-the-SimpleDateFormat-method-is-not-not-thread-safe"><a href="#All-the-SimpleDateFormat-method-is-not-not-thread-safe" class="headerlink" title="All the SimpleDateFormat method is not not thread safe?"></a>All the SimpleDateFormat method is not not thread safe?</h2><p>if I change the pareDate method as follow:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">parseDate</span><span class="params">(String dateStr)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          Date date = simpleDateFormat.parse(dateStr);</span><br><span class="line">          System.out.println(<span class="string">"Successfully Parsed Date "</span> + date);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">          System.out.println(<span class="string">"ParseError "</span> + e.getMessage());</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(formatDate(<span class="keyword">new</span> Date()));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">formatDate</span><span class="params">(Date date)</span></span>&#123;</span><br><span class="line">      <span class="keyword">return</span> simpleDateFormat.format(date);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>re-run it and even add more threads to run it, there is no error?<br>Why and what happened? Need to dig it more deeper.</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> concurrent </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Defensive Programming</title>
      <link href="/2019/02/20/real/3-Defensive-programing/"/>
      <url>/2019/02/20/real/3-Defensive-programing/</url>
      
        <content type="html"><![CDATA[<h1 id="Defensive-Programming-reuse-the-validation"><a href="#Defensive-Programming-reuse-the-validation" class="headerlink" title="Defensive Programming - reuse the validation"></a>Defensive Programming - reuse the validation</h1><p>What does Defensive Programming mean? Let’s look at some sampels:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Report</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">export</span><span class="params">(File file)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (file == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">                    <span class="string">"File is NULL; can't export."</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (file.exists()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">                    <span class="string">"File already exists."</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Export the report to the file</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>In this case, there are several validation for the input paramter to make sure the input is in a right manner. It is the sense of defensive programing. Be sure, don’t grant the input parameter. </p><p>But actually it is quite boilet code for input parameter validation. </p><p>For example, if we define a Report Interface:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Report</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">export</span><span class="params">(File file)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>And we have several different Reports to implement this interface, do we need to do the validate in every implementation? The answer is it depends, we can implement a DefaultReport, to decorate different report as example.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DefaultReport</span> <span class="keyword">implements</span> <span class="title">Report</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">export</span><span class="params">(File file)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (file == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">                    <span class="string">"File is NULL; can't export."</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (file.exists()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">                    <span class="string">"File already exists."</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Export the report to the file</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NoWriteOverReport</span> <span class="keyword">implements</span> <span class="title">Report</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Report origin;</span><br><span class="line"></span><br><span class="line">    NoWriteOverReport(Report rep) &#123;</span><br><span class="line">        <span class="keyword">this</span>.origin = rep;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">export</span><span class="params">(File file)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (file.exists()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">                    <span class="string">"File already exists."</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.origin.export(file);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Report report = <span class="keyword">new</span> NoWriteOverReport(</span><br><span class="line">                <span class="keyword">new</span> DefaultReport()</span><br><span class="line">        );</span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"."</span>);</span><br><span class="line">        report.export(file);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>So we can reuse the default report valitor now. </p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> patterns </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Algorithm Big-O notion</title>
      <link href="/2019/02/20/real/ALGO-0-bigo/"/>
      <url>/2019/02/20/real/ALGO-0-bigo/</url>
      
        <content type="html"><![CDATA[<h1 id="Algorithm-Big-O-notion"><a href="#Algorithm-Big-O-notion" class="headerlink" title="Algorithm Big-O notion"></a>Algorithm Big-O notion</h1><p><a href="http://www.bigocheatsheet.com/" target="_blank" rel="noopener">reference</a></p><p><img src="../imgs/bigo-operation.jpg" alt="img"></p><p><img src="../imgs/common-ds.jpg" alt="img"></p><p><img src="../imgs/array-sorting.jpg" alt="img"></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> patterns </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YUML Basic Usage</title>
      <link href="/2018/12/24/yuml-usage/"/>
      <url>/2018/12/24/yuml-usage/</url>
      
        <content type="html"><![CDATA[<h1 id="YUML-Syntax"><a href="#YUML-Syntax" class="headerlink" title="YUML Syntax"></a>YUML Syntax</h1><ul><li>comments and directives</li><li>class diagram</li></ul><h2 id="Comments-and-Directives"><a href="#Comments-and-Directives" class="headerlink" title="Comments and Directives"></a>Comments and Directives</h2><ul><li>type: //{type:class}</li><li>direction: // {direction:leftToRight}</li><li>generate: // {generate:true}</li></ul><h2 id="Class-diagram"><a href="#Class-diagram" class="headerlink" title="Class diagram"></a>Class diagram</h2><p>cheetsheet for class diagram</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Class         [Customer]</span><br><span class="line">Directional   [Customer]-&gt;[Order]</span><br><span class="line">Bidirectional [Customer]&lt;-&gt;[Order]</span><br><span class="line">Aggregation   [Customer]+-[Order] or [Customer]&lt;&gt;-[Order]</span><br><span class="line">Composition   [Customer]++-[Order]</span><br><span class="line">Inheritance   [Customer]^[Cool Customer], [Customer]^[Uncool Customer]</span><br><span class="line">Dependencies  [Customer]uses-.-&gt;[PaymentStrategy]</span><br><span class="line">Cardinality   [Customer]&lt;1-1..2&gt;[Address]</span><br><span class="line">Labels        [Person]customer-billingAddress[Address]</span><br><span class="line">Notes         [Address]-[note: Value Object]</span><br><span class="line">Full Class    [Customer|Forename;Surname;Email|Save()]</span><br><span class="line">Color splash  [Customer&#123;<span class="built_in">bg</span>:orange&#125;]&lt;&gt;1-&gt;*[Order&#123;<span class="built_in">bg</span>:green&#125;]</span><br></pre></td></tr></table></figure><h2 id="Association-classes"><a href="#Association-classes" class="headerlink" title="Association classes"></a>Association classes</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Invoice]&lt;*-*&gt;[Products][Invoice Item]</span><br></pre></td></tr></table></figure><h2 id="Use-cases-diagram"><a href="#Use-cases-diagram" class="headerlink" title="Use-cases diagram"></a>Use-cases diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Use Case           (Login)</span><br><span class="line">Actor              [Customer]</span><br><span class="line">&lt;&lt;Extend&gt;&gt;         (Login)&lt;(Forgot Password)</span><br><span class="line">&lt;&lt;Include&gt;&gt;        (Register)&gt;(Confirm Email)</span><br><span class="line">Actor Inheritance  [Admin]^[User]</span><br><span class="line">Note           [Admin]-(note: Most privilidged user)</span><br></pre></td></tr></table></figure><h2 id="Activity-diagram"><a href="#Activity-diagram" class="headerlink" title="Activity diagram"></a>Activity diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Start           (start)</span><br><span class="line">End                (end)</span><br><span class="line">Activity           (Find Products)</span><br><span class="line">Flow           (start)-&gt;(Find Products)</span><br><span class="line">Multiple Assoc.    (start)-&gt;(Find Products)-&gt;(end)</span><br><span class="line">Decisions          (start)-&gt;&lt;d1&gt;</span><br><span class="line">Decisions w/Label  (start)-&gt;&lt;d1&gt;logged <span class="keyword">in</span>-&gt;(Show Dashboard)   and   &lt;d1&gt;not logged <span class="keyword">in</span>-&gt;(Show Login Page)</span><br><span class="line">Parallel           (Action 1)-&gt;|a|   and   (Action 2)-&gt;|a|</span><br></pre></td></tr></table></figure><h2 id="State-diagram"><a href="#State-diagram" class="headerlink" title="State diagram"></a>State diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Start         (start)</span><br><span class="line">End              (end)</span><br><span class="line">Activity         (Find Products)</span><br><span class="line">Flow         (start)-&gt;(Find Products)</span><br><span class="line">Multiple Assoc.  (start)-&gt;(Find Products)-&gt;(end)</span><br><span class="line">Complex <span class="keyword">case</span>     (Simulator running)[Pause]-&gt;(Simulator paused|<span class="keyword">do</span>/<span class="built_in">wait</span>)[Unpause]-&gt;(Simulator running)</span><br><span class="line">Note             (state)-(note: a note here)</span><br></pre></td></tr></table></figure><h2 id="Deployment-diagram"><a href="#Deployment-diagram" class="headerlink" title="Deployment diagram"></a>Deployment diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Node           [node1]</span><br><span class="line">Association    [node1]-[node2]</span><br><span class="line">Labeled Assoc. [node1]label-[node2]</span><br><span class="line">Note           [node1]-[note: a note here]</span><br></pre></td></tr></table></figure><h2 id="Sequence-diagram"><a href="#Sequence-diagram" class="headerlink" title="Sequence diagram"></a>Sequence diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Object       [Patron]</span><br><span class="line">Message      [Patron]order food&gt;[Waiter]</span><br><span class="line">Response     [Waiter]serve wine.&gt;[Patron]</span><br><span class="line">Note         [Actor]-[note: a note message]</span><br><span class="line">Asynchronous [Patron]order food&gt;&gt;[Waiter]</span><br></pre></td></tr></table></figure><h2 id="Package-diagram"><a href="#Package-diagram" class="headerlink" title="Package diagram"></a>Package diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Package        [package1]</span><br><span class="line">Association    [package1]-&gt;[package2]</span><br><span class="line">Labeled assoc  [package1]label-&gt;[package2]</span><br><span class="line">Note           [package1]-[note: a note here]</span><br><span class="line"></span><br><span class="line">`</span><br></pre></td></tr></table></figure><h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><ul><li>Color codes: form #RRGGBB, X11 color coding</li><li>checkout <a href="http://yuml.me" target="_blank" rel="noopener">yuml.me</a></li></ul><h2 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h2><p><a href="https://github.com/jaime-olivares/yuml-diagram" target="_blank" rel="noopener">yuml-diagram</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install yuml-diagram</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> tips </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>内网穿透方案 - frp</title>
      <link href="/2018/11/21/frp-usage/"/>
      <url>/2018/11/21/frp-usage/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/fatedier/frp" target="_blank" rel="noopener">frp</a> 使用golang编写的，下面几个例子来说明一下如何使用frp.</p><ul><li><a href="https://github.com/fatedier" target="_blank" rel="noopener">todo</a></li><li><a href="https://haofly.net" target="_blank" rel="noopener">reference</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> tips </tag>
            
            <tag> ops </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>似是而非</title>
      <link href="/2018/11/20/think-twice/"/>
      <url>/2018/11/20/think-twice/</url>
      
        <content type="html"><![CDATA[<p>很很多似是而非的问题，信息现在是爆炸，而不是太少。所以多思考，而不是不停的道听途说对自身更有意义。有些听上去很多的东西可能也是需要自己多想，多想其实简单来说就是要多方面考虑，要站在其他的角度考虑问题。</p><p>比如我们常说我们要问为什么，但是为什么不个人的答案可能都是不一样呀，为什么可能是为什么这么做，为什么要做，但是最基本最基本的问题应该是目的是什么，很多为什么马上牵扯到很多很专业的事前，但是目的应该是所有人都懂得，而专业内容实际上不是每个人都能懂得，如果你想知道目的是什么，但是别人告诉了你很多你听不懂的东西，那么这里面一定有GAP，一定哪里有问题没有被解决。同样如果已经进入到专业领域你听不懂，那么自己就需要补课了。</p><p>另外一点问为什么的时候，也要对自己进行反思，自己真的有能力去问这个为什么吗？有能力理解这里面的目的吗，如果不能，那么回去看书或者请教其他人了。</p><h2 id="很多很丰富的鸡汤"><a href="#很多很丰富的鸡汤" class="headerlink" title="很多很丰富的鸡汤"></a>很多很丰富的鸡汤</h2><p>鸡汤为什么好听，因为能给你共鸣，同时比较能调动你的情绪，很容易有代入感，但是需要警惕的事，鸡汤不能帮你完成任何一件事情，它只是更容易让你上瘾，让你觉得在讨论宏大的问题，然而其实没几个人有能力讨论宏大问题。</p><p>鸡汤本身没有问题，但是如果觉得多喝了一点就有自己进步了，那么这个就是犯的大错；真正有价值的东西大体可以通过钱或者其他东西来衡量的，也就是交换价值；鸡汤有吗？鸡汤帮不了你.如果鸡汤是道，把事情做出来可以是术，但是大部分人应该是通过术来理解，推导出道来；如果只是被动接受那些道，那么你接受的本省就不是道，</p>]]></content>
      
      
      
        <tags>
            
            <tag> thoughts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>学习ansible module-1</title>
      <link href="/2018/09/13/ansible-module-1/"/>
      <url>/2018/09/13/ansible-module-1/</url>
      
        <content type="html"><![CDATA[<p>写一个Ansbile Module实际上非常容易，我从看</p><figure class="highlight plain"><figcaption><span>这个源码的方式大概可以了解Ansible的一个简单的</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">插件.</span><br><span class="line"></span><br><span class="line">下面分几个内容来看：</span><br><span class="line"></span><br><span class="line">- 插件运行代码</span><br><span class="line">- 插件的meta的数据</span><br><span class="line"></span><br><span class="line">## Ansible 插件代码</span><br><span class="line"></span><br><span class="line">- 首先Ansible 插件的入口函数为main函数</span><br><span class="line"></span><br><span class="line">所以先定义一个main函数，以及main函数的运行</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">def main():</span><br><span class="line">  pass</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><ul><li>实现main函数</li></ul><p>主要步骤是：</p><ul><li>module定义，Ansible的module，定义这个AnsibleModule的argument_spec,这个里面用来声明这个插件使用的参数</li><li>module.params，ansible的输入为task的yml文件，这里面定义的内容都会传递到这个params中</li><li>然后根据不同的state的值去调用不同的任务，所有不同的任务的参数都是module，module用来传递了运行时的上下文</li><li>实现不同state对应的任务</li><li>基本上就结束了一个Ansible插件了</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">module = AnsibleModule(</span><br><span class="line">    argument_spec=dict(</span><br><span class="line">        role=dict(choices=[<span class="string">'standalone'</span>, <span class="string">'hub'</span>, <span class="string">'node'</span>], default=<span class="string">'standalone'</span>),</span><br><span class="line">        state=dict(choices=[<span class="string">'running'</span>, <span class="string">'stopped'</span>, <span class="string">'restarted'</span>], default=<span class="string">'running'</span>),</span><br><span class="line">        version=dict(default=<span class="string">'2.53.0'</span>),</span><br><span class="line">        path=dict(default=<span class="string">'.'</span>),</span><br><span class="line">        force=dict(default=<span class="literal">False</span>, type=<span class="string">'bool'</span>),</span><br><span class="line">        args=dict(required=<span class="literal">False</span>, default=<span class="string">''</span>),</span><br><span class="line">        java=dict(required=<span class="literal">False</span>, default=<span class="string">'/usr/bin/java'</span>),</span><br><span class="line">        logfile=dict(required=<span class="literal">False</span>, default=<span class="string">'./selenium.log'</span>),</span><br><span class="line">        javaargs=dict(required=<span class="literal">False</span>, default=[], type=<span class="string">'list'</span>),</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    supports_check_mode=<span class="literal">False</span>,</span><br><span class="line"></span><br><span class="line">    mutually_exclusive=[]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">state = module.params[<span class="string">'state'</span>]</span><br><span class="line">role = module.params[<span class="string">'role'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> state == <span class="string">'running'</span>:</span><br><span class="line">    (changed, pid) = start(module)</span><br><span class="line">    finish(module, msg=<span class="string">'%s is running'</span> % role, changed=changed, pid=pid)</span><br><span class="line"><span class="keyword">elif</span> state == <span class="string">'stopped'</span>:</span><br><span class="line">    changed = stop(module)</span><br><span class="line">    finish(module, msg=<span class="string">'%s is stopped'</span> % role, changed=changed)</span><br><span class="line"><span class="keyword">elif</span> state == <span class="string">'restarted'</span>:</span><br><span class="line">    (changed, pid) = restart(module)</span><br><span class="line">    finish(module, msg=<span class="string">'%s has restarted'</span> % role, changed=changed, pid=pid)</span><br></pre></td></tr></table></figure><p>start 任务的一个例子：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">(module)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Start the Selenium standalone</span></span><br><span class="line"><span class="string">    :param module:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    _, jar_file = download(module)</span><br><span class="line"></span><br><span class="line">    changed = <span class="literal">False</span></span><br><span class="line">    role = module.params[<span class="string">'role'</span>]</span><br><span class="line">    <span class="keyword">if</span> role != <span class="string">'standalone'</span>:</span><br><span class="line">      role = <span class="string">"-role %s"</span> % role</span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">      role = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_running(module): <span class="comment"># in another implementation</span></span><br><span class="line">        changed = <span class="literal">True</span></span><br><span class="line">        args = <span class="string">''</span></span><br><span class="line">        java_args = <span class="string">''</span></span><br><span class="line">        <span class="keyword">if</span> module.params[<span class="string">'args'</span>]:</span><br><span class="line">            <span class="keyword">for</span> (k, v) <span class="keyword">in</span> module.params[<span class="string">'args'</span>].iteritems():</span><br><span class="line">                args += <span class="string">'-%s=%s '</span> % (k, v)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> module.params[<span class="string">'javaargs'</span>]:</span><br><span class="line">            <span class="keyword">for</span> arg <span class="keyword">in</span> module.params[<span class="string">'javaargs'</span>]:</span><br><span class="line">                java_args += <span class="string">'-%s '</span> % arg</span><br><span class="line"></span><br><span class="line">        java_executable = os.path.abspath(os.path.expandvars(module.params[<span class="string">'java'</span>]))</span><br><span class="line">        log_file = os.path.abspath(os.path.expandvars(module.params[<span class="string">'logfile'</span>]))</span><br><span class="line"></span><br><span class="line">        cmd = <span class="string">"%s %s -jar %s %s %s &gt;&gt; %s 2&gt;&amp;1 &amp;"</span> % (java_executable,</span><br><span class="line">                                                          java_args,</span><br><span class="line">                                                          jar_file,</span><br><span class="line">                                                          role,</span><br><span class="line">                                                          args,</span><br><span class="line">                                                          log_file)</span><br><span class="line"></span><br><span class="line">        os.setsid()</span><br><span class="line"></span><br><span class="line">        <span class="comment">#print cmd</span></span><br><span class="line">        rc = os.system(cmd)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> rc != <span class="number">0</span>:</span><br><span class="line">            abort(module, <span class="string">'Running the %s role returned code %s !'</span> % (role, rc))</span><br><span class="line"></span><br><span class="line">    pid = get_pid(module)</span><br><span class="line">    <span class="keyword">if</span> pid:</span><br><span class="line">        <span class="keyword">return</span> changed, pid</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        abort(module, <span class="string">'Couldnt fetch the pid of the running %s ! It may have ended abruptly.'</span> % module.params[<span class="string">'role'</span>])</span><br></pre></td></tr></table></figure><h2 id="Meta-插件的meta的数据"><a href="#Meta-插件的meta的数据" class="headerlink" title="Meta 插件的meta的数据"></a>Meta 插件的meta的数据</h2><p>meta信息一般存放在meta目录中，具体写的方式参考源码:<br><code>https://github.com/SeleniumHQ/ansible-selenium.git</code></p><h2 id="Ansible-MindMap"><a href="#Ansible-MindMap" class="headerlink" title="Ansible MindMap"></a>Ansible MindMap</h2><p><img src="images/Ansible.png" alt="img"></p>]]></content>
      
      
      
        <tags>
            
            <tag> ansible </tag>
            
            <tag> CICD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>conda-cheatsheet</title>
      <link href="/2018/09/12/conda-cheetsheet/"/>
      <url>/2018/09/12/conda-cheetsheet/</url>
      
        <content type="html"><![CDATA[<p>CONDA Cheat Sheet</p><h2 id="Conda-Basics"><a href="#Conda-Basics" class="headerlink" title="Conda Basics"></a>Conda Basics</h2><table><thead><tr><th>Command</th><th>Usage</th></tr></thead><tbody><tr><td>conda info</td><td>version</td></tr><tr><td>conda update conda</td><td>update conda</td></tr><tr><td>conda install <package_name></package_name></td><td>install package</td></tr><tr><td>spyder</td><td>run a package after installed</td></tr><tr><td>conda update <package_name></package_name></td><td>update package</td></tr></tbody></table><h2 id="Using-Environment"><a href="#Using-Environment" class="headerlink" title="Using Environment"></a>Using Environment</h2><table><thead><tr><th>Command</th><th>Usage</th></tr></thead><tbody><tr><td>conda create –name py36 python=3.6</td><td>create a new python3.6 environment</td></tr><tr><td>source activate py36</td><td>activate env</td></tr><tr><td>conda env list</td><td>list all environment</td></tr><tr><td>conda create –clone <source> –name <target></target></td><td>clone project</td></tr><tr><td>conda list –explicit &gt; py36.txt</td><td>save environment to a text file</td></tr><tr><td>conda env create –file py36.txt</td><td>creat environment from a text file</td></tr><tr><td>pip install boltons</td><td>pip install to the activate environment</td></tr><tr><td>conda search PACKAGENAME</td><td>search packages</td></tr><tr><td>conda env remove –name env_name</td><td>remove environment</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> cheatsheet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jmespath 使用，jsonpath外的另外一种选择</title>
      <link href="/2018/08/13/jmespath/"/>
      <url>/2018/08/13/jmespath/</url>
      
        <content type="html"><![CDATA[<p>在测试过程中，经常会去JSON中的某个值，<a href="http://jmespath.org/tutorial.html" target="_blank" rel="noopener">jmespath</a>可以是除了jsonpath的另外一种选择.<br>下面通过几个例子来说明jmespath在python的使用</p><h2 id="jmespath-python安装"><a href="#jmespath-python安装" class="headerlink" title="jmespath python安装"></a>jmespath python安装</h2><p>非常简单直接pip,</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install jmespth</span><br></pre></td></tr></table></figure><h2 id="查询一个key值"><a href="#查询一个key值" class="headerlink" title="查询一个key值"></a>查询一个key值</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source=&#123;<span class="string">"a"</span>: <span class="string">"foo"</span>, <span class="string">"b"</span>: <span class="string">"bar"</span>, <span class="string">"c"</span>: <span class="string">"baz"</span>&#125;</span><br><span class="line">result = jmespath.search(<span class="string">"a"</span>,source)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure><h2 id="subexpression"><a href="#subexpression" class="headerlink" title="subexpression"></a>subexpression</h2><p>类似于jsonpath，通过<strong><em>.</em></strong>来表示路径的层级</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source_1=&#123;<span class="string">"a"</span>: &#123;<span class="string">"b"</span>: &#123;<span class="string">"c"</span>: &#123;<span class="string">"d"</span>: <span class="string">"value"</span>&#125;&#125;&#125;&#125;</span><br><span class="line">sub_result = jmespath.search(<span class="string">"a.b.c"</span>,source_1)</span><br><span class="line">print(sub_result)</span><br></pre></td></tr></table></figure><p>这个例子的结果为：{‘d’: ‘value’}</p><h2 id="index-expressions"><a href="#index-expressions" class="headerlink" title="index expressions"></a>index expressions</h2><p>index expression主要使用在数组上</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source_2 = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>]</span><br><span class="line">index_result = jmespath.search(<span class="string">"[1]"</span>,source_2)</span><br><span class="line">print(index_result)</span><br></pre></td></tr></table></figure><p>这个例子的结果为:b</p><h2 id="多个表达式综合使用"><a href="#多个表达式综合使用" class="headerlink" title="多个表达式综合使用"></a>多个表达式综合使用</h2><p>以上几种表达式可以合起来一期使用：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">composite_exp = <span class="string">"a.b.c[0].d[1][0]"</span></span><br><span class="line">source_3= &#123;<span class="string">"a"</span>: &#123;</span><br><span class="line">  <span class="string">"b"</span>: &#123;</span><br><span class="line">    <span class="string">"c"</span>: [</span><br><span class="line">      &#123;<span class="string">"d"</span>: [<span class="number">0</span>, [<span class="number">1</span>, <span class="number">2</span>]]&#125;,</span><br><span class="line">      &#123;<span class="string">"d"</span>: [<span class="number">3</span>, <span class="number">4</span>]&#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;&#125;</span><br><span class="line"></span><br><span class="line">composite_result = jmespath.search(composite_exp,source_3)</span><br><span class="line">print(composite_result)</span><br></pre></td></tr></table></figure><p>这个例子的结果为1</p><h2 id="Slicing-切片"><a href="#Slicing-切片" class="headerlink" title="Slicing 切片"></a>Slicing 切片</h2><p>slicing 和python本身的slicing比较像，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">source_4=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">slicing_exp = <span class="string">"[0:5]"</span></span><br><span class="line">slicing_result = jmespath.search(slicing_exp,source_4)</span><br><span class="line">print(slicing_result)</span><br></pre></td></tr></table></figure><p>这个例子的结果为： [0, 1, 2, 3, 4]</p><p>slicing实际上和python自己的机制基本一样，同样这个也是主要给数组使用.<br>有一点需要记住，基本的slicing的格式其实是： [start:stop:step]</p><h2 id="Projections"><a href="#Projections" class="headerlink" title="Projections"></a>Projections</h2><p>projection不知道怎么翻译，就先叫做投影吧，具体通过例子来说比较好理解.<br>projections主要包含一下几种情况:</p><ul><li>List Projections</li><li>Slice Projections</li><li>Object Projections</li><li>Flatten Projections</li><li>Filter Projections</li></ul><h3 id="Projections-例子"><a href="#Projections-例子" class="headerlink" title="Projections- 例子"></a>Projections- 例子</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">list_exp=<span class="string">"people[*].first"</span></span><br><span class="line">source_5 = &#123;</span><br><span class="line">  <span class="string">"people"</span>: [</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"James"</span>, <span class="string">"last"</span>: <span class="string">"d"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"Jacob"</span>, <span class="string">"last"</span>: <span class="string">"e"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"Jayden"</span>, <span class="string">"last"</span>: <span class="string">"f"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"missing"</span>: <span class="string">"different"</span>&#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"foo"</span>: &#123;<span class="string">"bar"</span>: <span class="string">"baz"</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">proj_result1= jmespath.search(list_exp,source_5)</span><br><span class="line">print(proj_result1) <span class="comment"># ['James', 'Jacob', 'Jayden']</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj_exp =<span class="string">"reservations[*].instances[*].state"</span></span><br><span class="line">source_6= &#123;</span><br><span class="line">  <span class="string">"reservations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"instances"</span>: [</span><br><span class="line">        &#123;<span class="string">"state"</span>: <span class="string">"running"</span>&#125;,</span><br><span class="line">        &#123;<span class="string">"state"</span>: <span class="string">"stopped"</span>&#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"instances"</span>: [</span><br><span class="line">        &#123;<span class="string">"state"</span>: <span class="string">"terminated"</span>&#125;,</span><br><span class="line">        &#123;<span class="string">"state"</span>: <span class="string">"runnning"</span>&#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">proj_result2=jmespath.search(obj_exp,source_6)</span><br><span class="line">print(proj_result2) <span class="comment">#[['running', 'stopped'], ['terminated', 'runnning']]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Flatten projections</span></span><br><span class="line"></span><br><span class="line">source_7=[</span><br><span class="line">  [<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">  <span class="number">2</span>,</span><br><span class="line">  [<span class="number">3</span>],</span><br><span class="line">  <span class="number">4</span>,</span><br><span class="line">  [<span class="number">5</span>, [<span class="number">6</span>, <span class="number">7</span>]]</span><br><span class="line">]</span><br><span class="line">flat_exp =<span class="string">"[]"</span></span><br><span class="line">flat_result = jmespath.search(flat_exp,source_7)</span><br><span class="line">print(flat_result) <span class="comment"># [0, 1, 2, 3, 4, 5, [6, 7]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># filter</span></span><br><span class="line"></span><br><span class="line">filter_exp=<span class="string">"machines[?state=='running'].name"</span></span><br><span class="line">filter_source =&#123;</span><br><span class="line">  <span class="string">"machines"</span>: [</span><br><span class="line">    &#123;<span class="string">"name"</span>: <span class="string">"a"</span>, <span class="string">"state"</span>: <span class="string">"running"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"name"</span>: <span class="string">"b"</span>, <span class="string">"state"</span>: <span class="string">"stopped"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"name"</span>: <span class="string">"b"</span>, <span class="string">"state"</span>: <span class="string">"running"</span>&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">filter_result = jmespath.search(filter_exp,filter_source)</span><br><span class="line">print(filter_result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pipe expression</span></span><br><span class="line"></span><br><span class="line">pipe_exp= <span class="string">"people[*].first | [0]"</span></span><br><span class="line">pipe_source= &#123;</span><br><span class="line">  <span class="string">"people"</span>: [</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"James"</span>, <span class="string">"last"</span>: <span class="string">"d"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"Jacob"</span>, <span class="string">"last"</span>: <span class="string">"e"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"Jayden"</span>, <span class="string">"last"</span>: <span class="string">"f"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"missing"</span>: <span class="string">"different"</span>&#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"foo"</span>: &#123;<span class="string">"bar"</span>: <span class="string">"baz"</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pipe_result = jmespath.search(pipe_exp,pipe_source)</span><br><span class="line">print(pipe_result)  <span class="comment"># James</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># multiselect</span></span><br><span class="line">multi_exp=<span class="string">"people[].[first,last]"</span></span><br><span class="line">multiselect_result = jmespath.search(multi_exp,pipe_source)</span><br><span class="line">print(multiselect_result) <span class="comment"># [['James', 'd'], ['Jacob', 'e'], ['Jayden', 'f'], [None, None]]</span></span><br></pre></td></tr></table></figure><p>基本上把网站上例子试了一下，总体感觉功能是相当强大(怀疑比jsonpath还要厉害一点).<br>从简单到复杂，都还是比较好用.</p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> tips </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Agile Metrics： 敏捷指标</title>
      <link href="/2018/08/10/3-Agile-Metrics/"/>
      <url>/2018/08/10/3-Agile-Metrics/</url>
      
        <content type="html"><![CDATA[<p>有句话说的好，不能衡量就不能说明任何问题，那么一个敏捷项目，需要用什么样的指标来衡量呢？ 不管怎么样有些规则对于指标来说是必须的:</p><ul><li>必须追踪有用的信息</li><li>指标的上下文也很重要</li></ul><p>我能想到的指标包括:</p><ul><li>Story Point - Output </li><li>Every Issue start-to-close time: Time</li><li>Bug Ratio: Output/Debt</li><li>Business Data for the new feature or fix bug: Output</li><li>Techinical debt: own ? How Much? Story Point</li><li>Figure out Spring Checklist</li><li>What Value did the team deliver last sprint?</li><li>How has the level of technical debt?</li><li>Are you happy working with your teammate?</li><li>Lead Time and Cycle Time</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> agile metrics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>junit-perf</title>
      <link href="/2018/07/24/1-junit-perf/"/>
      <url>/2018/07/24/1-junit-perf/</url>
      
        <content type="html"><![CDATA[<h1 id="使用JunitPerf进行性能测试"><a href="#使用JunitPerf进行性能测试" class="headerlink" title="使用JunitPerf进行性能测试"></a>使用JunitPerf进行性能测试</h1><p>以下简单介绍一下如何使用JunitPerf进行性能测试，JunitPerf是基于JUnit4的一个单元性能测试插件，对于会远程调用API测试比较合适，如果想要比较nanosecond 延迟的则需要使用<a href="http://openjdk.java.net/projects/code-tools/jmh/" target="_blank" rel="noopener">JMH</a>.</p><h2 id="JunitPerf-依赖声明"><a href="#JunitPerf-依赖声明" class="headerlink" title="JunitPerf 依赖声明"></a>JunitPerf 依赖声明</h2><p>此例子假设使用MAVEN管理项目，所以在POM文件中添加：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.noconnor<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junitperf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="构建压力测试类"><a href="#构建压力测试类" class="headerlink" title="构建压力测试类"></a>构建压力测试类</h2><p>假设你想衡量DemoPerfService 类中的getServiceId方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoPerfService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServiceId</span><span class="params">(String userId)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> UUID.randomUUID().toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那么你可以构建如下的测试类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoServiceTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Rule</span></span><br><span class="line">    <span class="keyword">public</span> JUnitPerfRule perfTestRule = <span class="keyword">new</span> JUnitPerfRule();</span><br><span class="line">    DemoPerfService demoPerfService;</span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setupService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.demoPerfService = <span class="keyword">new</span> DemoPerfService();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@JUnitPerfTest</span>(threads = <span class="number">50</span>,durationMs = <span class="number">1200</span>,warmUpMs = <span class="number">100</span>,maxExecutionsPerSecond = <span class="number">110</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServiceId_withoutTestRequirement</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String result =demoPerfService.getServiceId(<span class="string">"userid"</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        Assert.assertNotNull(result);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>直接运行就可以进行压力测试,默认的测试报告可以在build/reports 目录下获取：</p><p><img src="images/ut/junitperf_1.jpg" alt="img"></p><p>以下是对于测试类的几点说明：</p><table><thead><tr><th>Item</th><th>定义说明</th><th>Default值或说明</th></tr></thead><tbody><tr><td>@Rule</td><td>申明为JUnit 的Rule类</td><td></td></tr><tr><td>JUnitPerfRule</td><td>JUnitPerf 测试规则类</td><td></td></tr><tr><td>@JunitPerfTest</td><td>声明为性能测试方法</td><td></td></tr><tr><td>threads</td><td>测试使用的线程数</td><td></td></tr><tr><td>durationMs</td><td>测试持续时间</td><td></td></tr><tr><td>warmUpMs</td><td>测试热身时间</td><td>热身时间的测试数据不会计算进最后的测试结果</td></tr><tr><td>maxExecutionsPerSecond</td><td>方法执行的上限</td><td>RateLimiter，控制TPS上限</td></tr></tbody></table><h2 id="对自己的测试设置期望值"><a href="#对自己的测试设置期望值" class="headerlink" title="对自己的测试设置期望值"></a>对自己的测试设置期望值</h2><p>使用@JUnitPerfTestRequirement 可以给性能测试设置期望值，这个annotation的属性有:</p><table><thead><tr><th>属性</th><th>定义</th></tr></thead><tbody><tr><td>percentits</td><td>设置例如90%/95%/50% 响应时间的期望</td></tr><tr><td>executionsPerSec</td><td>期望每秒执行测试(TPS)</td></tr><tr><td>allowedErrorPercentage</td><td>允许错误比例</td></tr><tr><td>minLatency</td><td>期望最小延时，如果实际最小延时超过这个数，则失败</td></tr><tr><td>maxLatency</td><td>期望最大延时，如果实际最大延时超过这个，则失败</td></tr><tr><td>meanLatency</td><td>期望中位数延时</td></tr></tbody></table><p>下面是使用了JUnitPerfTestRequirement的一个测试方法,需要和@JUnitPerfTest一起使用：</p><ul><li>@JUnitPerfTest 定义了压测的运行参数</li><li>@JUnitPerfTestRequirement定义了压测的期望值</li></ul><p>具体代码如下例:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">  <span class="meta">@JUnitPerfTest</span>(threads = <span class="number">50</span>,durationMs = <span class="number">1200</span>,warmUpMs = <span class="number">100</span>,maxExecutionsPerSecond = <span class="number">110</span>)</span><br><span class="line">  <span class="meta">@JUnitPerfTestRequirement</span>(percentiles = <span class="string">"90:7,95:7,98:7,99:8"</span>, executionsPerSec = <span class="number">10_000</span>, allowedErrorPercentage = <span class="number">0.10f</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServiceId</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">      String result =demoPerfService.getServiceId(<span class="string">"userid"</span>);</span><br><span class="line">      System.out.println(result);</span><br><span class="line">      Assert.assertNotNull(result);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>运行之后，如果发现没有满足JUnitPerfTestRequirement定义，则报错:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java.lang.AssertionError: Test throughput threshold not achieved</span><br><span class="line">Expected: is &lt;<span class="keyword">true</span>&gt;</span><br><span class="line">     but: was &lt;<span class="keyword">false</span>&gt;</span><br><span class="line">Expected :is &lt;<span class="keyword">true</span>&gt;</span><br></pre></td></tr></table></figure><p>是不是很简单！</p><h2 id="设置测试报告地址"><a href="#设置测试报告地址" class="headerlink" title="设置测试报告地址"></a>设置测试报告地址</h2><p>JUnitPerf 有不同的测试报告，个人觉得HTML的测试报告比较实用，具体只需要:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Rule</span></span><br><span class="line"><span class="keyword">public</span> JUnitPerfRule perfTestRule = <span class="keyword">new</span> JUnitPerfRule(<span class="keyword">new</span> HtmlReportGenerator(<span class="string">"perf/report.html"</span>));</span><br></pre></td></tr></table></figure><h2 id="完整的例子"><a href="#完整的例子" class="headerlink" title="完整的例子"></a>完整的例子</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoServiceTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Rule</span></span><br><span class="line"><span class="comment">//    public JUnitPerfRule perfTestRule = new JUnitPerfRule(new HtmlReportGenerator("perf/report.html"));</span></span><br><span class="line">    <span class="keyword">public</span> JUnitPerfRule perfTestRule = <span class="keyword">new</span> JUnitPerfRule();</span><br><span class="line">    DemoPerfService demoPerfService;</span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setupService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.demoPerfService = <span class="keyword">new</span> DemoPerfService();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@JUnitPerfTest</span>(threads = <span class="number">50</span>,durationMs = <span class="number">1200</span>,warmUpMs = <span class="number">100</span>,maxExecutionsPerSecond = <span class="number">110</span>)</span><br><span class="line">    <span class="meta">@JUnitPerfTestRequirement</span>(percentiles = <span class="string">"90:7,95:7,98:7,99:8"</span>, executionsPerSec = <span class="number">10_000</span>, allowedErrorPercentage = <span class="number">0.10f</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServiceId</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String result =demoPerfService.getServiceId(<span class="string">"userid"</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        Assert.assertNotNull(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@JUnitPerfTest</span>(threads = <span class="number">50</span>,durationMs = <span class="number">1200</span>,warmUpMs = <span class="number">100</span>,maxExecutionsPerSecond = <span class="number">110</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServiceId_withoutTestRequirement</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String result =demoPerfService.getServiceId(<span class="string">"userid"</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        Assert.assertNotNull(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后可以再设定的目录中查看测试报告，测试报告和默认的HTML 测试报告是一致的.</p><h2 id="一点问题"><a href="#一点问题" class="headerlink" title="一点问题"></a>一点问题</h2><p>压力测试过程中，有时数据不能复用，举个例子来说，如果想测试完全没有访问redis缓存情况下，通过userid查询的user信息速度，那么压测的时候userid就不能复用，因为一旦访问了就会放入redis缓存而影响结果，这个可以通过使用其他的方法解决，比如曾今使用过BlockingQueue的方法进行过尝试，具体方法如下：</p><ol><li>读取所有userid的文件</li><li>把userid放到一个BlockingQueue中</li><li>压测时获取userid通过BlockingQueue去获取</li></ol><p>这样就解决了数据不能重复的方法，具体方法可以参考如下代码:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">static</span> BlockingQueue&lt;String&gt; distinctIdQueue ;</span><br><span class="line">    <span class="meta">@Rule</span></span><br><span class="line">    <span class="keyword">public</span> JUnitPerfRule perfTestRule =</span><br><span class="line">            <span class="keyword">new</span> JUnitPerfRule(<span class="keyword">new</span> HtmlReportGenerator(<span class="string">"data/report_test.html"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeClass</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setupQueue</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        distinctIdQueue = <span class="keyword">new</span> LinkedBlockingQueue&lt;&gt;();</span><br><span class="line">        Files.readAllLines(</span><br><span class="line">                Paths.get(<span class="string">"data/userid.txt"</span>)</span><br><span class="line">        ).parallelStream().forEach(</span><br><span class="line">                item-&gt; &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        distinctIdQueue.put(item);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@JUnitPerfTest</span>(threads = <span class="number">50</span>,durationMs = <span class="number">1200</span>,warmUpMs = <span class="number">100</span>,maxExecutionsPerSecond = <span class="number">110</span>)</span><br><span class="line">    <span class="meta">@JUnitPerfTestRequirement</span>(percentiles = <span class="string">"90:7,95:7,98:7,99:8"</span>, executionsPerSec = <span class="number">10_000</span>, allowedErrorPercentage = <span class="number">0.10f</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServiceId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String uesrId = distinctIdQueue.take();</span><br><span class="line">        String result =demoPerfService.getServiceId(userId);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        Assert.assertNotNull(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> junit </tag>
            
            <tag> performance </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unit Testing Intro</title>
      <link href="/2018/07/18/0-ut-junit/"/>
      <url>/2018/07/18/0-ut-junit/</url>
      
        <content type="html"><![CDATA[<h1 id="Just-DO-It-Unit-Testing"><a href="#Just-DO-It-Unit-Testing" class="headerlink" title="Just DO It - Unit Testing"></a>Just DO It - Unit Testing</h1><p>This is first blog for <strong><em>just do it</em></strong> series. The purpose for the <strong><em>just do it</em></strong> series is quit personal. As an aged tester, I have tried a bunch of different testing. And obviously,I am good at some types, and only have concepts in some other types.But There is no notes taken for these, sometimes it bothers me a lot when I need to explain or demo. Anthoer main reason is that I believe that when you want to test something, you need to understand what you test, it is not only the superficial workflow or business logic, but also some techincal inside. <strong><em>just do it</em></strong> is for all the testings or components I have  experienced and learned. It is like footprints of my long enough tester jouney. And Just Do it is more than any words.</p><p>ps: for learning English, I decided to write it in English at first.</p><h2 id="Unit-Testing-Paradox"><a href="#Unit-Testing-Paradox" class="headerlink" title="Unit Testing Paradox"></a>Unit Testing Paradox</h2><p>There are many blogs out there claiming Unit Testing is such a good thing for improve product quality,and it is quick and cheap. Some Evangelists even claimed unit testing plays very import role in agile,CI/CD process. But in reality, writing unit testing is very rare in a large amount of companies here China. Why? Why good thing doesn’t happen? It is quick,improving quality, more important is cheap? Why so many people/companies don’t buy in? I don’t know, but I want to dive it for seeking the reason.</p><h2 id="JUnit-Try"><a href="#JUnit-Try" class="headerlink" title="JUnit Try"></a>JUnit Try</h2><p>JUnit is a very popular unit testing framework, so Let me try from this.</p><h3 id="Build-a-Simple-Demo-Application"><a href="#Build-a-Simple-Demo-Application" class="headerlink" title="Build a Simple Demo Application"></a>Build a Simple Demo Application</h3><p>But hold on,what application is for testing? OK, Let me build to simple ToDoApplication. What Features are included:</p><ul><li>Create ToDoItem : create a ToDoItem which status is TODO</li><li>Update ToDoItme: update a ToDoItem </li><li>Delete ToDoItem: set ToDoItem status to deleted</li><li>Complete ToDoItem: set ToDoItem status to completed</li></ul><p>I try to make it as simple as possible, so the demonstrate these futures, I create three classes:</p><ul><li>ToDOItem: it is an entity, which is used to save to database. Just treat it as a database table</li><li>ToDoItemDTO: it is a DTO entity, treat is as input</li><li>ToDoItemService: do the transformation, transfer ToDoItemDTO to ToDoItem</li></ul><p>Here is very simple codes:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line">    <span class="keyword">private</span> String details;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> status;</span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoItemDTO</span>  </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line">    <span class="keyword">private</span> String details;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> status=ToDoStatusEnum.TODO.getStatusId();</span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ToDoItem <span class="title">createToDoItem</span><span class="params">(ToDoItemDTO dto)</span></span>&#123;</span><br><span class="line">        ToDoItem toDoItem = <span class="keyword">new</span> ToDoItem();</span><br><span class="line">        toDoItem.setId(UUIDGenerator.generateToDoId());</span><br><span class="line">        toDoItem.setStatus(dto.getStatus());</span><br><span class="line">        toDoItem.setDesc(dto.getDesc());</span><br><span class="line">        toDoItem.setDetails(dto.getDetails());</span><br><span class="line">        toDoItem.setUserId(dto.getUserId());</span><br><span class="line">        <span class="keyword">return</span> toDoItem;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ToDoItem <span class="title">updateToDoItem</span><span class="params">(ToDoItemDTO dto)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> createToDoItem(dto);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//todo: should make todo item statue to DELETED</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ToDoItem <span class="title">deleteToDoItem</span><span class="params">(ToDoItemDTO dto)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> createToDoItem(dto);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//todo: should make todo item statue to Completed</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ToDoItem <span class="title">completeToDoItem</span><span class="params">(ToDoItemDTO dto)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> createToDoItem(dto);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> ToDoStatusEnum &#123;</span><br><span class="line">    TODO(<span class="number">0</span>),WIP(<span class="number">1</span>),DONE(<span class="number">2</span>),PENDING(<span class="number">3</span>),DELETED(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getStatusId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> statusId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> statusId;</span><br><span class="line"></span><br><span class="line">    ToDoStatusEnum(<span class="keyword">int</span> statusId) &#123;</span><br><span class="line">        <span class="keyword">this</span>.statusId= statusId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Let’s-create-first-JUNIT-Test-cases"><a href="#Let’s-create-first-JUNIT-Test-cases" class="headerlink" title="Let’s create first JUNIT Test cases"></a>Let’s create first JUNIT Test cases</h3><p>It is obviously the input is an instance of ToDoDTO, and the output is ToDoItem and the most important part to test is ToDoService. So first thing first, here is the first one test case for ToDoServicce, to test create todoitem successfully, and the content in DTO should be same as the new created ToDoItem.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.Assert;</span><br><span class="line"><span class="keyword">import</span> org.junit.BeforeClass;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoServiceTest</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCreateToDoItem_successful</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ToDoService toDoService; = <span class="keyword">new</span> ToDoService();</span><br><span class="line">        ToDoItemDTO dto = <span class="keyword">new</span> ToDoItemDTO();</span><br><span class="line">        dto.setDesc(<span class="string">"test todo"</span>);</span><br><span class="line">        dto.setDetails(<span class="string">"test todo details"</span>);</span><br><span class="line">        ToDoItem toDoItem =toDoService.createToDoItem(dto);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDesc(),<span class="string">"test todo"</span>);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDetails(),<span class="string">"test todo details"</span>);</span><br><span class="line">        Assert.assertEquals(toDoItem.getStatus(),ToDoStatusEnum.TODO.getStatusId());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Here I only use two JUNIT elements, these two elements will be used many many times, if you are writing test codes.</p><ul><li>@Test: annotation test mark the method as test method</li><li>Assert.assertEquals: compare the expected value and actual value</li></ul><p>It is quit straightforward, when you test something, give the input, process it, and compare the output to the expected value, if meet, pass, otherwise failed.</p><h3 id="More-cases"><a href="#More-cases" class="headerlink" title="More cases"></a>More cases</h3><p>After Complete the first case, let’s do more. We want to test more functionalities, like update,delete, complete todoitem. Here you go:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoServiceTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ToDoService toDoService;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>  ToDoItemDTO dto ;</span><br><span class="line">    <span class="meta">@BeforeClass</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setupToDoService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        toDoService = <span class="keyword">new</span> ToDoService();</span><br><span class="line">        dto = <span class="keyword">new</span> ToDoItemDTO();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCreateToDoItem_successful</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        dto.setDesc(<span class="string">"test todo"</span>);</span><br><span class="line">        dto.setDetails(<span class="string">"test todo details"</span>);</span><br><span class="line">        ToDoItem toDoItem =toDoService.createToDoItem(dto);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDesc(),<span class="string">"test todo"</span>);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDetails(),<span class="string">"test todo details"</span>);</span><br><span class="line">        Assert.assertEquals(toDoItem.getStatus(),ToDoStatusEnum.TODO.getStatusId());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateToDoItem_successful</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        dto.setDesc(<span class="string">"update"</span>);</span><br><span class="line">        dto.setDetails(<span class="string">"update"</span>);</span><br><span class="line">        ToDoItem toDoItem =toDoService.createToDoItem(dto);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDesc(),<span class="string">"update"</span>);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDetails(),<span class="string">"update"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteToDoItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ToDoItem toDoItem =toDoService.deleteToDoItem(dto);</span><br><span class="line">        Assert.assertEquals(toDoItem.getStatus(),ToDoStatusEnum.DELETED.getStatusId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">completeToDoItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ToDoItem toDoItem =toDoService.deleteToDoItem(dto);</span><br><span class="line">        Assert.assertEquals(toDoItem.getStatus(),ToDoStatusEnum.DELETED.getStatusId());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>In above codes, I use a new junit annonations:</p><ul><li>@BeforeClass</li></ul><p>@BeforeClass is invoked before the test class initialized. So the method and should be static. Here why I used @BeforeClass is because I want to resue the toDoService accross all the test methods. So it should be a static.</p><p>And another Junit annotation @Before is simmilar with @BeforeClass.<br>It is invoked before every test method. Here is a sample codes to show it:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JunitAnnotationDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String testString=<span class="string">"First"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span></span>&#123;</span><br><span class="line">        testString = <span class="keyword">this</span>.testString + <span class="string">",setup"</span>;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTestString_First</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(testString);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTestString_Second</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(testString);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>From the result of System.out.println(this), actually JUNIT use different instance to run the test methods</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">io.hedwig.justdoit.demo.JunitAnnotationDemo@<span class="number">17</span>d10166</span><br><span class="line">First,setup</span><br><span class="line">io.hedwig.justdoit.demo.JunitAnnotationDemo@<span class="number">4f</span>8e5cde</span><br><span class="line">First,setup</span><br></pre></td></tr></table></figure><h3 id="Run-the-tests"><a href="#Run-the-tests" class="headerlink" title="Run the tests"></a>Run the tests</h3><p>Back to the ToDoItem unit tests. Run the ToDoServiceTest, there are several errors, here is an example for deleteToDoItem: </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java.lang.AssertionError: </span><br><span class="line">Expected :<span class="number">0</span></span><br><span class="line">Actual   :<span class="number">4</span></span><br><span class="line"> &lt;Click to see difference&gt;</span><br></pre></td></tr></table></figure><p>The target to unit test is to make sure you codes pass the tests quickly. Look back to ToDoService, it is obviously, deleteToDoItem should set the ToDoItem status to DELETE, but the function is omitted. So add the codes to fix it, and re-run the tests to make it all passed. </p><h2 id="Unit-Test-Thinking"><a href="#Unit-Test-Thinking" class="headerlink" title="Unit Test Thinking"></a>Unit Test Thinking</h2><p>Actully this process is as known as TDD (Test Driven Development). Before actually complete the real working codes, write test codes first. The purpose of these test codes, I think they could be :</p><ul><li>Features Definition</li><li>Task Tracking Tool</li><li>Boundary Checking Tool</li></ul><p>Why? I think in reality, there are many undocumented features in PRD, no one actually mantained it. Unit Test documents these features.</p><p>Also if writes test codes before complete the real codes, then you pass test methods one by one, that means developer complete the sub-tasks one by one, so It is Task Tracking tool. Imaging that, if you want to complete 10 sub-tasks, but you are interruptted every hour by meetings or chattings. Every time develop want to find where to start, just run the unit tests, then start from the failed tests.</p><p>There are always boundary cases, write into codes to check, it helps develop to find bugs, and also it could be checked if develop have some new changes.</p><h2 id="What-should-be-paid-for-Unit-Tests"><a href="#What-should-be-paid-for-Unit-Tests" class="headerlink" title="What should be paid for Unit Tests"></a>What should be paid for Unit Tests</h2><p>Above cases looks so fascination, Unit Tests could tracking features,tasks, and check the codes when changes happened to ensure your changes are correct. But Why developers still don’t want to write the Unit tests?  Let’s just counting the lines of code in above examples, the truth is that the test codes are more lines than real codes. It is not joke, it happened. So I can understand why developer don’t want to write unit tests, maybe the workload!!</p><p>Understand what the develop thoughts are, it is also one of targets in <strong><em>just do it</em></strong> series, try it and then find where the issues are.</p><p>Because write testing codes need to take more times, pick what to test and use less test codes to achieve coverages is more critical and practical. </p><p><a href="https://github.com/evenhumble/justdo-it/tree/master/ut-cases" target="_blank" rel="noopener">code repo</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ut </tag>
            
            <tag> justdoit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ansible In 30 Minutes</title>
      <link href="/2018/07/01/1-ansible-in-10-minutes/"/>
      <url>/2018/07/01/1-ansible-in-10-minutes/</url>
      
        <content type="html"><![CDATA[<h1 id="Ansible-Basic-Concept"><a href="#Ansible-Basic-Concept" class="headerlink" title="Ansible Basic Concept"></a>Ansible Basic Concept</h1><p>ansible 是一个操作机器的工具,可以通过编排不同的inventory,组合不同的命令来将日常运维的操作<br>变成可运行的脚本资产,同时也可以积累常用的脚本以便复用.</p><p>下面是关于ansible的一些基础概念的脑图,总体而言ansible包括了以下几个概念：</p><ul><li>inventory: 定义主机,定义操作对象<ul><li>Host:主机</li><li>Group：不同的主机组合成一个组，一个组下面可以有子组，于是就构成了一个树形结构</li></ul></li><li>variable： 变量，主要用来定义对于操作机器时使用的可变参数</li></ul><h1 id="Ansible-Installation"><a href="#Ansible-Installation" class="headerlink" title="Ansible Installation"></a>Ansible Installation</h1><ul><li>install in MAC</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew unisntall ansible</span><br><span class="line">brew install ansible</span><br></pre></td></tr></table></figure><ul><li>install in centos</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install epel-release</span><br><span class="line">sudo yum install ansible -y</span><br></pre></td></tr></table></figure><h1 id="Configure-hosts-for-ansible-ssh-connector"><a href="#Configure-hosts-for-ansible-ssh-connector" class="headerlink" title="Configure hosts for ansible ssh connector"></a>Configure hosts for ansible ssh connector</h1><ul><li>copy ssh key to different hosts</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ssh-keygen</span><br><span class="line">ssh-copy-id remoteuser@remote.server</span><br><span class="line">ssh-keyscan remote.server &gt;&gt; ~/.ssh/known_hosts</span><br></pre></td></tr></table></figure><ul><li>check ssh connection</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh remoteuser@remote.server</span><br></pre></td></tr></table></figure><p>it is done.</p><h1 id="Ansible-Ad-hoc-Commands"><a href="#Ansible-Ad-hoc-Commands" class="headerlink" title="Ansible Ad-hoc Commands"></a>Ansible Ad-hoc Commands</h1><p>ansible 命令的pattern 如下：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible &lt;host-pattern&gt; [options]</span><br></pre></td></tr></table></figure><p>具体查看ansible 的使用帮助是：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><h2 id="ansible-ad-hoc-command-检查安装环境"><a href="#ansible-ad-hoc-command-检查安装环境" class="headerlink" title="ansible ad-hoc command - 检查安装环境"></a>ansible ad-hoc command - 检查安装环境</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m ping -u root</span><br></pre></td></tr></table></figure><h2 id="ansible-ad-hoc-command-执行命令"><a href="#ansible-ad-hoc-command-执行命令" class="headerlink" title="ansible ad-hoc command - 执行命令"></a>ansible ad-hoc command - 执行命令</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -a <span class="string">"/bin/sh echo hello world"</span></span><br></pre></td></tr></table></figure><h2 id="ansible-ad-hoc-command-copy-files"><a href="#ansible-ad-hoc-command-copy-files" class="headerlink" title="ansible ad-hoc command - copy files"></a>ansible ad-hoc command - copy files</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -m copy -a <span class="string">"src=/etc/hosts dest=/tmp/hosts"</span></span><br></pre></td></tr></table></figure><h2 id="ansible-ad-hoc-command-yum-install"><a href="#ansible-ad-hoc-command-yum-install" class="headerlink" title="ansible ad-hoc command - yum install"></a>ansible ad-hoc command - yum install</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -m yum -a <span class="string">"name=acme state=present"</span></span><br></pre></td></tr></table></figure><h2 id="ansible-ad-hoc-command-add-user"><a href="#ansible-ad-hoc-command-add-user" class="headerlink" title="ansible ad-hoc command - add user"></a>ansible ad-hoc command - add user</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m user -a <span class="string">"name=foo passsword=&lt;crypted password here&gt;"</span></span><br></pre></td></tr></table></figure><h2 id="ansible-ad-hoc-command-download-git-包"><a href="#ansible-ad-hoc-command-download-git-包" class="headerlink" title="ansible ad-hoc command - download git 包"></a>ansible ad-hoc command - download git 包</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -m git -a <span class="string">"repo=git://foo.example.io/repo.git dest=/src/myapp"</span></span><br></pre></td></tr></table></figure><h2 id="ansible-ad-hoc-command-start-service"><a href="#ansible-ad-hoc-command-start-service" class="headerlink" title="ansible ad-hoc command - start service"></a>ansible ad-hoc command - start service</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -m service -a <span class="string">"name=httpd state=started"</span></span><br></pre></td></tr></table></figure><h2 id="ansible-ad-hoc-command-并行运行"><a href="#ansible-ad-hoc-command-并行运行" class="headerlink" title="ansible ad-hoc command - 并行运行"></a>ansible ad-hoc command - 并行运行</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -a <span class="string">"/sbin/reboot"</span> -f 10</span><br></pre></td></tr></table></figure><h2 id="ansible-ad-hoc-command-查看全部系统信息"><a href="#ansible-ad-hoc-command-查看全部系统信息" class="headerlink" title="ansible ad-hoc command - 查看全部系统信息"></a>ansible ad-hoc command - 查看全部系统信息</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m setup</span><br></pre></td></tr></table></figure><h2 id="ansible-ad-hoc-command-小结"><a href="#ansible-ad-hoc-command-小结" class="headerlink" title="ansible ad-hoc command 小结"></a>ansible ad-hoc command 小结</h2><p>从以上的例子中我们可以看到ansible的命令一般都会使用如下几点：</p><ul><li>module: -m </li><li>module_args: -a </li><li>hosts: all/web/……</li></ul><p>以上三个组合成为了下面的一个命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m service -a <span class="string">"name=httpd state=started"</span></span><br></pre></td></tr></table></figure><p>从python的角度看,可以用伪代码的方式:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">def copy(args=&#123;&#125;):</span><br><span class="line">    <span class="keyword">for</span> kwarg, v <span class="keyword">in</span> args.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&#123;key&#125;=&#123;value&#125;"</span>.format(key=kwarg, value=v))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="built_in">test</span>(args=&#123;&#125;):</span><br><span class="line">    <span class="keyword">for</span> kwarg, v <span class="keyword">in</span> args.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&#123;key&#125;=&#123;value&#125;"</span>.format(key=kwarg, value=v))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">module_mapping = &#123;</span><br><span class="line">    <span class="string">"copy"</span>: copy,</span><br><span class="line">    <span class="string">"test"</span>: <span class="built_in">test</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def ansible(module, module_args):</span><br><span class="line">    func = module_mapping.get(module)</span><br><span class="line">    parsed = module_args.split(<span class="string">" "</span>)</span><br><span class="line">    args = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> module_arg <span class="keyword">in</span> parsed:</span><br><span class="line">        kv = module_arg.split(<span class="string">"="</span>)</span><br><span class="line">        args[kv[0]] = kv[1]</span><br><span class="line">    func(args)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    ansible(module=<span class="string">'copy'</span>, module_args=<span class="string">"name=name test=test"</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> CI/CD </tag>
            
            <tag> ansible </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Travis - GithubToolChain-1</title>
      <link href="/2018/07/01/2-Github-Travis/"/>
      <url>/2018/07/01/2-Github-Travis/</url>
      
        <content type="html"><![CDATA[<h1 id="Github工具系列-Travis"><a href="#Github工具系列-Travis" class="headerlink" title="Github工具系列-Travis"></a>Github工具系列-Travis</h1><p>Travis 是一个持续集成工具，github上的每一次提交都可以触发一次build. 在说Travis之前，先说说持续集成，Continuous Integration(CI)的概念。</p><p><a href="https://martinfowler.com/articles/continuousIntegration.html" target="_blank" rel="noopener">CI</a> 这是martin flow关于持续集成的一片文章。CI简而言之就是一个开发的方式，这个方式有别于瀑布式开发中在所有功能(大量代码)完成之后才进行验证，他提倡通过不停的提交一个个小功能(代码2量不那么大)进行验证。很显然采用这种开发方式，会带来频繁的build和test，因此也催生了Jenkins等持续集成的工具。Travis也是这种工具，和Jenkins不同的是，Travis更像一种云服务，不需要你在本地部署。</p><p>回到CI这个话题，为什么要采用CI这个方式呢？他有什么好处呢？CI的好处是：</p><p>···<br>通过不停的build,test可以对功能，代码获取快速的反馈，进行快速的修复，因此项目的进度实际上是非常稳定的，出现在产品开发完之后，产品，需求方向出现错误会尽可能的避免<br>···</p><p>从目前来看，国内很多公司大都采用了CI的方式，大型一些的公司每天都有成千上万的build，test在自动化的进行，没有一个工具来做这些的话，可以想象成本会有多高，也就无从谈起或者实施CI了。有一点比较佩服老外，他们如果觉得方向是正确的，就会想办法通过工具或者其他手段来实现，软件行业的各种思想，大部分都是老外提出的。(critical thinking这个方面也是我自己要好好提高的）</p><h2 id="Run-Travis"><a href="#Run-Travis" class="headerlink" title="Run Travis"></a>Run Travis</h2><p>.travis.yml file for JAVA</p><h2 id="travis-yml-detail"><a href="#travis-yml-detail" class="headerlink" title=".travis,yml detail"></a>.travis,yml detail</h2><p><a href="https://docs.travis-ci.com/user/for-beginners/" target="_blank" rel="noopener">reference</a></p><ul><li>Building,testing,deployment</li><li>Builds,Jobs,Stages and Phases <ul><li>phases, sequential steps of a jab</li><li>build, a group of jobs</li><li>job, serveral phases</li><li>stage</li></ul></li><li>travis phases:<ul><li>before_install</li><li>install</li><li>before_script</li><li>script</li></ul></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> CI/CD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>马桶测试-1： 创建干净的测试数据</title>
      <link href="/2018/07/01/1-CleanlyTestData/"/>
      <url>/2018/07/01/1-CleanlyTestData/</url>
      
        <content type="html"><![CDATA[<h1 id="马桶测试-1：-创建干净的测试数据"><a href="#马桶测试-1：-创建干净的测试数据" class="headerlink" title="马桶测试-1： 创建干净的测试数据"></a>马桶测试-1： 创建干净的测试数据</h1><p>Google Testing on the Toilet Series 翻译第一篇,创建干净的测试数据</p><p>原文 <a href="https://testing.googleblog.com/2018/02/testing-on-toilet-cleanly-create-test.html" target="_blank" rel="noopener">Origin Testing on the Toilet: Cleanly Create Test Data</a></p><p>Helper方法让创建数据非常方便，但是随着时间的推移，不同的变量数据创建方法加入之后，代码可读性变得不那么好了.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This helper method starts with just a single parameter:</span></span><br><span class="line">Company company = newCompany(PUBLIC);</span><br><span class="line"></span><br><span class="line"><span class="comment">// But soon it acquires more and more parameters.</span></span><br><span class="line"><span class="comment">// Conditionals creep into the newCompany() method body to handle the nulls,</span></span><br><span class="line"><span class="comment">// and the method calls become hard to read due to the long parameter lists:</span></span><br><span class="line">Company small = newCompany(<span class="number">2</span>, <span class="number">2</span>, <span class="keyword">null</span>, PUBLIC);</span><br><span class="line">Company privatelyOwned = newCompany(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, PRIVATE);</span><br><span class="line">Company bankrupt = newCompany(<span class="keyword">null</span>, <span class="keyword">null</span>, PAST_DATE, PUBLIC);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Or a new method is added each time a test needs a different combination of fields:</span></span><br><span class="line">Company small = newCompanyWithEmployeesAndBoardMembers(<span class="number">2</span>, <span class="number">2</span>, PUBLIC);</span><br><span class="line">Company privatelyOwned = newCompanyWithType(PRIVATE);</span><br><span class="line">Company bankrupt = newCompanyWithBankruptcyDate(PAST_DATE, PUBLIC);</span><br></pre></td></tr></table></figure><p>为了让测试数据代码更据可读性，使用builder pattern，通过返回部分数据的builder类来创建数据，修改不同的状态是一个不错的方法。 创建数据的方法可以生成部分的默认数据，之后再修改需要修改的数据，可以让测试代码方便而且容易阅读，如下例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Company small = newCompany().setEmployees(<span class="number">2</span>).setBoardMembers(<span class="number">2</span>).build();</span><br><span class="line">Company privatelyOwned = newCompany().setType(PRIVATE).build();</span><br><span class="line">Company bankrupt = newCompany().setBankruptcyDate(PAST_DATE).build();</span><br><span class="line">Company arbitraryCompany = newCompany().build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Zero parameters makes this method reusable for different variations of Company.</span></span><br><span class="line"><span class="comment">// It also doesn’t need conditionals to ignore parameters that aren’t set (e.g. null</span></span><br><span class="line"><span class="comment">// values) since a test can simply not set a field if it doesn’t care about it.</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Company.<span class="function">Builder <span class="title">newCompany</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Company.newBuilder().setType(PUBLIC).setEmployees(<span class="number">100</span>); <span class="comment">// Set required fields</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同时测试不应该以来任何的默认值，如果有依赖就让使用者必须去了解具体的创建数据方法的实现了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This test needs a public company, so explicitly set it.</span></span><br><span class="line"><span class="comment">// It also needs a company with no board members, so explicitly clear it.</span></span><br><span class="line">Company publicNoBoardMembers = newCompany().setType(PUBLIC).clearBoardMembers().build();</span><br></pre></td></tr></table></figure><p>更多详细信息可以参考：<a href="http://www.natpryce.com/articles/000714.html" target="_blank" rel="noopener">http://www.natpryce.com/articles/000714.html</a></p><h2 id="附上原文："><a href="#附上原文：" class="headerlink" title="附上原文："></a>附上原文：</h2><p>This article was adapted from a Google Testing on the Toilet (TotT) episode. You can download a printer-friendly version of this TotT episode and post it in your office.<br>By Ben Yu<br>Helper methods make it easier to create test data. But they can become difficult to read over time as you need more variations of the test data to satisfy constantly evolving requirements from new tests:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This helper method starts with just a single parameter:</span></span><br><span class="line">Company company = newCompany(PUBLIC);</span><br><span class="line"></span><br><span class="line"><span class="comment">// But soon it acquires more and more parameters.</span></span><br><span class="line"><span class="comment">// Conditionals creep into the newCompany() method body to handle the nulls,</span></span><br><span class="line"><span class="comment">// and the method calls become hard to read due to the long parameter lists:</span></span><br><span class="line">Company small = newCompany(<span class="number">2</span>, <span class="number">2</span>, <span class="keyword">null</span>, PUBLIC);</span><br><span class="line">Company privatelyOwned = newCompany(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, PRIVATE);</span><br><span class="line">Company bankrupt = newCompany(<span class="keyword">null</span>, <span class="keyword">null</span>, PAST_DATE, PUBLIC);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Or a new method is added each time a test needs a different combination of fields:</span></span><br><span class="line">Company small = newCompanyWithEmployeesAndBoardMembers(<span class="number">2</span>, <span class="number">2</span>, PUBLIC);</span><br><span class="line">Company privatelyOwned = newCompanyWithType(PRIVATE);</span><br><span class="line">Company bankrupt = newCompanyWithBankruptcyDate(PAST_DATE, PUBLIC);</span><br></pre></td></tr></table></figure><p>Instead, use the test data builder pattern: create a helper method that returns a partially-built object (e.g., a Builder in languages such as Java, or a mutable object) whose state can be overridden in tests. The helper method initializes logically-required fields to reasonable defaults, so each test can specify only fields relevant to the case being tested:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Company small = newCompany().setEmployees(<span class="number">2</span>).setBoardMembers(<span class="number">2</span>).build();</span><br><span class="line">Company privatelyOwned = newCompany().setType(PRIVATE).build();</span><br><span class="line">Company bankrupt = newCompany().setBankruptcyDate(PAST_DATE).build();</span><br><span class="line">Company arbitraryCompany = newCompany().build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Zero parameters makes this method reusable for different variations of Company.</span></span><br><span class="line"><span class="comment">// It also doesn’t need conditionals to ignore parameters that aren’t set (e.g. null</span></span><br><span class="line"><span class="comment">// values) since a test can simply not set a field if it doesn’t care about it.</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Company.<span class="function">Builder <span class="title">newCompany</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Company.newBuilder().setType(PUBLIC).setEmployees(<span class="number">100</span>); <span class="comment">// Set required fields</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Also note that tests should never rely on default values that are specified by a helper method since that forces readers to read the helper method’s implementation details in order to understand the test.<br>// This test needs a public company, so explicitly set it.<br>// It also needs a company with no board members, so explicitly clear it.<br>Company publicNoBoardMembers = newCompany().setType(PUBLIC).clearBoardMembers().build();<br>You can learn more about this topic at <a href="http://www.natpryce.com/articles/000714.html" target="_blank" rel="noopener">http://www.natpryce.com/articles/000714.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> google_test_blog_translation </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Clean Code Reading Note</title>
      <link href="/2018/07/01/2-CleanCode/"/>
      <url>/2018/07/01/2-CleanCode/</url>
      
        <content type="html"><![CDATA[<h1 id="Clean-Code-The-Art-of-Readable-Code-Reading-Notes"><a href="#Clean-Code-The-Art-of-Readable-Code-Reading-Notes" class="headerlink" title="Clean Code/The Art of Readable Code Reading Notes"></a>Clean Code/The Art of Readable Code Reading Notes</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">知易行难</span><br><span class="line">理念可能都有，那么怎么做呢？</span><br></pre></td></tr></table></figure><p>匆匆看过两本书，两本书提供了一些如何写好代码的纲领，当时很明显真要写好不是读完两本书就可以的。多练，多思考才可以。两本书有不少比较相似的内容，所以很明显这些相似的内容就是日常需要关注的地方，不管是注释，方法命名，变量命名，重构这些都是日常工作中时刻注意的。</p><p>Clean Code和The Art of Readable Code看完对于我来说，更多的是对于作者面面俱到细节的描述惊讶，居然有人能把这些琐碎的事情说的这么完整和逻辑感十足。可以说健壮的代码关于细节的处理是相当的繁琐，把繁琐的事情写成Clean Code不是一件容易事情，我们不缺理念，我们缺的是细节，谁都说我要写漂亮整齐的代码，然后怎么做到呢？我们抱怨别人的代码混乱，但是我们重写真的可以写的刚好吗？如果我们想写的好，那要如何去做呢？这本书给出了一些答案，而这些就是我学习的要点。</p><h2 id="Clean-Code-chapter-1介绍"><a href="#Clean-Code-chapter-1介绍" class="headerlink" title="Clean Code-chapter 1介绍"></a>Clean Code-chapter 1介绍</h2><p>这个章节讲述了几个关于混乱代码的伤害(实际上是关于公司/产品的生存问题)，引用了不同技术大牛对于Clean Code的一些看法同时引出下面作者要写的关于Clean code的内容。大多数大牛们的说法都比价抽象，所以能记住的不多，下面是个印象比较的说法：</p><ul><li><figure class="highlight plain"><figcaption><span>Equals Never```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- 没有测试代码，就没有Clean Code(当然是TDD派)</span><br><span class="line">- 没有重复代码，可读性好，小块代码</span><br><span class="line">- 童子军军规：让营地比你来的时更干净，一点点清理，一点点消除，慢慢变成clean code</span><br><span class="line">- 读代码：写代码=10:1，读远远超过写，为什么需要Clean Code了？</span><br><span class="line"></span><br><span class="line">## Clean Code 的一些基本常识</span><br><span class="line"></span><br><span class="line">- 起名字的艺术，有意义的名字，变量，函数，参数，类，包等等</span><br><span class="line">   * 名副其实</span><br><span class="line">   * 避免误导，缩写/拼硬真的都知道吗</span><br><span class="line">   * 有意义的区分</span><br><span class="line">   ```java</span><br><span class="line">    copy(int[] a1,int a2[])</span><br><span class="line">    //不如</span><br><span class="line">    copy(int[] source,int[] dest)</span><br></pre></td></tr></table></figure><ul><li>读的出来的名字</li><li>每个概念对应一个词，在一个应用中保持一致</li><li>使用已有解决方案领域的名称，比如遵循常用Design-pattern中的名称</li><li>使用业务领域中名称</li><li>添加有意义的语境名称，不使用无意义的语境名称</li></ul></li><li><p>函数</p><ul><li>函数名称，描述性，动词和关键字</li><li>函数变量，参数名称尽量有意义，数量尽量小于3个，善用可变参数</li><li>短小尤其是高层的函数，尽量有意义的函数组合而成(&lt;3000 行)</li><li>只做一件事情</li><li>少用switch</li><li>无副作用，比如调用有前提条件，需要注意如何更优雅的处理</li><li>setIfExist</li><li>Exception 替代返回错误代码</li><li>抽离try/catch的代码</li><li>DRY:Don’t Repeat Yourself</li><li>一个入口一个出口(一个return)</li></ul></li><li><p>注释</p><ul><li>法律信息</li><li>代码就是注释，给变量，函数起个好名字胜过很多注释</li><li>提供信息的注释，避免无意义或者和代码不同步的注释</li><li>警示，提醒可能修改时遇到问题</li><li>TODO</li><li>放大某种看来不合理的问题，说明trade-off的情况或者特别处理的意义</li><li>修改的日志，修改的comments</li></ul></li><li><p>格式<br>格式是没有太多好说的，或许用一个stylecheck的工具更为好.</p></li><li><p>对象和数据结构</p><ul><li>模块不应该了解它内部的对象情形</li><li>DTO 通信/ActiveRecord-find/search， 这些是数据结构，不要有业务逻辑</li><li>对象暴露行为，隐藏数据/数据结构暴露数据，不要有明显的行为</li></ul></li><li><p>异常处理</p><ul><li>异常而非返回码</li><li>使用Runtime Exception</li><li>异常信息</li><li>定义常规流程，不要返回NULL</li></ul></li><li><p>单元测试</p><ul><li>TDD，测试代码和业务代码，保持测试代码整齐(让人可以维护)</li><li>测试代码可读性，确保一致可以延续下去和业务保持同步(code-review,如何解决代码量打得大的问题)</li><li>DSL Domain测试语言</li><li>FIRST: Fast/Independent/Repeatable/Self-Validating/Timely</li></ul></li><li><p>类</p><ul><li>短小，SRP</li><li>接口隔离/隔离修改</li><li>DIP</li></ul></li><li><p>系统</p><ul><li>DIP</li><li>工厂方法</li><li>scale out</li><li>JDK代理/Proxy invocation handler/AOP/AspectJ</li></ul></li><li><p>迭代</p><ul><li>Run all the tests</li><li>Refactor</li></ul></li><li><p>Concurrence</p><ul><li>并发防御： SRP，Immutable Data,数据副本</li><li>ReentrantLock/Sempaphore/CoundDownLatch</li><li>执行模型</li></ul><p>|互斥|每一个时刻只有一个线程访问共享数据和资源|<br>|线程饥饿|比如总是执行快的线程执行|<br>|死锁|两个或者多个线程相互等待|<br>|活锁|执行次序一致的线程|</p><ul><li>producer-consumer</li><li>reader-writer</li><li>保持同步区域微小</li><li>关闭资源</li><li>测试线程代码/注意偶发时间(design for failure)</li><li>多平台/多处理器</li><li>stub codes/yield??</li></ul></li><li><p>逐步改进</p><ul><li>work first</li><li>一步一步Refactor，from one big method to well-orgainized</li><li>unit testing for refactor</li></ul></li><li><p>味道和启发，需要细读</p><ul><li>移除不必要的注释</li><li>函数参数不要过多，移除没有使用的函数</li><li>extract重复代码</li><li>测试不足，使用覆盖率工具，忽律的测试是不确定的，边界条件</li><li>缺陷扎堆</li></ul></li></ul><h2 id="The-Art-of-Readable-Code"><a href="#The-Art-of-Readable-Code" class="headerlink" title="The Art of Readable Code"></a>The Art of Readable Code</h2><h3 id="表面层次的改进"><a href="#表面层次的改进" class="headerlink" title="表面层次的改进"></a>表面层次的改进</h3><ul><li>naming，变量，函数，参数，类，包命名，有意义不含糊，特定，和业务领域命名一致</li><li>注释，简单，实例，描述为什么这样的理由，todo，站在读者的立场</li></ul><h3 id="简化循环和逻辑"><a href="#简化循环和逻辑" class="headerlink" title="简化循环和逻辑"></a>简化循环和逻辑</h3><ul><li>if/esle的考量，正逻辑还是负逻辑更好理解</li><li>避免do/while</li><li>提前返回</li><li>最小嵌套</li><li>拆分巨大的语句</li><li>变量命名，缩小变量作用域</li></ul><h3 id="重新组织代码"><a href="#重新组织代码" class="headerlink" title="重新组织代码"></a>重新组织代码</h3><ul><li>抽取不想关的子逻到工具类或者其他相关领域</li><li>小函数也不需要太多</li><li>一次只做一件事情，通过组合函数或者类来解决大问题</li></ul><h3 id="想法变成代码"><a href="#想法变成代码" class="headerlink" title="想法变成代码"></a>想法变成代码</h3><p>使用自然语言程序描述功能，描述解决问题的流程</p><h2 id="少些代码"><a href="#少些代码" class="headerlink" title="少些代码"></a>少些代码</h2><ul><li>少量代码解决最重要的问题，介绍需求</li><li>使用现有工具，unix tools/现有代码</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat *.log | awk `&#123;print $5 &quot; &quot; $7&#125;` | egrep &quot;[45]..$&quot; \</span><br><span class="line">| sort | uniq -c | sort -nr</span><br></pre></td></tr></table></figure><h2 id="精选话题"><a href="#精选话题" class="headerlink" title="精选话题"></a>精选话题</h2><ul><li>测试可读性</li><li>详细的错误信息</li><li>测试函数命名</li><li>可测性衡量-Hard<ul><li>全局变量</li><li>外部组件大量依赖代码</li><li>代码不确定行为</li></ul></li><li>可测性衡量-好<ul><li>内部状态很少</li><li>类函数只做一件事情</li><li>依赖很少，可管理</li><li>函数接口简单</li></ul></li><li>测试代码需要描述清楚测试的功能，高层定义越简单越好</li></ul><h3 id="深入阅读推荐"><a href="#深入阅读推荐" class="headerlink" title="深入阅读推荐"></a>深入阅读推荐</h3><ul><li>Code Complete</li><li>Refactoring</li><li>The Pragmatic Programer</li><li>Javascript - The Good Parts</li><li>Effective Java</li><li>Design-Pattern: Elements of Reusable Object-Oriented Software</li><li>Programming Pearls</li><li><a href="http://www.joeonsoftware.com" target="_blank" rel="noopener">Joel on Software</a></li><li>Donald E.Knuth books </li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How To Read A Thread Dump</title>
      <link href="/2018/06/29/how-to-read-a-thread-dump/"/>
      <url>/2018/06/29/how-to-read-a-thread-dump/</url>
      
        <content type="html"><![CDATA[<h1 id="How-To-Read-A-Thread-Dump"><a href="#How-To-Read-A-Thread-Dump" class="headerlink" title="How To Read A Thread Dump"></a>How To Read A Thread Dump</h1><ul><li>Thread Terminology</li></ul><h2 id="Thread-Terminology"><a href="#Thread-Terminology" class="headerlink" title="Thread Terminology"></a>Thread Terminology</h2><ul><li><p>Thread/daemon Thread,</p><ul><li>thread is discrete unit of concurrency managed by JVM</li><li>daemon thread: runs independent of other threads, killed when Runtime.exit</li></ul></li><li><p>Different state Threads</p><ul><li>Alive thread - A running thread taht is performance some work</li><li>Blocked thread - attempt to enter synchronized block blocked by another thread</li><li>Waiting Thread - waiting for another thread to call</li><li>Sleep Thread - not executing because sleep is called</li></ul></li><li><p>Monitor</p><ul><li><a href="https://docs.oracle.com/javase/specs/jls/se10/html/jls-17.html#jls-17.1" target="_blank" rel="noopener">reference</a></li></ul></li><li><p>Deadlock</p><ul><li><a href="https://en.wikipedia.org/wiki/Dining_philosophers_problem" target="_blank" rel="noopener">reference</a><br><img src="https://dzone.com/storage/temp/9523858-deadlock-definition.png" alt="img"><br><img src="https://dzone.com/storage/temp/9523858-deadlock-definition.png" alt="img"></li></ul><ul><li>Livelock</li></ul><ul><li>Thread A performs and action that causes thread B to perform an action</li><li>Thread A still alive</li><li><a href="https://docs.oracle.com/javase/specs/jls/se10/html/jls-17.html" target="_blank" rel="noopener">Reference</a></li></ul></li><li><p>some ref:</p><ul><li><a href="https://dzone.com/articles/how-to-read-a-thread-dump" target="_blank" rel="noopener">reference</a></li><li><a href="https://dzone.com/articles/how-analyze-java-thread-dumps" target="_blank" rel="noopener">r2</a></li></ul></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ThreadDump </tag>
            
            <tag> Performance </tag>
            
            <tag> Tip </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MAVEN In 30 Minutes</title>
      <link href="/2018/06/09/0-maven-in-30-minutes/"/>
      <url>/2018/06/09/0-maven-in-30-minutes/</url>
      
        <content type="html"><![CDATA[<h2 id="1-MAVEN-Projects"><a href="#1-MAVEN-Projects" class="headerlink" title="1- MAVEN Projects"></a>1- MAVEN Projects</h2><ul><li>use pom.xml to describe the project dependencies,such as third party jars used</li><li>use pom.xml to describe the build process,such as using build plugin to achieve specific building process</li><li>use pom.xml to manage multiple projects/modules, modules are in pom.xml, modules section</li><li>a lot other stuff……</li></ul><h2 id="2-MAVEN-Artifact-Vector"><a href="#2-MAVEN-Artifact-Vector" class="headerlink" title="2- MAVEN Artifact Vector"></a>2- MAVEN Artifact Vector</h2><p>MAVEN Project produces an element, JAR,WAR or EAR, uniquely identified by a composite of fields known as groupId,artificatId,packing,version and scope. This vector of fields uniquely distinguishes a MAVEN artifact from all others.</p><p>the samples as follow:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groupid:artifactid:packaging:version:scope</span><br><span class="line">org.springframework:spring:jar:4.3.2:compile</span><br></pre></td></tr></table></figure><h2 id="3-MAVEN-Lifecycles"><a href="#3-MAVEN-Lifecycles" class="headerlink" title="3- MAVEN Lifecycles"></a>3- MAVEN Lifecycles</h2><p>Phases,Plugins and Goals</p><p><img src="/images/cicd/maven_lifecycle.jpg" alt="img"></p><ul><li>Build-in Maven Default Lifecycles:</li></ul><p><img src="/images/cicd/maven_default_cl_1.jpg" alt="img"><br><img src="/images/cicd/maven_default_cl_2.jpg" alt="img"></p><ul><li>Site lifecycle</li></ul><p><img src="/images/cicd/maven_cl_site.jpg" alt="img"></p><h2 id="4-Maven-Help"><a href="#4-Maven-Help" class="headerlink" title="4- Maven Help"></a>4- Maven Help</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">help</span>: describe -Dplugin=&lt;plugnName&gt;</span><br><span class="line">mvn <span class="built_in">help</span>:effective-pom</span><br><span class="line">mvn <span class="built_in">help</span>:active-profiles</span><br></pre></td></tr></table></figure><h2 id="5-MAVEN-Dependency"><a href="#5-MAVEN-Dependency" class="headerlink" title="5- MAVEN Dependency"></a>5- MAVEN Dependency</h2><ul><li>declaring dependencies</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.yourcompany<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>yourlib<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="tag">&lt;<span class="name">type</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">type</span>&gt;</span> <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>declaring plugins</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">plugin</span>&gt;</span> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxmem</span>&gt;</span>512m<span class="tag">&lt;/<span class="name">maxmem</span>&gt;</span> <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-Maven-Scope"><a href="#6-Maven-Scope" class="headerlink" title="6- Maven Scope"></a>6- Maven Scope</h2><p>scope in dependency:</p><p><img src="/images/cicd/maven_scope.jpg" alt="img"></p><h2 id="7-Learning-Dependencies"><a href="#7-Learning-Dependencies" class="headerlink" title="7- Learning Dependencies"></a>7- Learning Dependencies</h2><p>To Understand the dependencies for whole project,you can use following commands:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mvn dependency:tree</span><br><span class="line">mvn dependency:resolve  <span class="comment">## sorted</span></span><br><span class="line">mvn dependency:resolve-plugins</span><br><span class="line">mvn dependency:analyze</span><br></pre></td></tr></table></figure><h2 id="8-Declaring-Repository"><a href="#8-Declaring-Repository" class="headerlink" title="8- Declaring Repository"></a>8- Declaring Repository</h2><p>Repository is somewhere you can get the jars/wars</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>JavaDotNetRepo<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven-repository.dev.java.net<span class="tag">&lt;/<span class="name">url</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="9-Maven-Properties"><a href="#9-Maven-Properties" class="headerlink" title="9- Maven Properties"></a>9- Maven Properties</h2><ul><li><p>Prefefined Properties<br><img src="/images/cicd/maven_predefined_prop.jpg" alt="img"></p></li><li><p>self defined properties</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">my.somevar</span>&gt;</span>My Value<span class="tag">&lt;/<span class="name">my.somevar</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="10-Maven-Debug"><a href="#10-Maven-Debug" class="headerlink" title="10- Maven Debug"></a>10- Maven Debug</h2><p>commands for debug:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mvn -e <span class="comment"># stacktrace</span></span><br><span class="line">mvn -X <span class="comment">#</span></span><br><span class="line">mvnDebug &lt;projectName&gt;</span><br></pre></td></tr></table></figure><h2 id="11-Maven-Profile-activation"><a href="#11-Maven-Profile-activation" class="headerlink" title="11- Maven Profile activation"></a>11- Maven Profile activation</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -P profileName</span><br></pre></td></tr></table></figure><p>profile setting:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>YourProfile<span class="tag">&lt;/<span class="name">id</span>&gt;</span> [...settings, build, etc...] </span><br><span class="line">        <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">os</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>Windows XP<span class="tag">&lt;/<span class="name">name</span>&gt;</span> <span class="tag">&lt;<span class="name">family</span>&gt;</span>Windows<span class="tag">&lt;/<span class="name">family</span>&gt;</span> <span class="tag">&lt;<span class="name">arch</span>&gt;</span>x86<span class="tag">&lt;/<span class="name">arch</span>&gt;</span> <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.2600<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">os</span>&gt;</span> <span class="tag">&lt;<span class="name">file</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">missing</span>&gt;</span>somefolder/somefile.txt<span class="tag">&lt;/<span class="name">missing</span>&gt;</span> <span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activation</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure><p>##12- Maven Release</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mvn release: repare</span><br><span class="line">mvn release: perform</span><br></pre></td></tr></table></figure><h2 id="13-Maven-Reports"><a href="#13-Maven-Reports" class="headerlink" title="13- Maven Reports"></a>13- Maven Reports</h2><p>reports defined in reporting section, these reports could be coverage report, and any other reports.</p>]]></content>
      
      
      
        <tags>
            
            <tag> MAVEN </tag>
            
            <tag> CI/CD </tag>
            
            <tag> Project Setup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Word Frequency - Use JDK Methods</title>
      <link href="/2018/06/08/0-word-frequency/"/>
      <url>/2018/06/08/0-word-frequency/</url>
      
        <content type="html"><![CDATA[<h2 id="What-is-the-problem"><a href="#What-is-the-problem" class="headerlink" title="What is the problem"></a>What is the problem</h2><p>Be confidence to the JDK, in most case, it is enough to solve problem. Here is a case, an issue to solve:</p><ul><li>There are over 10000 files in a dir</li><li>Try to find out the top 100 most frequency words in these files, estimate 10 millions words out there</li><li>Try to use </li></ul><p>I didn’t sovle it in 40 mintues, the failure part is just think too much about the data structure and algorithm. I just did some investigation then, and find out actually JDK methods are enough.</p><p>Here is my thought, and I think need to implement my own algorithm to solve, actually I am wrong, JDK is enough</p><ul><li>Read the files</li><li>Put word and count to a concurrent map</li><li>get the top 100 from the map</li></ul><p>Because I am a fraid the memory and other resource issue, but later I had my try, it looks like worked if only use JDK methods. Here comes my solution.</p><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>First of all, I try to create 10000 files with some random string(word),all strings are less than 18 characters, the codes are :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> String <span class="title">getSaltString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String SALTCHARS = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890"</span>;</span><br><span class="line">    StringBuilder salt = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    Random rnd = <span class="keyword">new</span> Random();</span><br><span class="line">    <span class="keyword">int</span> strLength = rnd.nextInt(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">if</span>(strLength&lt;=<span class="number">2</span>)&#123;</span><br><span class="line">      strLength =<span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (salt.length() &lt; strLength) &#123; <span class="comment">// length of the random string.</span></span><br><span class="line">      <span class="keyword">int</span> index = (<span class="keyword">int</span>) (rnd.nextFloat() * SALTCHARS.length());</span><br><span class="line">      salt.append(SALTCHARS.charAt(index));</span><br><span class="line">    &#125;</span><br><span class="line">    String saltStr = salt.toString();</span><br><span class="line">    <span class="keyword">return</span> saltStr;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">createRandomFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;String&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">      List&lt;String&gt; listString = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">50</span>; j++) &#123;</span><br><span class="line"></span><br><span class="line">        listString.add(getSaltString());</span><br><span class="line">      &#125;</span><br><span class="line">      StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">      <span class="keyword">for</span> (String s : listString) &#123;</span><br><span class="line">        sb.append(<span class="string">" "</span>).append(s);</span><br><span class="line">      &#125;</span><br><span class="line">      result.add(sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createFile</span><span class="params">(<span class="keyword">int</span> i, List&lt;String&gt; values)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    Files.write(Paths.get(<span class="string">"tmp/"</span> + i), values);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createFiles</span><span class="params">(<span class="keyword">int</span> fileNum)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNum; i++) &#123;</span><br><span class="line">      createFile(i, createRandomFile());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>then I tried use to read files and put words into frequency map,and here multiple threads are used</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readAndPutTo</span><span class="params">(Path path)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    List&lt;String&gt; lines = Files.readAllLines(path);</span><br><span class="line">    <span class="keyword">for</span> (String line : lines) &#123;</span><br><span class="line">      String[] words = line.split(<span class="string">"\\s+"</span>);</span><br><span class="line">      <span class="keyword">for</span> (String word : words) &#123;</span><br><span class="line">        frenquncyMap.put(word, frenquncyMap.getOrDefault(word, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(args[])</span></span>&#123;</span><br><span class="line">ExecutorService es = Executors.newFixedThreadPool(<span class="number">30</span>);</span><br><span class="line">    System.out.println(Files.list(Paths.get(<span class="string">"tmp"</span>)).count());</span><br><span class="line">    Files.list(Paths.get(<span class="string">"tmp"</span>)).forEach(</span><br><span class="line">        path -&gt; &#123;</span><br><span class="line">          count.getAndIncrement();</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            readAndPutTo(path);</span><br><span class="line">          &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">    System.out.println(<span class="string">"completed tasks: "</span>+count);</span><br><span class="line">    <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">    System.out.println(end - start);</span><br><span class="line">    es.shutdown();</span><br><span class="line">    System.out.println(es.awaitTermination(<span class="number">120</span>, TimeUnit.SECONDS);</span><br><span class="line">    System.out.println(System.currentTimeMillis() - start);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Use shutdown() to make sure every tasks are completed, and print the task count to check if all tasks had be invoked.</p><p>At last use stream api to list top 100 work frequency.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List result = frenquncyMap.entrySet().stream()</span><br><span class="line">    .sorted(Map.Entry.comparingByValue())</span><br><span class="line">    .limit(<span class="number">100</span>).collect(Collectors.toList());</span><br><span class="line">System.out.println(result);</span><br><span class="line">System.out.println(System.currentTimeMillis() - start);</span><br><span class="line"></span><br><span class="line">Files.delete(Paths.get(<span class="string">"tmp/"</span>));</span><br><span class="line">Files.createDirectories(Paths.get(<span class="string">"tmp/"</span>));</span><br></pre></td></tr></table></figure><p>That’s it, let’s run and see what happened:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Later I willl jump into JDK, to understand what the algorithm used in JDK. </p>]]></content>
      
      
      
        <tags>
            
            <tag> interview </tag>
            
            <tag> word_frequency </tag>
            
            <tag> algorithm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>font-tips</title>
      <link href="/2018/05/20/font-tips_May/"/>
      <url>/2018/05/20/font-tips_May/</url>
      
        <content type="html"><![CDATA[<p>Tips Here for change api.googlefont like site to an avaible site.</p><h2 id="For-Font"><a href="#For-Font" class="headerlink" title="For Font"></a>For Font</h2><ul><li><a href="https://fonts.lug.ustc.edu.cn/" target="_blank" rel="noopener">https://fonts.lug.ustc.edu.cn/</a></li><li><a href="https://fonts.css.network/" target="_blank" rel="noopener">https://fonts.css.network/</a></li></ul><h2 id="Other-FrontEnd-Resources"><a href="#Other-FrontEnd-Resources" class="headerlink" title="Other FrontEnd Resources"></a>Other FrontEnd Resources</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">常用前端公共库</span><br><span class="line">https:<span class="comment">//cdn.css.net/ </span></span><br><span class="line"></span><br><span class="line">Google 公共库</span><br><span class="line">https:<span class="comment">//ajax.css.network/ </span></span><br><span class="line"></span><br><span class="line">Gravatar</span><br><span class="line">https:<span class="comment">//gravatar.css.network/ </span></span><br><span class="line"></span><br><span class="line">Google 字体库</span><br><span class="line">https:<span class="comment">//fonts.css.network/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> tips </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
