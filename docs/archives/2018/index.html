<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>Archives: 2018 | DIRTY HANDS QA</title>
  
  <meta name="keywords" content="Automation Testing,Performance Testing,Agile,Testing Tool Usage">
  
  
  <meta name="description" content="Learning, Practice,And Never minded">
  

  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  
  
  <meta name="theme-color" content="#FFFFFF">
  <meta name="msapplication-TileColor" content="#1BC3FB">
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css">
  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.5/css/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  
  <div class="cover-wrapper">
    <cover class='cover  half'>
      
        
  <h1 class='title'>Material X</h1>


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <input type="text" class="input u-search-input" placeholder="" />
      <i class="icon fas fa-search fa-fw"></i>
    </form>
  </div>

<div class='menu navgation'>
  <ul class='h-list'>
    
      
        <li>
          <a class="nav home" href="/"
            
            
            id="home">
            <i class='fas fa-rss fa-fw'></i>&nbsp;博文
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/projects/"
            
            
            id="projects">
            <i class='fas fa-code-branch fa-fw'></i>&nbsp;项目
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/friends/"
            
              rel="nofollow"
            
            
            id="friends">
            <i class='fas fa-link fa-fw'></i>&nbsp;友链
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/about/"
            
              rel="nofollow"
            
            
            id="about">
            <i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header material">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="material"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href='/' >
        
          DIRTY HANDS QA
        
      </a>
			<div class='menu navgation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/"
                  
                  
                  id="home">
									<i class='fas fa-grin fa-fw'></i>&nbsp;示例
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/categories/"
                  
                    rel="nofollow"
                  
                  
                  id="blogcategories">
									<i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/tags/"
                  
                    rel="nofollow"
                  
                  
                  id="blogtags">
									<i class='fas fa-hashtag fa-fw'></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/archives/"
                  
                    rel="nofollow"
                  
                  
                  id="blogarchives">
									<i class='fas fa-archive fa-fw'></i>&nbsp;归档
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索" />
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/"
                
                
                id="home">
								<i class='fas fa-clock fa-fw'></i>&nbsp;近期文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blog/archives/"
                
                  rel="nofollow"
                
                
                id="blogarchives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;文章归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/projects/"
                
                
                id="projects">
								<i class='fas fa-code-branch fa-fw'></i>&nbsp;开源项目
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/friends/"
                
                  rel="nofollow"
                
                
                id="friends">
								<i class='fas fa-link fa-fw'></i>&nbsp;我的友链
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="https://xaoxuu.com/wiki/material-x/"
                
                  rel="nofollow"
                
                
                id="https:xaoxuu.comwikimaterial-x">
								<i class='fas fa-book fa-fw'></i>&nbsp;主题文档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/"
                
                  rel="nofollow"
                
                
                id="about">
								<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于小站
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      <div class='l_main'>
	
		
  <section class="post-list">
    
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
    
    
      
        
          <div class='post-wrapper'>
            <article class="post reveal ">
  


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  <h2 class="title">
    <a href="/2018/12/24/yuml-usage/">
      YUML Basic Usage
    </a>
  </h2>


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http:" rel="nofollow">
      
        <img src="https://avatars0.githubusercontent.com/u/21341419?s=460&v=4">
      
      <p>dh-qa</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2018-12-24</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      <h1 id="YUML-Syntax"><a href="#YUML-Syntax" class="headerlink" title="YUML Syntax"></a>YUML Syntax</h1><ul>
<li>comments and directives</li>
<li>class diagram</li>
</ul>
<h2 id="Comments-and-Directives"><a href="#Comments-and-Directives" class="headerlink" title="Comments and Directives"></a>Comments and Directives</h2><ul>
<li>type: //{type:class}</li>
<li>direction: // {direction:leftToRight}</li>
<li>generate: // {generate:true}</li>
</ul>
<h2 id="Class-diagram"><a href="#Class-diagram" class="headerlink" title="Class diagram"></a>Class diagram</h2><p>cheetsheet for class diagram</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Class         [Customer]</span><br><span class="line">Directional   [Customer]-&gt;[Order]</span><br><span class="line">Bidirectional [Customer]&lt;-&gt;[Order]</span><br><span class="line">Aggregation   [Customer]+-[Order] or [Customer]&lt;&gt;-[Order]</span><br><span class="line">Composition   [Customer]++-[Order]</span><br><span class="line">Inheritance   [Customer]^[Cool Customer], [Customer]^[Uncool Customer]</span><br><span class="line">Dependencies  [Customer]uses-.-&gt;[PaymentStrategy]</span><br><span class="line">Cardinality   [Customer]&lt;1-1..2&gt;[Address]</span><br><span class="line">Labels        [Person]customer-billingAddress[Address]</span><br><span class="line">Notes         [Address]-[note: Value Object]</span><br><span class="line">Full Class    [Customer|Forename;Surname;Email|Save()]</span><br><span class="line">Color splash  [Customer&#123;<span class="built_in">bg</span>:orange&#125;]&lt;&gt;1-&gt;*[Order&#123;<span class="built_in">bg</span>:green&#125;]</span><br></pre></td></tr></table></figure>

<h2 id="Association-classes"><a href="#Association-classes" class="headerlink" title="Association classes"></a>Association classes</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Invoice]&lt;*-*&gt;[Products][Invoice Item]</span><br></pre></td></tr></table></figure>

<h2 id="Use-cases-diagram"><a href="#Use-cases-diagram" class="headerlink" title="Use-cases diagram"></a>Use-cases diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Use Case           (Login)</span><br><span class="line">Actor              [Customer]</span><br><span class="line">&lt;&lt;Extend&gt;&gt;         (Login)&lt;(Forgot Password)</span><br><span class="line">&lt;&lt;Include&gt;&gt;        (Register)&gt;(Confirm Email)</span><br><span class="line">Actor Inheritance  [Admin]^[User]</span><br><span class="line">Note	           [Admin]-(note: Most privilidged user)</span><br></pre></td></tr></table></figure>

<h2 id="Activity-diagram"><a href="#Activity-diagram" class="headerlink" title="Activity diagram"></a>Activity diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Start	           (start)</span><br><span class="line">End                (end)</span><br><span class="line">Activity           (Find Products)</span><br><span class="line">Flow	           (start)-&gt;(Find Products)</span><br><span class="line">Multiple Assoc.    (start)-&gt;(Find Products)-&gt;(end)</span><br><span class="line">Decisions          (start)-&gt;&lt;d1&gt;</span><br><span class="line">Decisions w/Label  (start)-&gt;&lt;d1&gt;logged <span class="keyword">in</span>-&gt;(Show Dashboard)   and   &lt;d1&gt;not logged <span class="keyword">in</span>-&gt;(Show Login Page)</span><br><span class="line">Parallel           (Action 1)-&gt;|a|   and   (Action 2)-&gt;|a|</span><br></pre></td></tr></table></figure>

<h2 id="State-diagram"><a href="#State-diagram" class="headerlink" title="State diagram"></a>State diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Start	         (start)</span><br><span class="line">End              (end)</span><br><span class="line">Activity         (Find Products)</span><br><span class="line">Flow	         (start)-&gt;(Find Products)</span><br><span class="line">Multiple Assoc.  (start)-&gt;(Find Products)-&gt;(end)</span><br><span class="line">Complex <span class="keyword">case</span>     (Simulator running)[Pause]-&gt;(Simulator paused|<span class="keyword">do</span>/<span class="built_in">wait</span>)[Unpause]-&gt;(Simulator running)</span><br><span class="line">Note             (state)-(note: a note here)</span><br></pre></td></tr></table></figure>

<h2 id="Deployment-diagram"><a href="#Deployment-diagram" class="headerlink" title="Deployment diagram"></a>Deployment diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Node           [node1]</span><br><span class="line">Association    [node1]-[node2]</span><br><span class="line">Labeled Assoc. [node1]label-[node2]</span><br><span class="line">Note           [node1]-[note: a note here]</span><br></pre></td></tr></table></figure>

<h2 id="Sequence-diagram"><a href="#Sequence-diagram" class="headerlink" title="Sequence diagram"></a>Sequence diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Object       [Patron]</span><br><span class="line">Message      [Patron]order food&gt;[Waiter]</span><br><span class="line">Response     [Waiter]serve wine.&gt;[Patron]</span><br><span class="line">Note         [Actor]-[note: a note message]</span><br><span class="line">Asynchronous [Patron]order food&gt;&gt;[Waiter]</span><br></pre></td></tr></table></figure>

<h2 id="Package-diagram"><a href="#Package-diagram" class="headerlink" title="Package diagram"></a>Package diagram</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Package        [package1]</span><br><span class="line">Association    [package1]-&gt;[package2]</span><br><span class="line">Labeled assoc  [package1]label-&gt;[package2]</span><br><span class="line">Note           [package1]-[note: a note here]</span><br><span class="line"></span><br><span class="line">`</span><br></pre></td></tr></table></figure>

<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><ul>
<li>Color codes: form #RRGGBB, X11 color coding</li>
<li>checkout <a href="http://yuml.me" target="_blank" rel="noopener">yuml.me</a></li>
</ul>
<h2 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h2><p><a href="https://github.com/jaime-olivares/yuml-diagram" target="_blank" rel="noopener">yuml-diagram</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install yuml-diagram</span><br></pre></td></tr></table></figure>


      
    </div>
    
      <div class="full-width auto-padding tags">
        
          <a href="/tags/tips/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>tips</a>
        
      </div>
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post reveal ">
  


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  <h2 class="title">
    <a href="/2018/11/21/frp-usage/">
      内网穿透方案 - frp
    </a>
  </h2>


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http:" rel="nofollow">
      
        <img src="https://avatars0.githubusercontent.com/u/21341419?s=460&v=4">
      
      <p>dh-qa</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2018-11-21</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      <p><a href="https://github.com/fatedier/frp" target="_blank" rel="noopener">frp</a> 使用golang编写的，下面几个例子来说明一下如何使用frp.</p>
<ul>
<li><a href="https://github.com/fatedier" target="_blank" rel="noopener">todo</a></li>
<li><a href="https://haofly.net" target="_blank" rel="noopener">reference</a></li>
</ul>

      
    </div>
    
      <div class="full-width auto-padding tags">
        
          <a href="/tags/tips/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>tips</a>
        
          <a href="/tags/ops/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>ops</a>
        
      </div>
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post reveal ">
  


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  <h2 class="title">
    <a href="/2018/11/20/think-twice/">
      似是而非
    </a>
  </h2>


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http:" rel="nofollow">
      
        <img src="https://avatars0.githubusercontent.com/u/21341419?s=460&v=4">
      
      <p>dh-qa</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2018-11-20</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      <p>很很多似是而非的问题，信息现在是爆炸，而不是太少。所以多思考，而不是不停的道听途说对自身更有意义。有些听上去很多的东西可能也是需要自己多想，多想其实简单来说就是要多方面考虑，要站在其他的角度考虑问题。</p>
<p>比如我们常说我们要问为什么，但是为什么不个人的答案可能都是不一样呀，为什么可能是为什么这么做，为什么要做，但是最基本最基本的问题应该是目的是什么，很多为什么马上牵扯到很多很专业的事前，但是目的应该是所有人都懂得，而专业内容实际上不是每个人都能懂得，如果你想知道目的是什么，但是别人告诉了你很多你听不懂的东西，那么这里面一定有GAP，一定哪里有问题没有被解决。同样如果已经进入到专业领域你听不懂，那么自己就需要补课了。</p>
<p>另外一点问为什么的时候，也要对自己进行反思，自己真的有能力去问这个为什么吗？有能力理解这里面的目的吗，如果不能，那么回去看书或者请教其他人了。</p>
<h2 id="很多很丰富的鸡汤"><a href="#很多很丰富的鸡汤" class="headerlink" title="很多很丰富的鸡汤"></a>很多很丰富的鸡汤</h2><p>鸡汤为什么好听，因为能给你共鸣，同时比较能调动你的情绪，很容易有代入感，但是需要警惕的事，鸡汤不能帮你完成任何一件事情，它只是更容易让你上瘾，让你觉得在讨论宏大的问题，然而其实没几个人有能力讨论宏大问题。</p>
<p>鸡汤本身没有问题，但是如果觉得多喝了一点就有自己进步了，那么这个就是犯的大错；真正有价值的东西大体可以通过钱或者其他东西来衡量的，也就是交换价值；鸡汤有吗？鸡汤帮不了你.如果鸡汤是道，把事情做出来可以是术，但是大部分人应该是通过术来理解，推导出道来；如果只是被动接受那些道，那么你接受的本省就不是道，</p>

      
    </div>
    
      <div class="full-width auto-padding tags">
        
          <a href="/tags/thoughts/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>thoughts</a>
        
      </div>
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post reveal ">
  


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  <h2 class="title">
    <a href="/2018/09/13/ansible-module-1/">
      学习ansible module-1
    </a>
  </h2>


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http:" rel="nofollow">
      
        <img src="https://avatars0.githubusercontent.com/u/21341419?s=460&v=4">
      
      <p>dh-qa</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2018-09-13</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      <p>写一个Ansbile Module实际上非常容易，我从看</p>
<figure class="highlight plain"><figcaption><span>这个源码的方式大概可以了解Ansible的一个简单的</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">插件.</span><br><span class="line"></span><br><span class="line">下面分几个内容来看：</span><br><span class="line"></span><br><span class="line">- 插件运行代码</span><br><span class="line">- 插件的meta的数据</span><br><span class="line"></span><br><span class="line">## Ansible 插件代码</span><br><span class="line"></span><br><span class="line">- 首先Ansible 插件的入口函数为main函数</span><br><span class="line"></span><br><span class="line">所以先定义一个main函数，以及main函数的运行</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">def main():</span><br><span class="line">  pass</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<ul>
<li>实现main函数</li>
</ul>
<p>主要步骤是：</p>
<ul>
<li>module定义，Ansible的module，定义这个AnsibleModule的argument_spec,这个里面用来声明这个插件使用的参数</li>
<li>module.params，ansible的输入为task的yml文件，这里面定义的内容都会传递到这个params中</li>
<li>然后根据不同的state的值去调用不同的任务，所有不同的任务的参数都是module，module用来传递了运行时的上下文</li>
<li>实现不同state对应的任务</li>
<li>基本上就结束了一个Ansible插件了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">module = AnsibleModule(</span><br><span class="line">    argument_spec=dict(</span><br><span class="line">        role=dict(choices=[<span class="string">'standalone'</span>, <span class="string">'hub'</span>, <span class="string">'node'</span>], default=<span class="string">'standalone'</span>),</span><br><span class="line">        state=dict(choices=[<span class="string">'running'</span>, <span class="string">'stopped'</span>, <span class="string">'restarted'</span>], default=<span class="string">'running'</span>),</span><br><span class="line">        version=dict(default=<span class="string">'2.53.0'</span>),</span><br><span class="line">        path=dict(default=<span class="string">'.'</span>),</span><br><span class="line">        force=dict(default=<span class="literal">False</span>, type=<span class="string">'bool'</span>),</span><br><span class="line">        args=dict(required=<span class="literal">False</span>, default=<span class="string">''</span>),</span><br><span class="line">        java=dict(required=<span class="literal">False</span>, default=<span class="string">'/usr/bin/java'</span>),</span><br><span class="line">        logfile=dict(required=<span class="literal">False</span>, default=<span class="string">'./selenium.log'</span>),</span><br><span class="line">        javaargs=dict(required=<span class="literal">False</span>, default=[], type=<span class="string">'list'</span>),</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    supports_check_mode=<span class="literal">False</span>,</span><br><span class="line"></span><br><span class="line">    mutually_exclusive=[]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">state = module.params[<span class="string">'state'</span>]</span><br><span class="line">role = module.params[<span class="string">'role'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> state == <span class="string">'running'</span>:</span><br><span class="line">    (changed, pid) = start(module)</span><br><span class="line">    finish(module, msg=<span class="string">'%s is running'</span> % role, changed=changed, pid=pid)</span><br><span class="line"><span class="keyword">elif</span> state == <span class="string">'stopped'</span>:</span><br><span class="line">    changed = stop(module)</span><br><span class="line">    finish(module, msg=<span class="string">'%s is stopped'</span> % role, changed=changed)</span><br><span class="line"><span class="keyword">elif</span> state == <span class="string">'restarted'</span>:</span><br><span class="line">    (changed, pid) = restart(module)</span><br><span class="line">    finish(module, msg=<span class="string">'%s has restarted'</span> % role, changed=changed, pid=pid)</span><br></pre></td></tr></table></figure>

<p>start 任务的一个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">(module)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Start the Selenium standalone</span></span><br><span class="line"><span class="string">    :param module:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    _, jar_file = download(module)</span><br><span class="line"></span><br><span class="line">    changed = <span class="literal">False</span></span><br><span class="line">    role = module.params[<span class="string">'role'</span>]</span><br><span class="line">    <span class="keyword">if</span> role != <span class="string">'standalone'</span>:</span><br><span class="line">      role = <span class="string">"-role %s"</span> % role</span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">      role = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_running(module): <span class="comment"># in another implementation</span></span><br><span class="line">        changed = <span class="literal">True</span></span><br><span class="line">        args = <span class="string">''</span></span><br><span class="line">        java_args = <span class="string">''</span></span><br><span class="line">        <span class="keyword">if</span> module.params[<span class="string">'args'</span>]:</span><br><span class="line">            <span class="keyword">for</span> (k, v) <span class="keyword">in</span> module.params[<span class="string">'args'</span>].iteritems():</span><br><span class="line">                args += <span class="string">'-%s=%s '</span> % (k, v)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> module.params[<span class="string">'javaargs'</span>]:</span><br><span class="line">            <span class="keyword">for</span> arg <span class="keyword">in</span> module.params[<span class="string">'javaargs'</span>]:</span><br><span class="line">                java_args += <span class="string">'-%s '</span> % arg</span><br><span class="line"></span><br><span class="line">        java_executable = os.path.abspath(os.path.expandvars(module.params[<span class="string">'java'</span>]))</span><br><span class="line">        log_file = os.path.abspath(os.path.expandvars(module.params[<span class="string">'logfile'</span>]))</span><br><span class="line"></span><br><span class="line">        cmd = <span class="string">"%s %s -jar %s %s %s &gt;&gt; %s 2&gt;&amp;1 &amp;"</span> % (java_executable,</span><br><span class="line">                                                          java_args,</span><br><span class="line">                                                          jar_file,</span><br><span class="line">                                                          role,</span><br><span class="line">                                                          args,</span><br><span class="line">                                                          log_file)</span><br><span class="line"></span><br><span class="line">        os.setsid()</span><br><span class="line"></span><br><span class="line">        <span class="comment">#print cmd</span></span><br><span class="line">        rc = os.system(cmd)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> rc != <span class="number">0</span>:</span><br><span class="line">            abort(module, <span class="string">'Running the %s role returned code %s !'</span> % (role, rc))</span><br><span class="line"></span><br><span class="line">    pid = get_pid(module)</span><br><span class="line">    <span class="keyword">if</span> pid:</span><br><span class="line">        <span class="keyword">return</span> changed, pid</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        abort(module, <span class="string">'Couldnt fetch the pid of the running %s ! It may have ended abruptly.'</span> % module.params[<span class="string">'role'</span>])</span><br></pre></td></tr></table></figure>

<h2 id="Meta-插件的meta的数据"><a href="#Meta-插件的meta的数据" class="headerlink" title="Meta 插件的meta的数据"></a>Meta 插件的meta的数据</h2><p>meta信息一般存放在meta目录中，具体写的方式参考源码:<br><code>https://github.com/SeleniumHQ/ansible-selenium.git</code></p>
<h2 id="Ansible-MindMap"><a href="#Ansible-MindMap" class="headerlink" title="Ansible MindMap"></a>Ansible MindMap</h2><p><img src="images/Ansible.png" alt="img"></p>

      
    </div>
    
      <div class="full-width auto-padding tags">
        
          <a href="/tags/ansible/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>ansible</a>
        
          <a href="/tags/CICD/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>CICD</a>
        
      </div>
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post reveal ">
  


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  <h2 class="title">
    <a href="/2018/09/12/conda-cheetsheet/">
      conda-cheatsheet
    </a>
  </h2>


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http:" rel="nofollow">
      
        <img src="https://avatars0.githubusercontent.com/u/21341419?s=460&v=4">
      
      <p>dh-qa</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2018-09-12</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      <p>CONDA Cheat Sheet</p>
<h2 id="Conda-Basics"><a href="#Conda-Basics" class="headerlink" title="Conda Basics"></a>Conda Basics</h2><table>
<thead>
<tr>
<th>Command</th>
<th>Usage</th>
</tr>
</thead>
<tbody><tr>
<td>conda info</td>
<td>version</td>
</tr>
<tr>
<td>conda update conda</td>
<td>update conda</td>
</tr>
<tr>
<td>conda install <package_name></package_name></td>
<td>install package</td>
</tr>
<tr>
<td>spyder</td>
<td>run a package after installed</td>
</tr>
<tr>
<td>conda update <package_name></package_name></td>
<td>update package</td>
</tr>
</tbody></table>
<h2 id="Using-Environment"><a href="#Using-Environment" class="headerlink" title="Using Environment"></a>Using Environment</h2><table>
<thead>
<tr>
<th>Command</th>
<th>Usage</th>
</tr>
</thead>
<tbody><tr>
<td>conda create –name py36 python=3.6</td>
<td>create a new python3.6 environment</td>
</tr>
<tr>
<td>source activate py36</td>
<td>activate env</td>
</tr>
<tr>
<td>conda env list</td>
<td>list all environment</td>
</tr>
<tr>
<td>conda create –clone <source> –name <target></target></td>
<td>clone project</td>
</tr>
<tr>
<td>conda list –explicit &gt; py36.txt</td>
<td>save environment to a text file</td>
</tr>
<tr>
<td>conda env create –file py36.txt</td>
<td>creat environment from a text file</td>
</tr>
<tr>
<td>pip install boltons</td>
<td>pip install to the activate environment</td>
</tr>
<tr>
<td>conda search PACKAGENAME</td>
<td>search packages</td>
</tr>
<tr>
<td>conda env remove –name env_name</td>
<td>remove environment</td>
</tr>
</tbody></table>

      
    </div>
    
      <div class="full-width auto-padding tags">
        
          <a href="/tags/cheatsheet/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>cheatsheet</a>
        
      </div>
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post reveal ">
  


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  <h2 class="title">
    <a href="/2018/08/13/jmespath/">
      jmespath 使用，jsonpath外的另外一种选择
    </a>
  </h2>


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http:" rel="nofollow">
      
        <img src="https://avatars0.githubusercontent.com/u/21341419?s=460&v=4">
      
      <p>dh-qa</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2018-08-13</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      <p>在测试过程中，经常会去JSON中的某个值，<a href="http://jmespath.org/tutorial.html" target="_blank" rel="noopener">jmespath</a>可以是除了jsonpath的另外一种选择.<br>下面通过几个例子来说明jmespath在python的使用</p>
<h2 id="jmespath-python安装"><a href="#jmespath-python安装" class="headerlink" title="jmespath python安装"></a>jmespath python安装</h2><p>非常简单直接pip,</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install jmespth</span><br></pre></td></tr></table></figure>

<h2 id="查询一个key值"><a href="#查询一个key值" class="headerlink" title="查询一个key值"></a>查询一个key值</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source=&#123;<span class="string">"a"</span>: <span class="string">"foo"</span>, <span class="string">"b"</span>: <span class="string">"bar"</span>, <span class="string">"c"</span>: <span class="string">"baz"</span>&#125;</span><br><span class="line">result = jmespath.search(<span class="string">"a"</span>,source)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<h2 id="subexpression"><a href="#subexpression" class="headerlink" title="subexpression"></a>subexpression</h2><p>类似于jsonpath，通过<strong><em>.</em></strong>来表示路径的层级</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source_1=&#123;<span class="string">"a"</span>: &#123;<span class="string">"b"</span>: &#123;<span class="string">"c"</span>: &#123;<span class="string">"d"</span>: <span class="string">"value"</span>&#125;&#125;&#125;&#125;</span><br><span class="line">sub_result = jmespath.search(<span class="string">"a.b.c"</span>,source_1)</span><br><span class="line">print(sub_result)</span><br></pre></td></tr></table></figure>

<p>这个例子的结果为：{‘d’: ‘value’}</p>
<h2 id="index-expressions"><a href="#index-expressions" class="headerlink" title="index expressions"></a>index expressions</h2><p>index expression主要使用在数组上</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source_2 = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>]</span><br><span class="line">index_result = jmespath.search(<span class="string">"[1]"</span>,source_2)</span><br><span class="line">print(index_result)</span><br></pre></td></tr></table></figure>

<p>这个例子的结果为:b</p>
<h2 id="多个表达式综合使用"><a href="#多个表达式综合使用" class="headerlink" title="多个表达式综合使用"></a>多个表达式综合使用</h2><p>以上几种表达式可以合起来一期使用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">composite_exp = <span class="string">"a.b.c[0].d[1][0]"</span></span><br><span class="line">source_3= &#123;<span class="string">"a"</span>: &#123;</span><br><span class="line">  <span class="string">"b"</span>: &#123;</span><br><span class="line">    <span class="string">"c"</span>: [</span><br><span class="line">      &#123;<span class="string">"d"</span>: [<span class="number">0</span>, [<span class="number">1</span>, <span class="number">2</span>]]&#125;,</span><br><span class="line">      &#123;<span class="string">"d"</span>: [<span class="number">3</span>, <span class="number">4</span>]&#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;&#125;</span><br><span class="line"></span><br><span class="line">composite_result = jmespath.search(composite_exp,source_3)</span><br><span class="line">print(composite_result)</span><br></pre></td></tr></table></figure>

<p>这个例子的结果为1</p>
<h2 id="Slicing-切片"><a href="#Slicing-切片" class="headerlink" title="Slicing 切片"></a>Slicing 切片</h2><p>slicing 和python本身的slicing比较像，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">source_4=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">slicing_exp = <span class="string">"[0:5]"</span></span><br><span class="line">slicing_result = jmespath.search(slicing_exp,source_4)</span><br><span class="line">print(slicing_result)</span><br></pre></td></tr></table></figure>

<p>这个例子的结果为： [0, 1, 2, 3, 4]</p>
<p>slicing实际上和python自己的机制基本一样，同样这个也是主要给数组使用.<br>有一点需要记住，基本的slicing的格式其实是： [start:stop:step]</p>
<h2 id="Projections"><a href="#Projections" class="headerlink" title="Projections"></a>Projections</h2><p>projection不知道怎么翻译，就先叫做投影吧，具体通过例子来说比较好理解.<br>projections主要包含一下几种情况:</p>
<ul>
<li>List Projections</li>
<li>Slice Projections</li>
<li>Object Projections</li>
<li>Flatten Projections</li>
<li>Filter Projections</li>
</ul>
<h3 id="Projections-例子"><a href="#Projections-例子" class="headerlink" title="Projections- 例子"></a>Projections- 例子</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">list_exp=<span class="string">"people[*].first"</span></span><br><span class="line">source_5 = &#123;</span><br><span class="line">  <span class="string">"people"</span>: [</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"James"</span>, <span class="string">"last"</span>: <span class="string">"d"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"Jacob"</span>, <span class="string">"last"</span>: <span class="string">"e"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"Jayden"</span>, <span class="string">"last"</span>: <span class="string">"f"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"missing"</span>: <span class="string">"different"</span>&#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"foo"</span>: &#123;<span class="string">"bar"</span>: <span class="string">"baz"</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">proj_result1= jmespath.search(list_exp,source_5)</span><br><span class="line">print(proj_result1) <span class="comment"># ['James', 'Jacob', 'Jayden']</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj_exp =<span class="string">"reservations[*].instances[*].state"</span></span><br><span class="line">source_6= &#123;</span><br><span class="line">  <span class="string">"reservations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"instances"</span>: [</span><br><span class="line">        &#123;<span class="string">"state"</span>: <span class="string">"running"</span>&#125;,</span><br><span class="line">        &#123;<span class="string">"state"</span>: <span class="string">"stopped"</span>&#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"instances"</span>: [</span><br><span class="line">        &#123;<span class="string">"state"</span>: <span class="string">"terminated"</span>&#125;,</span><br><span class="line">        &#123;<span class="string">"state"</span>: <span class="string">"runnning"</span>&#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">proj_result2=jmespath.search(obj_exp,source_6)</span><br><span class="line">print(proj_result2) <span class="comment">#[['running', 'stopped'], ['terminated', 'runnning']]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Flatten projections</span></span><br><span class="line"></span><br><span class="line">source_7=[</span><br><span class="line">  [<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">  <span class="number">2</span>,</span><br><span class="line">  [<span class="number">3</span>],</span><br><span class="line">  <span class="number">4</span>,</span><br><span class="line">  [<span class="number">5</span>, [<span class="number">6</span>, <span class="number">7</span>]]</span><br><span class="line">]</span><br><span class="line">flat_exp =<span class="string">"[]"</span></span><br><span class="line">flat_result = jmespath.search(flat_exp,source_7)</span><br><span class="line">print(flat_result) <span class="comment"># [0, 1, 2, 3, 4, 5, [6, 7]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># filter</span></span><br><span class="line"></span><br><span class="line">filter_exp=<span class="string">"machines[?state=='running'].name"</span></span><br><span class="line">filter_source =&#123;</span><br><span class="line">  <span class="string">"machines"</span>: [</span><br><span class="line">    &#123;<span class="string">"name"</span>: <span class="string">"a"</span>, <span class="string">"state"</span>: <span class="string">"running"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"name"</span>: <span class="string">"b"</span>, <span class="string">"state"</span>: <span class="string">"stopped"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"name"</span>: <span class="string">"b"</span>, <span class="string">"state"</span>: <span class="string">"running"</span>&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">filter_result = jmespath.search(filter_exp,filter_source)</span><br><span class="line">print(filter_result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pipe expression</span></span><br><span class="line"></span><br><span class="line">pipe_exp= <span class="string">"people[*].first | [0]"</span></span><br><span class="line">pipe_source= &#123;</span><br><span class="line">  <span class="string">"people"</span>: [</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"James"</span>, <span class="string">"last"</span>: <span class="string">"d"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"Jacob"</span>, <span class="string">"last"</span>: <span class="string">"e"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"first"</span>: <span class="string">"Jayden"</span>, <span class="string">"last"</span>: <span class="string">"f"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"missing"</span>: <span class="string">"different"</span>&#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"foo"</span>: &#123;<span class="string">"bar"</span>: <span class="string">"baz"</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pipe_result = jmespath.search(pipe_exp,pipe_source)</span><br><span class="line">print(pipe_result)  <span class="comment"># James</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># multiselect</span></span><br><span class="line">multi_exp=<span class="string">"people[].[first,last]"</span></span><br><span class="line">multiselect_result = jmespath.search(multi_exp,pipe_source)</span><br><span class="line">print(multiselect_result) <span class="comment"># [['James', 'd'], ['Jacob', 'e'], ['Jayden', 'f'], [None, None]]</span></span><br></pre></td></tr></table></figure>

<p>基本上把网站上例子试了一下，总体感觉功能是相当强大(怀疑比jsonpath还要厉害一点).<br>从简单到复杂，都还是比较好用.</p>

      
    </div>
    
      <div class="full-width auto-padding tags">
        
          <a href="/tags/python/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>python</a>
        
          <a href="/tags/tips/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>tips</a>
        
      </div>
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post reveal ">
  


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  <h2 class="title">
    <a href="/2018/08/10/3-Agile-Metrics/">
      Agile Metrics： 敏捷指标
    </a>
  </h2>


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http:" rel="nofollow">
      
        <img src="https://avatars0.githubusercontent.com/u/21341419?s=460&v=4">
      
      <p>dh-qa</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2018-08-10</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      <p>有句话说的好，不能衡量就不能说明任何问题，那么一个敏捷项目，需要用什么样的指标来衡量呢？ 不管怎么样有些规则对于指标来说是必须的:</p>
<ul>
<li>必须追踪有用的信息</li>
<li>指标的上下文也很重要</li>
</ul>
<p>我能想到的指标包括:</p>
<ul>
<li>Story Point - Output </li>
<li>Every Issue start-to-close time: Time</li>
<li>Bug Ratio: Output/Debt</li>
<li>Business Data for the new feature or fix bug: Output</li>
<li>Techinical debt: own ? How Much? Story Point</li>
<li>Figure out Spring Checklist</li>
<li>What Value did the team deliver last sprint?</li>
<li>How has the level of technical debt?</li>
<li>Are you happy working with your teammate?</li>
<li>Lead Time and Cycle Time</li>
</ul>

      
    </div>
    
      <div class="full-width auto-padding tags">
        
          <a href="/tags/agile-metrics/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>agile metrics</a>
        
      </div>
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post reveal ">
  


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  <h2 class="title">
    <a href="/2018/07/24/1-junit-perf/">
      junit-perf
    </a>
  </h2>


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http:" rel="nofollow">
      
        <img src="https://avatars0.githubusercontent.com/u/21341419?s=460&v=4">
      
      <p>dh-qa</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2018-07-24</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      <h1 id="使用JunitPerf进行性能测试"><a href="#使用JunitPerf进行性能测试" class="headerlink" title="使用JunitPerf进行性能测试"></a>使用JunitPerf进行性能测试</h1><p>以下简单介绍一下如何使用JunitPerf进行性能测试，JunitPerf是基于JUnit4的一个单元性能测试插件，对于会远程调用API测试比较合适，如果想要比较nanosecond 延迟的则需要使用<a href="http://openjdk.java.net/projects/code-tools/jmh/" target="_blank" rel="noopener">JMH</a>.</p>
<h2 id="JunitPerf-依赖声明"><a href="#JunitPerf-依赖声明" class="headerlink" title="JunitPerf 依赖声明"></a>JunitPerf 依赖声明</h2><p>此例子假设使用MAVEN管理项目，所以在POM文件中添加：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.noconnor<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junitperf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="构建压力测试类"><a href="#构建压力测试类" class="headerlink" title="构建压力测试类"></a>构建压力测试类</h2><p>假设你想衡量DemoPerfService 类中的getServiceId方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoPerfService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServiceId</span><span class="params">(String userId)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> UUID.randomUUID().toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么你可以构建如下的测试类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoServiceTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Rule</span></span><br><span class="line">    <span class="keyword">public</span> JUnitPerfRule perfTestRule = <span class="keyword">new</span> JUnitPerfRule();</span><br><span class="line">    DemoPerfService demoPerfService;</span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setupService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.demoPerfService = <span class="keyword">new</span> DemoPerfService();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@JUnitPerfTest</span>(threads = <span class="number">50</span>,durationMs = <span class="number">1200</span>,warmUpMs = <span class="number">100</span>,maxExecutionsPerSecond = <span class="number">110</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServiceId_withoutTestRequirement</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String result =demoPerfService.getServiceId(<span class="string">"userid"</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        Assert.assertNotNull(result);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>直接运行就可以进行压力测试,默认的测试报告可以在build/reports 目录下获取：</p>
<p><img src="images/ut/junitperf_1.jpg" alt="img"></p>
<p>以下是对于测试类的几点说明：</p>
<table>
<thead>
<tr>
<th>Item</th>
<th>定义说明</th>
<th>Default值或说明</th>
</tr>
</thead>
<tbody><tr>
<td>@Rule</td>
<td>申明为JUnit 的Rule类</td>
<td></td>
</tr>
<tr>
<td>JUnitPerfRule</td>
<td>JUnitPerf 测试规则类</td>
<td></td>
</tr>
<tr>
<td>@JunitPerfTest</td>
<td>声明为性能测试方法</td>
<td></td>
</tr>
<tr>
<td>threads</td>
<td>测试使用的线程数</td>
<td></td>
</tr>
<tr>
<td>durationMs</td>
<td>测试持续时间</td>
<td></td>
</tr>
<tr>
<td>warmUpMs</td>
<td>测试热身时间</td>
<td>热身时间的测试数据不会计算进最后的测试结果</td>
</tr>
<tr>
<td>maxExecutionsPerSecond</td>
<td>方法执行的上限</td>
<td>RateLimiter，控制TPS上限</td>
</tr>
</tbody></table>
<h2 id="对自己的测试设置期望值"><a href="#对自己的测试设置期望值" class="headerlink" title="对自己的测试设置期望值"></a>对自己的测试设置期望值</h2><p>使用@JUnitPerfTestRequirement 可以给性能测试设置期望值，这个annotation的属性有:</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>定义</th>
</tr>
</thead>
<tbody><tr>
<td>percentits</td>
<td>设置例如90%/95%/50% 响应时间的期望</td>
</tr>
<tr>
<td>executionsPerSec</td>
<td>期望每秒执行测试(TPS)</td>
</tr>
<tr>
<td>allowedErrorPercentage</td>
<td>允许错误比例</td>
</tr>
<tr>
<td>minLatency</td>
<td>期望最小延时，如果实际最小延时超过这个数，则失败</td>
</tr>
<tr>
<td>maxLatency</td>
<td>期望最大延时，如果实际最大延时超过这个，则失败</td>
</tr>
<tr>
<td>meanLatency</td>
<td>期望中位数延时</td>
</tr>
</tbody></table>
<p>下面是使用了JUnitPerfTestRequirement的一个测试方法,需要和@JUnitPerfTest一起使用：</p>
<ul>
<li>@JUnitPerfTest 定义了压测的运行参数</li>
<li>@JUnitPerfTestRequirement定义了压测的期望值</li>
</ul>
<p>具体代码如下例:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">  <span class="meta">@JUnitPerfTest</span>(threads = <span class="number">50</span>,durationMs = <span class="number">1200</span>,warmUpMs = <span class="number">100</span>,maxExecutionsPerSecond = <span class="number">110</span>)</span><br><span class="line">  <span class="meta">@JUnitPerfTestRequirement</span>(percentiles = <span class="string">"90:7,95:7,98:7,99:8"</span>, executionsPerSec = <span class="number">10_000</span>, allowedErrorPercentage = <span class="number">0.10f</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServiceId</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">      String result =demoPerfService.getServiceId(<span class="string">"userid"</span>);</span><br><span class="line">      System.out.println(result);</span><br><span class="line">      Assert.assertNotNull(result);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>运行之后，如果发现没有满足JUnitPerfTestRequirement定义，则报错:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java.lang.AssertionError: Test throughput threshold not achieved</span><br><span class="line">Expected: is &lt;<span class="keyword">true</span>&gt;</span><br><span class="line">     but: was &lt;<span class="keyword">false</span>&gt;</span><br><span class="line">Expected :is &lt;<span class="keyword">true</span>&gt;</span><br></pre></td></tr></table></figure>

<p>是不是很简单！</p>
<h2 id="设置测试报告地址"><a href="#设置测试报告地址" class="headerlink" title="设置测试报告地址"></a>设置测试报告地址</h2><p>JUnitPerf 有不同的测试报告，个人觉得HTML的测试报告比较实用，具体只需要:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Rule</span></span><br><span class="line"><span class="keyword">public</span> JUnitPerfRule perfTestRule = <span class="keyword">new</span> JUnitPerfRule(<span class="keyword">new</span> HtmlReportGenerator(<span class="string">"perf/report.html"</span>));</span><br></pre></td></tr></table></figure>

<h2 id="完整的例子"><a href="#完整的例子" class="headerlink" title="完整的例子"></a>完整的例子</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoServiceTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Rule</span></span><br><span class="line"><span class="comment">//    public JUnitPerfRule perfTestRule = new JUnitPerfRule(new HtmlReportGenerator("perf/report.html"));</span></span><br><span class="line">    <span class="keyword">public</span> JUnitPerfRule perfTestRule = <span class="keyword">new</span> JUnitPerfRule();</span><br><span class="line">    DemoPerfService demoPerfService;</span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setupService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.demoPerfService = <span class="keyword">new</span> DemoPerfService();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@JUnitPerfTest</span>(threads = <span class="number">50</span>,durationMs = <span class="number">1200</span>,warmUpMs = <span class="number">100</span>,maxExecutionsPerSecond = <span class="number">110</span>)</span><br><span class="line">    <span class="meta">@JUnitPerfTestRequirement</span>(percentiles = <span class="string">"90:7,95:7,98:7,99:8"</span>, executionsPerSec = <span class="number">10_000</span>, allowedErrorPercentage = <span class="number">0.10f</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServiceId</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String result =demoPerfService.getServiceId(<span class="string">"userid"</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        Assert.assertNotNull(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@JUnitPerfTest</span>(threads = <span class="number">50</span>,durationMs = <span class="number">1200</span>,warmUpMs = <span class="number">100</span>,maxExecutionsPerSecond = <span class="number">110</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServiceId_withoutTestRequirement</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String result =demoPerfService.getServiceId(<span class="string">"userid"</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        Assert.assertNotNull(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后可以再设定的目录中查看测试报告，测试报告和默认的HTML 测试报告是一致的.</p>
<h2 id="一点问题"><a href="#一点问题" class="headerlink" title="一点问题"></a>一点问题</h2><p>压力测试过程中，有时数据不能复用，举个例子来说，如果想测试完全没有访问redis缓存情况下，通过userid查询的user信息速度，那么压测的时候userid就不能复用，因为一旦访问了就会放入redis缓存而影响结果，这个可以通过使用其他的方法解决，比如曾今使用过BlockingQueue的方法进行过尝试，具体方法如下：</p>
<ol>
<li>读取所有userid的文件</li>
<li>把userid放到一个BlockingQueue中</li>
<li>压测时获取userid通过BlockingQueue去获取</li>
</ol>
<p>这样就解决了数据不能重复的方法，具体方法可以参考如下代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">static</span> BlockingQueue&lt;String&gt; distinctIdQueue ;</span><br><span class="line">    <span class="meta">@Rule</span></span><br><span class="line">    <span class="keyword">public</span> JUnitPerfRule perfTestRule =</span><br><span class="line">            <span class="keyword">new</span> JUnitPerfRule(<span class="keyword">new</span> HtmlReportGenerator(<span class="string">"data/report_test.html"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeClass</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setupQueue</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        distinctIdQueue = <span class="keyword">new</span> LinkedBlockingQueue&lt;&gt;();</span><br><span class="line">        Files.readAllLines(</span><br><span class="line">                Paths.get(<span class="string">"data/userid.txt"</span>)</span><br><span class="line">        ).parallelStream().forEach(</span><br><span class="line">                item-&gt; &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        distinctIdQueue.put(item);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@JUnitPerfTest</span>(threads = <span class="number">50</span>,durationMs = <span class="number">1200</span>,warmUpMs = <span class="number">100</span>,maxExecutionsPerSecond = <span class="number">110</span>)</span><br><span class="line">    <span class="meta">@JUnitPerfTestRequirement</span>(percentiles = <span class="string">"90:7,95:7,98:7,99:8"</span>, executionsPerSec = <span class="number">10_000</span>, allowedErrorPercentage = <span class="number">0.10f</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getServiceId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String uesrId = distinctIdQueue.take();</span><br><span class="line">        String result =demoPerfService.getServiceId(userId);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        Assert.assertNotNull(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    
      <div class="full-width auto-padding tags">
        
          <a href="/tags/junit/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>junit</a>
        
          <a href="/tags/performance/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>performance</a>
        
      </div>
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post reveal ">
  


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  <h2 class="title">
    <a href="/2018/07/18/0-ut-junit/">
      Unit Testing Intro
    </a>
  </h2>


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http:" rel="nofollow">
      
        <img src="https://avatars0.githubusercontent.com/u/21341419?s=460&v=4">
      
      <p>dh-qa</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2018-07-18</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      <h1 id="Just-DO-It-Unit-Testing"><a href="#Just-DO-It-Unit-Testing" class="headerlink" title="Just DO It - Unit Testing"></a>Just DO It - Unit Testing</h1><p>This is first blog for <strong><em>just do it</em></strong> series. The purpose for the <strong><em>just do it</em></strong> series is quit personal. As an aged tester, I have tried a bunch of different testing. And obviously,I am good at some types, and only have concepts in some other types.But There is no notes taken for these, sometimes it bothers me a lot when I need to explain or demo. Anthoer main reason is that I believe that when you want to test something, you need to understand what you test, it is not only the superficial workflow or business logic, but also some techincal inside. <strong><em>just do it</em></strong> is for all the testings or components I have  experienced and learned. It is like footprints of my long enough tester jouney. And Just Do it is more than any words.</p>
<p>ps: for learning English, I decided to write it in English at first.</p>
<h2 id="Unit-Testing-Paradox"><a href="#Unit-Testing-Paradox" class="headerlink" title="Unit Testing Paradox"></a>Unit Testing Paradox</h2><p>There are many blogs out there claiming Unit Testing is such a good thing for improve product quality,and it is quick and cheap. Some Evangelists even claimed unit testing plays very import role in agile,CI/CD process. But in reality, writing unit testing is very rare in a large amount of companies here China. Why? Why good thing doesn’t happen? It is quick,improving quality, more important is cheap? Why so many people/companies don’t buy in? I don’t know, but I want to dive it for seeking the reason.</p>
<h2 id="JUnit-Try"><a href="#JUnit-Try" class="headerlink" title="JUnit Try"></a>JUnit Try</h2><p>JUnit is a very popular unit testing framework, so Let me try from this.</p>
<h3 id="Build-a-Simple-Demo-Application"><a href="#Build-a-Simple-Demo-Application" class="headerlink" title="Build a Simple Demo Application"></a>Build a Simple Demo Application</h3><p>But hold on,what application is for testing? OK, Let me build to simple ToDoApplication. What Features are included:</p>
<ul>
<li>Create ToDoItem : create a ToDoItem which status is TODO</li>
<li>Update ToDoItme: update a ToDoItem </li>
<li>Delete ToDoItem: set ToDoItem status to deleted</li>
<li>Complete ToDoItem: set ToDoItem status to completed</li>
</ul>
<p>I try to make it as simple as possible, so the demonstrate these futures, I create three classes:</p>
<ul>
<li>ToDOItem: it is an entity, which is used to save to database. Just treat it as a database table</li>
<li>ToDoItemDTO: it is a DTO entity, treat is as input</li>
<li>ToDoItemService: do the transformation, transfer ToDoItemDTO to ToDoItem</li>
</ul>
<p>Here is very simple codes:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line">    <span class="keyword">private</span> String details;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> status;</span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoItemDTO</span>  </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line">    <span class="keyword">private</span> String details;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> status=ToDoStatusEnum.TODO.getStatusId();</span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ToDoItem <span class="title">createToDoItem</span><span class="params">(ToDoItemDTO dto)</span></span>&#123;</span><br><span class="line">        ToDoItem toDoItem = <span class="keyword">new</span> ToDoItem();</span><br><span class="line">        toDoItem.setId(UUIDGenerator.generateToDoId());</span><br><span class="line">        toDoItem.setStatus(dto.getStatus());</span><br><span class="line">        toDoItem.setDesc(dto.getDesc());</span><br><span class="line">        toDoItem.setDetails(dto.getDetails());</span><br><span class="line">        toDoItem.setUserId(dto.getUserId());</span><br><span class="line">        <span class="keyword">return</span> toDoItem;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ToDoItem <span class="title">updateToDoItem</span><span class="params">(ToDoItemDTO dto)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> createToDoItem(dto);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//todo: should make todo item statue to DELETED</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ToDoItem <span class="title">deleteToDoItem</span><span class="params">(ToDoItemDTO dto)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> createToDoItem(dto);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//todo: should make todo item statue to Completed</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ToDoItem <span class="title">completeToDoItem</span><span class="params">(ToDoItemDTO dto)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> createToDoItem(dto);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> ToDoStatusEnum &#123;</span><br><span class="line">    TODO(<span class="number">0</span>),WIP(<span class="number">1</span>),DONE(<span class="number">2</span>),PENDING(<span class="number">3</span>),DELETED(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getStatusId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> statusId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> statusId;</span><br><span class="line"></span><br><span class="line">    ToDoStatusEnum(<span class="keyword">int</span> statusId) &#123;</span><br><span class="line">        <span class="keyword">this</span>.statusId= statusId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Let’s-create-first-JUNIT-Test-cases"><a href="#Let’s-create-first-JUNIT-Test-cases" class="headerlink" title="Let’s create first JUNIT Test cases"></a>Let’s create first JUNIT Test cases</h3><p>It is obviously the input is an instance of ToDoDTO, and the output is ToDoItem and the most important part to test is ToDoService. So first thing first, here is the first one test case for ToDoServicce, to test create todoitem successfully, and the content in DTO should be same as the new created ToDoItem.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.Assert;</span><br><span class="line"><span class="keyword">import</span> org.junit.BeforeClass;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoServiceTest</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCreateToDoItem_successful</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ToDoService toDoService; = <span class="keyword">new</span> ToDoService();</span><br><span class="line">        ToDoItemDTO dto = <span class="keyword">new</span> ToDoItemDTO();</span><br><span class="line">        dto.setDesc(<span class="string">"test todo"</span>);</span><br><span class="line">        dto.setDetails(<span class="string">"test todo details"</span>);</span><br><span class="line">        ToDoItem toDoItem =toDoService.createToDoItem(dto);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDesc(),<span class="string">"test todo"</span>);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDetails(),<span class="string">"test todo details"</span>);</span><br><span class="line">        Assert.assertEquals(toDoItem.getStatus(),ToDoStatusEnum.TODO.getStatusId());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here I only use two JUNIT elements, these two elements will be used many many times, if you are writing test codes.</p>
<ul>
<li>@Test: annotation test mark the method as test method</li>
<li>Assert.assertEquals: compare the expected value and actual value</li>
</ul>
<p>It is quit straightforward, when you test something, give the input, process it, and compare the output to the expected value, if meet, pass, otherwise failed.</p>
<h3 id="More-cases"><a href="#More-cases" class="headerlink" title="More cases"></a>More cases</h3><p>After Complete the first case, let’s do more. We want to test more functionalities, like update,delete, complete todoitem. Here you go:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToDoServiceTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ToDoService toDoService;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>  ToDoItemDTO dto ;</span><br><span class="line">    <span class="meta">@BeforeClass</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setupToDoService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        toDoService = <span class="keyword">new</span> ToDoService();</span><br><span class="line">        dto = <span class="keyword">new</span> ToDoItemDTO();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCreateToDoItem_successful</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        dto.setDesc(<span class="string">"test todo"</span>);</span><br><span class="line">        dto.setDetails(<span class="string">"test todo details"</span>);</span><br><span class="line">        ToDoItem toDoItem =toDoService.createToDoItem(dto);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDesc(),<span class="string">"test todo"</span>);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDetails(),<span class="string">"test todo details"</span>);</span><br><span class="line">        Assert.assertEquals(toDoItem.getStatus(),ToDoStatusEnum.TODO.getStatusId());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateToDoItem_successful</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        dto.setDesc(<span class="string">"update"</span>);</span><br><span class="line">        dto.setDetails(<span class="string">"update"</span>);</span><br><span class="line">        ToDoItem toDoItem =toDoService.createToDoItem(dto);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDesc(),<span class="string">"update"</span>);</span><br><span class="line">        Assert.assertEquals(toDoItem.getDetails(),<span class="string">"update"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteToDoItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ToDoItem toDoItem =toDoService.deleteToDoItem(dto);</span><br><span class="line">        Assert.assertEquals(toDoItem.getStatus(),ToDoStatusEnum.DELETED.getStatusId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">completeToDoItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ToDoItem toDoItem =toDoService.deleteToDoItem(dto);</span><br><span class="line">        Assert.assertEquals(toDoItem.getStatus(),ToDoStatusEnum.DELETED.getStatusId());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In above codes, I use a new junit annonations:</p>
<ul>
<li>@BeforeClass</li>
</ul>
<p>@BeforeClass is invoked before the test class initialized. So the method and should be static. Here why I used @BeforeClass is because I want to resue the toDoService accross all the test methods. So it should be a static.</p>
<p>And another Junit annotation @Before is simmilar with @BeforeClass.<br>It is invoked before every test method. Here is a sample codes to show it:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JunitAnnotationDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String testString=<span class="string">"First"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span></span>&#123;</span><br><span class="line">        testString = <span class="keyword">this</span>.testString + <span class="string">",setup"</span>;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTestString_First</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(testString);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTestString_Second</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(testString);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>From the result of System.out.println(this), actually JUNIT use different instance to run the test methods</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">io.hedwig.justdoit.demo.JunitAnnotationDemo@<span class="number">17</span>d10166</span><br><span class="line">First,setup</span><br><span class="line">io.hedwig.justdoit.demo.JunitAnnotationDemo@<span class="number">4f</span>8e5cde</span><br><span class="line">First,setup</span><br></pre></td></tr></table></figure>

<h3 id="Run-the-tests"><a href="#Run-the-tests" class="headerlink" title="Run the tests"></a>Run the tests</h3><p>Back to the ToDoItem unit tests. Run the ToDoServiceTest, there are several errors, here is an example for deleteToDoItem: </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java.lang.AssertionError: </span><br><span class="line">Expected :<span class="number">0</span></span><br><span class="line">Actual   :<span class="number">4</span></span><br><span class="line"> &lt;Click to see difference&gt;</span><br></pre></td></tr></table></figure>

<p>The target to unit test is to make sure you codes pass the tests quickly. Look back to ToDoService, it is obviously, deleteToDoItem should set the ToDoItem status to DELETE, but the function is omitted. So add the codes to fix it, and re-run the tests to make it all passed. </p>
<h2 id="Unit-Test-Thinking"><a href="#Unit-Test-Thinking" class="headerlink" title="Unit Test Thinking"></a>Unit Test Thinking</h2><p>Actully this process is as known as TDD (Test Driven Development). Before actually complete the real working codes, write test codes first. The purpose of these test codes, I think they could be :</p>
<ul>
<li>Features Definition</li>
<li>Task Tracking Tool</li>
<li>Boundary Checking Tool</li>
</ul>
<p>Why? I think in reality, there are many undocumented features in PRD, no one actually mantained it. Unit Test documents these features.</p>
<p>Also if writes test codes before complete the real codes, then you pass test methods one by one, that means developer complete the sub-tasks one by one, so It is Task Tracking tool. Imaging that, if you want to complete 10 sub-tasks, but you are interruptted every hour by meetings or chattings. Every time develop want to find where to start, just run the unit tests, then start from the failed tests.</p>
<p>There are always boundary cases, write into codes to check, it helps develop to find bugs, and also it could be checked if develop have some new changes.</p>
<h2 id="What-should-be-paid-for-Unit-Tests"><a href="#What-should-be-paid-for-Unit-Tests" class="headerlink" title="What should be paid for Unit Tests"></a>What should be paid for Unit Tests</h2><p>Above cases looks so fascination, Unit Tests could tracking features,tasks, and check the codes when changes happened to ensure your changes are correct. But Why developers still don’t want to write the Unit tests?  Let’s just counting the lines of code in above examples, the truth is that the test codes are more lines than real codes. It is not joke, it happened. So I can understand why developer don’t want to write unit tests, maybe the workload!!</p>
<p>Understand what the develop thoughts are, it is also one of targets in <strong><em>just do it</em></strong> series, try it and then find where the issues are.</p>
<p>Because write testing codes need to take more times, pick what to test and use less test codes to achieve coverages is more critical and practical. </p>
<p><a href="https://github.com/evenhumble/justdo-it/tree/master/ut-cases" target="_blank" rel="noopener">code repo</a></p>

      
    </div>
    
      <div class="full-width auto-padding tags">
        
          <a href="/tags/ut/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>ut</a>
        
          <a href="/tags/justdoit/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>justdoit</a>
        
      </div>
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post reveal ">
  


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  <h2 class="title">
    <a href="/2018/07/01/1-ansible-in-10-minutes/">
      ansible In 30 Minutes
    </a>
  </h2>


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="http:" rel="nofollow">
      
        <img src="https://avatars0.githubusercontent.com/u/21341419?s=460&v=4">
      
      <p>dh-qa</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2018-07-01</p>
  </a>
</div>

          
        
          
            

          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      <h1 id="Ansible-Basic-Concept"><a href="#Ansible-Basic-Concept" class="headerlink" title="Ansible Basic Concept"></a>Ansible Basic Concept</h1><p>ansible 是一个操作机器的工具,可以通过编排不同的inventory,组合不同的命令来将日常运维的操作<br>变成可运行的脚本资产,同时也可以积累常用的脚本以便复用.</p>
<p>下面是关于ansible的一些基础概念的脑图,总体而言ansible包括了以下几个概念：</p>
<ul>
<li>inventory: 定义主机,定义操作对象<ul>
<li>Host:主机</li>
<li>Group：不同的主机组合成一个组，一个组下面可以有子组，于是就构成了一个树形结构</li>
</ul>
</li>
<li>variable： 变量，主要用来定义对于操作机器时使用的可变参数</li>
</ul>
<h1 id="Ansible-Installation"><a href="#Ansible-Installation" class="headerlink" title="Ansible Installation"></a>Ansible Installation</h1><ul>
<li>install in MAC</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew unisntall ansible</span><br><span class="line">brew install ansible</span><br></pre></td></tr></table></figure>

<ul>
<li>install in centos</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install epel-release</span><br><span class="line">sudo yum install ansible -y</span><br></pre></td></tr></table></figure>

<h1 id="Configure-hosts-for-ansible-ssh-connector"><a href="#Configure-hosts-for-ansible-ssh-connector" class="headerlink" title="Configure hosts for ansible ssh connector"></a>Configure hosts for ansible ssh connector</h1><ul>
<li>copy ssh key to different hosts</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ssh-keygen</span><br><span class="line">ssh-copy-id remoteuser@remote.server</span><br><span class="line">ssh-keyscan remote.server &gt;&gt; ~/.ssh/known_hosts</span><br></pre></td></tr></table></figure>

<ul>
<li>check ssh connection</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh remoteuser@remote.server</span><br></pre></td></tr></table></figure>

<p>it is done.</p>
<h1 id="Ansible-Ad-hoc-Commands"><a href="#Ansible-Ad-hoc-Commands" class="headerlink" title="Ansible Ad-hoc Commands"></a>Ansible Ad-hoc Commands</h1><p>ansible 命令的pattern 如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible &lt;host-pattern&gt; [options]</span><br></pre></td></tr></table></figure>

<p>具体查看ansible 的使用帮助是：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible --<span class="built_in">help</span></span><br></pre></td></tr></table></figure>

<h2 id="ansible-ad-hoc-command-检查安装环境"><a href="#ansible-ad-hoc-command-检查安装环境" class="headerlink" title="ansible ad-hoc command - 检查安装环境"></a>ansible ad-hoc command - 检查安装环境</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m ping -u root</span><br></pre></td></tr></table></figure>

<h2 id="ansible-ad-hoc-command-执行命令"><a href="#ansible-ad-hoc-command-执行命令" class="headerlink" title="ansible ad-hoc command - 执行命令"></a>ansible ad-hoc command - 执行命令</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -a <span class="string">"/bin/sh echo hello world"</span></span><br></pre></td></tr></table></figure>

<h2 id="ansible-ad-hoc-command-copy-files"><a href="#ansible-ad-hoc-command-copy-files" class="headerlink" title="ansible ad-hoc command - copy files"></a>ansible ad-hoc command - copy files</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -m copy -a <span class="string">"src=/etc/hosts dest=/tmp/hosts"</span></span><br></pre></td></tr></table></figure>

<h2 id="ansible-ad-hoc-command-yum-install"><a href="#ansible-ad-hoc-command-yum-install" class="headerlink" title="ansible ad-hoc command - yum install"></a>ansible ad-hoc command - yum install</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -m yum -a <span class="string">"name=acme state=present"</span></span><br></pre></td></tr></table></figure>

<h2 id="ansible-ad-hoc-command-add-user"><a href="#ansible-ad-hoc-command-add-user" class="headerlink" title="ansible ad-hoc command - add user"></a>ansible ad-hoc command - add user</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m user -a <span class="string">"name=foo passsword=&lt;crypted password here&gt;"</span></span><br></pre></td></tr></table></figure>

<h2 id="ansible-ad-hoc-command-download-git-包"><a href="#ansible-ad-hoc-command-download-git-包" class="headerlink" title="ansible ad-hoc command - download git 包"></a>ansible ad-hoc command - download git 包</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -m git -a <span class="string">"repo=git://foo.example.io/repo.git dest=/src/myapp"</span></span><br></pre></td></tr></table></figure>

<h2 id="ansible-ad-hoc-command-start-service"><a href="#ansible-ad-hoc-command-start-service" class="headerlink" title="ansible ad-hoc command - start service"></a>ansible ad-hoc command - start service</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -m service -a <span class="string">"name=httpd state=started"</span></span><br></pre></td></tr></table></figure>

<h2 id="ansible-ad-hoc-command-并行运行"><a href="#ansible-ad-hoc-command-并行运行" class="headerlink" title="ansible ad-hoc command - 并行运行"></a>ansible ad-hoc command - 并行运行</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible web -a <span class="string">"/sbin/reboot"</span> -f 10</span><br></pre></td></tr></table></figure>

<h2 id="ansible-ad-hoc-command-查看全部系统信息"><a href="#ansible-ad-hoc-command-查看全部系统信息" class="headerlink" title="ansible ad-hoc command - 查看全部系统信息"></a>ansible ad-hoc command - 查看全部系统信息</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m setup</span><br></pre></td></tr></table></figure>

<h2 id="ansible-ad-hoc-command-小结"><a href="#ansible-ad-hoc-command-小结" class="headerlink" title="ansible ad-hoc command 小结"></a>ansible ad-hoc command 小结</h2><p>从以上的例子中我们可以看到ansible的命令一般都会使用如下几点：</p>
<ul>
<li>module: -m </li>
<li>module_args: -a </li>
<li>hosts: all/web/……</li>
</ul>
<p>以上三个组合成为了下面的一个命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m service -a <span class="string">"name=httpd state=started"</span></span><br></pre></td></tr></table></figure>

<p>从python的角度看,可以用伪代码的方式:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">def copy(args=&#123;&#125;):</span><br><span class="line">    <span class="keyword">for</span> kwarg, v <span class="keyword">in</span> args.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&#123;key&#125;=&#123;value&#125;"</span>.format(key=kwarg, value=v))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="built_in">test</span>(args=&#123;&#125;):</span><br><span class="line">    <span class="keyword">for</span> kwarg, v <span class="keyword">in</span> args.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&#123;key&#125;=&#123;value&#125;"</span>.format(key=kwarg, value=v))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">module_mapping = &#123;</span><br><span class="line">    <span class="string">"copy"</span>: copy,</span><br><span class="line">    <span class="string">"test"</span>: <span class="built_in">test</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def ansible(module, module_args):</span><br><span class="line">    func = module_mapping.get(module)</span><br><span class="line">    parsed = module_args.split(<span class="string">" "</span>)</span><br><span class="line">    args = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> module_arg <span class="keyword">in</span> parsed:</span><br><span class="line">        kv = module_arg.split(<span class="string">"="</span>)</span><br><span class="line">        args[kv[0]] = kv[1]</span><br><span class="line">    func(args)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    ansible(module=<span class="string">'copy'</span>, module_args=<span class="string">"name=name test=test"</span>)</span><br></pre></td></tr></table></figure>


      
    </div>
    
      <div class="full-width auto-padding tags">
        
          <a href="/tags/CI-CD/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>CI/CD</a>
        
          <a href="/tags/ansible/" rel="nofollow"><i class="fas fa-hashtag fa-fw"></i>ansible</a>
        
      </div>
    
  </section>
</article>

          </div>
        
      
    
  </section>
  
    
      <br>
      <div class="prev-next">
        <div class="prev-next">
          
          <p class="current">
            1 / 2
          </p>
          
            <a class="next" rel="next" href="/archives/2018/page/2/">
              <section class="post next">
                &nbsp;下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i>
              </section>
            </a>
          
        </div>
      </div>

    
    <!-- 根据主题中的设置决定是否在archive中针对摘要部分的MathJax公式加载mathjax.js文件 -->
    
    

  


	
</div>
<aside class='l_side'>
  
    
    
      
        
          
          
            <section class='widget author'>
  <div class='content material'>
    
      <div class='avatar'>
        <img class='avatar' src='https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/avatar/avatar.png'/>
      </div>
    
    
    
      <div class="social-wrapper">
        
          
            <a href="/atom.xml"
              class="social fas fa-rss flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:me@xaoxuu.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://github.com/xaoxuu"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=63035382"
              class="social fas fa-headphones-alt flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

          
        
      
        
          
          
            

          
        
      
        
          
          
            <section class='widget grid'>
  
<header class='material'>
  <div><i class="fas fa-map-signs fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;站内导航</div>
  
</header>

  <div class='content material'>
    <ul class="grid navgation">
      
        <li><a class="flat-box" title="/" href="/"
          
          
          id="home">
          
            <i class="fas fa-clock fa-fw" aria-hidden="true"></i>
          
          近期文章
        </a></li>
      
        <li><a class="flat-box" title="/blog/archives/" href="/blog/archives/"
          
            rel="nofollow"
          
          
          id="blogarchives">
          
            <i class="fas fa-archive fa-fw" aria-hidden="true"></i>
          
          文章归档
        </a></li>
      
        <li><a class="flat-box" title="/projects/" href="/projects/"
          
          
          id="projects">
          
            <i class="fas fa-code-branch fa-fw" aria-hidden="true"></i>
          
          开源项目
        </a></li>
      
        <li><a class="flat-box" title="/friends/" href="/friends/"
          
            rel="nofollow"
          
          
          id="friends">
          
            <i class="fas fa-link fa-fw" aria-hidden="true"></i>
          
          我的友链
        </a></li>
      
        <li><a class="flat-box" title="https://xaoxuu.com/wiki/material-x/" href="https://xaoxuu.com/wiki/material-x/"
          
            rel="nofollow"
          
          
          id="https:xaoxuu.comwikimaterial-x">
          
            <i class="fas fa-book fa-fw" aria-hidden="true"></i>
          
          主题文档
        </a></li>
      
        <li><a class="flat-box" title="/about/" href="/about/"
          
            rel="nofollow"
          
          
          id="about">
          
            <i class="fas fa-info-circle fa-fw" aria-hidden="true"></i>
          
          关于小站
        </a></li>
      
    </ul>
  </div>
</section>

          
        
      
        
          
          
            

          
        
      
        
          
          
            
  <section class='widget tagcloud'>
    
<header class='material'>
  <div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;热门标签</div>
  
    <a class="rightBtn"
    
      rel="nofollow"
    
    
    href="/blog/tags/"
    title="blog/tags/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class='content material'>
      <a href="/tags/API-Testing/" style="font-size: 19px; color: #777">API Testing</a> <a href="/tags/Automation/" style="font-size: 16.5px; color: #888">Automation</a> <a href="/tags/CI-CD/" style="font-size: 19px; color: #777">CI/CD</a> <a href="/tags/CICD/" style="font-size: 14px; color: #999">CICD</a> <a href="/tags/JAVA/" style="font-size: 14px; color: #999">JAVA</a> <a href="/tags/MAVEN/" style="font-size: 14px; color: #999">MAVEN</a> <a href="/tags/Notes/" style="font-size: 14px; color: #999">Notes</a> <a href="/tags/Performance/" style="font-size: 14px; color: #999">Performance</a> <a href="/tags/Project-Setup/" style="font-size: 14px; color: #999">Project Setup</a> <a href="/tags/Python/" style="font-size: 14px; color: #999">Python</a> <a href="/tags/TDD/" style="font-size: 14px; color: #999">TDD</a> <a href="/tags/ThinkInTesting/" style="font-size: 14px; color: #999">ThinkInTesting</a> <a href="/tags/ThreadDump/" style="font-size: 14px; color: #999">ThreadDump</a> <a href="/tags/Tip/" style="font-size: 14px; color: #999">Tip</a> <a href="/tags/agile-metrics/" style="font-size: 14px; color: #999">agile metrics</a> <a href="/tags/algorithm/" style="font-size: 14px; color: #999">algorithm</a> <a href="/tags/annaconda3/" style="font-size: 14px; color: #999">annaconda3</a> <a href="/tags/ansible/" style="font-size: 16.5px; color: #888">ansible</a> <a href="/tags/cheatsheet/" style="font-size: 14px; color: #999">cheatsheet</a> <a href="/tags/concurrent/" style="font-size: 14px; color: #999">concurrent</a> <a href="/tags/git/" style="font-size: 14px; color: #999">git</a> <a href="/tags/google-test-blog-translation/" style="font-size: 14px; color: #999">google_test_blog_translation</a> <a href="/tags/interview/" style="font-size: 14px; color: #999">interview</a> <a href="/tags/java/" style="font-size: 21.5px; color: #666">java</a> <a href="/tags/junit/" style="font-size: 14px; color: #999">junit</a> <a href="/tags/justdoit/" style="font-size: 14px; color: #999">justdoit</a> <a href="/tags/ops/" style="font-size: 14px; color: #999">ops</a> <a href="/tags/patterns/" style="font-size: 24px; color: #555">patterns</a> <a href="/tags/performance/" style="font-size: 14px; color: #999">performance</a> <a href="/tags/productivity/" style="font-size: 16.5px; color: #888">productivity</a> <a href="/tags/python/" style="font-size: 16.5px; color: #888">python</a> <a href="/tags/real/" style="font-size: 21.5px; color: #666">real</a> <a href="/tags/testing/" style="font-size: 19px; color: #777">testing</a> <a href="/tags/think-different/" style="font-size: 16.5px; color: #888">think-different</a> <a href="/tags/thoughts/" style="font-size: 14px; color: #999">thoughts</a> <a href="/tags/tips/" style="font-size: 21.5px; color: #666">tips</a> <a href="/tags/ut/" style="font-size: 14px; color: #999">ut</a> <a href="/tags/word-frequency/" style="font-size: 14px; color: #999">word_frequency</a>
    </div>
  </section>


          
        
      
        
          
          
            



          
        
      
    

  
</aside>

<footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="/atom.xml"
            class="social fas fa-rss flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="mailto:me@xaoxuu.com"
            class="social fas fa-envelope flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://github.com/xaoxuu"
            class="social fab fa-github flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://music.163.com/#/user/home?id=63035382"
            class="social fas fa-headphones-alt flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <br>
  <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
  <div>
    本站使用
    <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material X</a>
    作为主题
    
      ，
      总访问量为
      <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
      次
    
    。
  </div>
</footer>
<script>setLoadingBarProgress(80);</script>




	<!-- 根据主题中的设置决定是否在archive中针对摘要部分的MathJax公式加载mathjax.js文件 -->
	

	


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>

<script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>


  <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>




  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('.cover') {
          $('.cover').backstretch(
          ["https://img.vim-cn.com/6d/a0c9e6f9efad8b731cb7376504bd10d79d2053.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["https://img.vim-cn.com/6d/a0c9e6f9efad8b731cb7376504bd10d79d2053.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        }
      });
    </script>
  











  <script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.5/js/app.js"></script>


  <script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.5/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
</body>
</html>
